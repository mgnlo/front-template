(self.webpackChunkconsole_frontend=self.webpackChunkconsole_frontend||[]).push([[606],{35043:(e,t,o)=>{"use strict";o.d(t,{I:()=>v});var i=o(27091),r=o(76185),n=o(26215),s=o(5304),a=o(93342);let c=(()=>{class e{constructor({endPoint:t="",sortFieldKey:o="",sortDirKey:i="",pagerPageKey:r="",pagerLimitKey:n="",filterFieldKey:s="",totalKey:a="",dataKey:c=""}={}){this.endPoint=t||"",this.sortFieldKey=o||e.SORT_FIELD_KEY,this.sortDirKey=i||e.SORT_DIR_KEY,this.pagerPageKey=r||e.PAGER_PAGE_KEY,this.pagerLimitKey=n||e.PAGER_LIMIT_KEY,this.filterFieldKey=s||e.FILTER_FIELD_KEY,this.totalKey=a||e.TOTAL_KEY,this.dataKey=c||e.DATA_KEY}}return e.SORT_FIELD_KEY="sort",e.SORT_DIR_KEY="dir",e.PAGER_PAGE_KEY="page",e.PAGER_LIMIT_KEY="size",e.FILTER_FIELD_KEY="#field#",e.TOTAL_KEY="result.totalElements",e.DATA_KEY="result.content",e})();class u{}class l extends r.zV{constructor(e,t,o={},i){super(e,o),this.http=e,this.apiService=t,this.apiStatusSubject=new n.X("init"),this.initConf=i}requestElements(){var e,t;let o=this.createRequesParams();const r=null!==(t=null===(e=null==this?void 0:this.initConf)||void 0===e?void 0:e.page)&&void 0!==t?t:1;if(r>1&&(o.has("page")&&(o=o.delete("page")),o=o.append("page",r)),"#field#"!==this.conf.filterFieldKey){const e=JSON.parse(this.conf.filterFieldKey);e&&e.length>0&&e.filter(e=>i.l.isNotBlank(e.value.toString())).forEach(e=>{o=o.append(e.key,e.value)})}return this.initConf?(this.initConf.sorts&&this.setSort(this.initConf.sorts,!1),this.initConf=void 0):this.apiStatusSubject.next("loading"),this.apiService.doGet(this.conf.endPoint,o,null,"response").pipe((0,s.K)(e=>{throw this.apiStatusSubject.next("error"),e}),(0,a.b)(e=>{var t,o,i,r;this.apiStatusSubject.next("finish");const n=null!==(r=null===(i=null===(o=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.result)||void 0===o?void 0:o.pageable)||void 0===i?void 0:i.pageNumber)&&void 0!==r?r:0;this.setPage(n+1,!1)}))}apiStatus(){return this.apiStatusSubject.asObservable()}}var d=o(79765),p=o(46782),g=o(37716),m=o(91841),h=o(15114),b=o(23918),f=o(51425);let v=(()=>{class e{constructor(e,t,o,i){this.http=e,this.loadingService=t,this.dialogService=o,this.apiService=i}searchData(e){let t=new d.xQ,o=new c({endPoint:e.apiUrl}),r=new u;e.nowPage&&(r.page=e.nowPage),(null==e?void 0:e.filters)&&(r.filters=i.l.getSearchFilters(e.filters),o.filterFieldKey=JSON.stringify(r.filters)),(null==e?void 0:e.sorts)&&(r.sorts=e.sorts);let n=new l(this.http,this.apiService,o,r);return n.apiStatus().pipe((0,p.R)(t)).subscribe(t=>{switch(t){case"error":this.dialogService.alertAndBackToList(!1,e.errMsg);break;case"finish":this.loadingService.close();break;default:this.loadingService.open()}}),n}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(m.eN),g.LFG(h.b),g.LFG(b.x),g.LFG(f.s))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},27091:(e,t,o)=>{"use strict";o.d(t,{l:()=>a});var i=o(16304),r=o(36332),n=o(16738),s=o(76185);const a={getFileExtension(e){var t;const o=null==e?void 0:e.lastIndexOf(".");return-1===o?"":null===(t=null==e?void 0:e.substring(o+1))||void 0===t?void 0:t.toLowerCase()},getFileNameWithoutExtension(e){const t=null==e?void 0:e.lastIndexOf(".");return-1!==t?null==e?void 0:e.substring(0,t):e},convertFileToBase64:e=>new Promise((t,o)=>{const i=new FileReader;i.onload=e=>{var i,r,n;const s=null===(n=null===(r=null===(i=e.target)||void 0===i?void 0:i.result)||void 0===r?void 0:r.toString())||void 0===n?void 0:n.split(",")[1];s?t(s):o(new Error("\u8f49\u63db\u70baBase64\u6642\u767c\u751f\u932f\u8aa4"))},i.onerror=e=>{o(e)},i.readAsDataURL(e)}),getActionName(e){switch(e){case"edit":return"\u7de8\u8f2f";case"copy":return"\u8907\u88fd";default:return"\u65b0\u589e"}},getFirstFormContorlError:e=>e?Object.keys(e)[0]:"",getDateStringByMoment:e=>n.isMoment(e)?e.year().toString().padStart(4,"0")+(e.month()+1).toString().padStart(2,"0")+e.date().toString().padStart(2,"0"):e+"",isBlank:e=>null==e||""===String(e).trim(),isNotBlank(e){return!this.isBlank(e)},toViewDateString(e){const t=/^(\d{4})(\d{2})(\d{2})$/;return t.test(e)?e.replace(t,"$1/$2/$3"):e},compareObj(e,t){const o={};return Object.keys(e).map(i=>{o[i]=!(!e[i]||!t[i])&&e[i]===t[i]}),o},groupBy(e,t,o){let i=void 0===o||o;return e.reduce(function(e,o){let r=Object.assign({},o);return i||delete r[t],(e[o[t]]=e[o[t]]||[]).push(r),e},{})},flatGroupItem(e,t){let o=[];return Object.keys(e).forEach(i=>{let r=e[i].reduce(function(e,o){return e[t]=i,Object.entries(o).forEach(([t,o])=>e[t]=o),e},{});o.push(r)}),o},getHistoryProcessData(e,t){if(t){if(!t[e])return null;let o=JSON.parse(JSON.stringify(t)),i={};return t[e].length>0&&(o.historyGroupView={}),t[e].forEach(e=>{o.historyGroupView&&o.historyGroupView[e.groupId]?o.historyGroupView[e.groupId].flows.push({time:e.time,title:e.title,detail:e.detail}):(i[e.groupId]=!0,o.historyGroupView[e.groupId]={type:e.type,flows:[{time:e.time,title:e.title,detail:e.detail}]})}),{isHistoryOpen:i,detail:o}}return null},getFormGroupInFormArray:(e,t,o)=>e.get(t).at(o),getSearchFilters:e=>Object.keys(e).filter(t=>a.isNotBlank(e[t])).map(t=>({key:t,value:"startDate"===t||"endDate"===t?n(e[t]).format("YYYY-MM-DD"):e[t]})),initializeFormWithSessionData(e,t){(null==t?void 0:t.filter)&&Object.keys(t.filter).forEach(o=>{const i=e.controls[o];let r=!t.filter[o]||"startDate"!==o&&"endDate"!==o?t.filter[o]:new Date(t.filter[o]);i&&i.patchValue(r)})},removeLastCharIfEquals(e,t){if(!e||!t)return e;const o=new RegExp(`${t}+[^${t}]*$`);return e.replace(o,"")},onSetTempPageIsAllSelected(e,t,o){const i=e.findIndex(e=>e.pageNum===t);return-1===i?e.push({pageNum:t,val:o}):e[i].val=o,e},onSetGridPageChecked:(e,t,o,r)=>(0,i.Z)(function*(){if(!(t instanceof s.nC))return new Array;const i=yield t.getElements(),n=new Set(i.filter(e=>(null==e?void 0:e.isShow)&&(null==e?void 0:e.isSelected)).map(t=>t[e]));return r?i.filter(t=>t[e]&&(null==t?void 0:t.isShow)).forEach(t=>{const i=t[e];n.has(i)||o.push({rowId:i})}):o=o.filter(e=>!n.has(e.rowId)),o})(),processExecutionFrequency(e,t){var o,i,n,s,a,c,u,l;let d="";if(this.isBlank(e)||this.isBlank(t))return d;const p=t.split(/[:\uff1a]/),g=null==e?void 0:e.toLowerCase();switch(g){case"daily":d=`${r.Di[g]} ${null!==(o=p[0])&&void 0!==o?o:""} \u6642 ${null!==(i=p[1])&&void 0!==i?i:""} \u5206`;break;case"weekly":const e=parseInt(null!==(n=p[0])&&void 0!==n?n:"0");d=`${r.Di[g]} ${r.Qo[e-1]||""} ${null!==(s=p[1])&&void 0!==s?s:""} \u6642 ${null!==(a=p[2])&&void 0!==a?a:""} \u5206`;break;case"monthly":const m="999"===(null==p?void 0:p[0])?"\u6708\u5e95":null!==(c=p[0]+"\u65e5")&&void 0!==c?c:"";d=`${r.Di[g]} ${m} ${null!==(u=p[1])&&void 0!==u?u:""} \u6642 ${null!==(l=p[2])&&void 0!==l?l:""} \u5206`;break;default:d=`${r.Di[g]} ${t}`}return d}}},89606:(e,t,o)=>{"use strict";o.r(t),o.d(t,{AccountManageModule:()=>se,NB_MODULES:()=>ne});var i=o(39363),r=o(3679),n=o(83621),s=o(73749),a=o(38832),c=o(86794),u=o(76185),l=o(63423),d=o(37716);let p=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Xpm({type:e,selectors:[["account-manage"]],decls:1,vars:0,template:function(e,t){1&e&&d._UZ(0,"router-outlet")},directives:[l.lC],encapsulation:2}),e})();var g=(()=>(function(e){e.dashboard="\u5100\u8868\u677f",e.customer="\u7528\u6236\u7ba1\u7406 - \u7528\u6236\u5217\u8868",e.activity="\u7528\u6236\u7ba1\u7406 - \u5ba2\u7fa4\u6d3b\u52d5\u540d\u55ae",e.tag="\u6a19\u7c64\u7ba1\u7406",e["review-tag"]="\u5be9\u6838\u7ba1\u7406 - \u6a19\u7c64\u5be9\u6838",e["review-activity"]="\u5be9\u6838\u7ba1\u7406 - \u5ba2\u7fa4\u5be9\u6838\u540d\u55ae",e["review-schedule"]="\u5be9\u6838\u7ba1\u7406 - \u540d\u55ae\u6392\u7a0b\u5be9\u6838",e["schedule-tag"]="\u6a19\u7c64\u6392\u7a0b",e["schedule-activity"]="\u540d\u55ae\u6392\u7a0b",e["console-user"]="\u5e33\u865f\u7ba1\u7406 - \u4f7f\u7528\u8005\u7ba1\u7406",e["console-group"]="\u5e33\u865f\u7ba1\u7406 - \u6b0a\u9650\u7ba1\u7406"}(g||(g={})),g))(),m=o(77047),h=o(88567);const b={groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleUser:[{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Digital_Financial",enable:!0,lastLoginTime:"2023-07-03 15:30:00"}],consoleGroupScope:[{groupId:"uuid-1",scope:"dashboard.read"},{groupId:"uuid-1",scope:"customer.read"},{groupId:"uuid-1",scope:"activity.read"},{groupId:"uuid-1",scope:"activity.create"},{groupId:"uuid-1",scope:"activity.update"},{groupId:"uuid-1",scope:"activity.delete"},{groupId:"uuid-1",scope:"tag.read"},{groupId:"uuid-1",scope:"tag.create"},{groupId:"uuid-1",scope:"tag.update"},{groupId:"uuid-1",scope:"tag.delete"},{groupId:"uuid-1",scope:"review-tag.read"},{groupId:"uuid-1",scope:"review-tag.update"},{groupId:"uuid-1",scope:"review-activity.read"},{groupId:"uuid-1",scope:"review-activity.update"},{groupId:"uuid-1",scope:"review-schedule.read"},{groupId:"uuid-1",scope:"review-schedule.update"},{groupId:"uuid-1",scope:"schedule-tag.read"},{groupId:"uuid-1",scope:"schedule-tag.update"},{groupId:"uuid-1",scope:"schedule-activity.read"},{groupId:"uuid-1",scope:"schedule-activity.create"},{groupId:"uuid-1",scope:"schedule-activity.update"},{groupId:"uuid-1",scope:"schedule-activity.delete"},{groupId:"uuid-1",scope:"console-user-list.read"},{groupId:"uuid-1",scope:"console-user-list.update"},{groupId:"uuid-1",scope:"console-group.read"},{groupId:"uuid-1",scope:"console-group.create"},{groupId:"uuid-1",scope:"console-group.update"},{groupId:"uuid-1",scope:"console-group.delete"}]};var f=o(27091),v=o(6258),S=o(32392),T=o(5304),y=o(45435),Z=o(93342),I=o(54856),G=o(11470),U=o(15585),w=o(75620),A=o(51425);let C=(()=>{class e{constructor(e){this.service=e,this.consoleUserFunc="console-user/",this.consoleGroupFunc="console-group/",this.CONSOLE_GROUP_LIST_PATH=["pages","account-manage","console-group-list"],this.CONSOLE_GROUP_DETAIL_PATH=["pages","account-manage","console-group-detail"],this.CONSOLE_GROUP_SET_PATH=["pages","account-manage","console-group-set"]}createDefaultScopeGridInnerCheckBoxs(){return Object.entries(w.Ob).map(([e,t])=>{let o={featureName:e};return t.crud.forEach(e=>o[e]=!1),o})}updateCheckbox(e,t){e.forEach(e=>{let o=t.find(t=>t.featureName===e.featureName);o&&Object.keys(o).filter(e=>"featureName"!==e).forEach(t=>{e[t]=o[t]})})}updateConsoleUserList(e,t){return this.service.doPut(this.consoleUserFunc+e,t)}getConsoleGroupList(e){return e?this.service.doGet(this.consoleGroupFunc,{size:e}):this.service.doGet(this.consoleGroupFunc)}getConsoleGroup(e){return this.service.doGet(`${this.consoleGroupFunc}${e}`)}createConsoleGroup(e){return this.service.doPost(this.consoleGroupFunc,e)}updateConsoleGroup(e,t){return this.service.doPut(`${this.consoleGroupFunc}${e}`,t)}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(A.s))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})();var N=o(15114),_=o(35043),q=o(23918),x=o(38583),F=o(65969),k=o(87450);function D(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",function(){return d.CHM(e),d.oxw().edit()}),d._UZ(1,"nb-icon",10),d.qZA()}}function P(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",function(){return d.CHM(e),d.oxw().copy()}),d._UZ(1,"nb-icon",11),d.qZA()}}let L=(()=>{class e extends S.H{constructor(e,t,o,i,r,n,s,a,c){super(e,t,o),this.router=i,this.accountManageService=r,this.loadingService=n,this.tableService=s,this.dialogService=a,this.activatedRoute=c,this.consoleGroupScope=this.accountManageService.createDefaultScopeGridInnerCheckBoxs(),this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.gridDefine2={pager:{display:!0,perPage:12},columns:{featureName:{title:"\u529f\u80fd\u55ae\u5143",type:"html",valuePrepareFunction:e=>e?`<p>${g[e]||""}</p>`:"",sort:!1},read:{title:"\u67e5\u770b",type:"custom",class:"text_center",renderComponent:v.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"read"},isCheckedParam:{key:"read"},disable:!0}},sort:!1},create:{title:"\u65b0\u589e",type:"custom",class:"text_center",renderComponent:v.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"create"},isCheckedParam:{key:"create"},disable:!0}},sort:!1},update:{title:"\u7de8\u8f2f",type:"custom",class:"text_center",renderComponent:v.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"update"},isCheckedParam:{key:"update"},disable:!0}},sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.gridDefine={pager:{display:!0,perPage:10},columns:{account:{title:"\u5e33\u865f",type:"string",sort:!1},name:{title:"\u59d3\u540d",type:"string",sort:!1},email:{title:"\u96fb\u5b50\u90f5\u4ef6",type:"string",sort:!1},businessUnit:{title:"\u6240\u5c6c\u55ae\u4f4d",type:"html",class:"text_center",valuePrepareFunction:e=>e?`<p class="text_center">${m.Z[e]||""}</p>`:"",sort:!1}},hideSubHeader:!0,actions:{position:"right",columnTitle:"\u79fb\u9664",add:!1,edit:!1,delete:!1}},this.dataSource=new u.nC,this.dataSource2=new u.nC}ngOnInit(){const e=this.storageService.getSessionVal(this.sessionKey);if(this.groupId=this.activatedRoute.snapshot.params.groupId?this.activatedRoute.snapshot.params.groupId:e.groupId,this.loadingService.open(),this.isMock){this.consoleGroupDetail=b;let e=this.consoleGroupDetail.consoleGroupScope.map(e=>{let t=e.scope.split(".");return{featureName:t[0],[t[1]]:!0}}),t=f.l.groupBy(e,"featureName",!1),o=f.l.flatGroupItem(t,"featureName");return this.accountManageService.updateCheckbox(this.consoleGroupScope,o),this.dataSource2.load(this.consoleGroupScope),this.dataSource.load(this.consoleGroupDetail.consoleUser),void this.loadingService.close()}this.accountManageService.getConsoleGroup(this.groupId).pipe((0,T.K)(e=>{this.loadingService.close();let t=!!Object.values(h.m).includes(e.code)&&null;throw this.dialogService.alertAndBackToList(t,`${e.message}\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u6b0a\u9650\u7ba1\u7406\u5217\u8868`,this.accountManageService.CONSOLE_GROUP_LIST_PATH),new Error(e.message)}),(0,y.h)(e=>e.code===h.$.SUCCESS),(0,Z.b)(e=>{this.loadingService.close()})).subscribe(e=>{if(e.result.consoleGroupScope){this.consoleGroupDetail=JSON.parse(JSON.stringify(e.result));let t=e.result.consoleGroupScope.map(e=>{let t=e.scope.split(".");return{featureName:t[0],[t[1]]:!0}}),o=f.l.groupBy(t,"featureName",!1),i=f.l.flatGroupItem(o,"featureName");this.accountManageService.updateCheckbox(this.consoleGroupScope,i),this.dataSource2.load(this.consoleGroupScope),this.dataSource.load(this.consoleGroupDetail.consoleUser)}})}edit(){this.router.navigate(["pages","account-manage","console-group-set","edit",this.groupId])}copy(){this.router.navigate(["pages","account-manage","console-group-set","copy",this.groupId])}ngOnDestroy(){this.storageService.putSessionVal(this.sessionKey,{page:this.paginator.nowPage,groupId:this.groupId})}cancel(){this.router.navigate(["pages","account-manage","console-group-list"])}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(I.V),d.Y36(G.E),d.Y36(U.r),d.Y36(l.F0),d.Y36(C),d.Y36(N.b),d.Y36(_.I),d.Y36(q.x),d.Y36(l.gz))},e.\u0275cmp=d.Xpm({type:e,selectors:[["console-group-detail"]],features:[d.qOj],decls:42,vars:17,consts:[[1,"pageTitle"],["nbButton","","status","primary","size","tiny","class","iconBtn",3,"click",4,"ngIf"],[1,"pageContent"],[1,"row"],[1,"textGroup","col-12","col-lg-4"],[3,"settings","source"],[3,"source","paginator"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","primary","size","tiny",1,"iconBtn",3,"click"],["icon","edit-outline"],["icon","copy-outline"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h1"),d._uU(2,"\u6b0a\u9650\u7ba1\u7406"),d.qZA(),d.YNc(3,D,2,0,"button",1),d.YNc(4,P,2,0,"button",1),d.qZA(),d.TgZ(5,"div",2),d.TgZ(6,"nb-card"),d.TgZ(7,"nb-card-body"),d.TgZ(8,"div",3),d.TgZ(9,"div",4),d.TgZ(10,"p"),d._uU(11,"\u6b0a\u9650\u540d\u7a31\uff1a"),d.qZA(),d.TgZ(12,"span"),d._uU(13),d.qZA(),d.qZA(),d.TgZ(14,"div",4),d.TgZ(15,"p"),d._uU(16,"\u6b0a\u9650\u72c0\u614b\uff1a"),d.qZA(),d.TgZ(17,"span"),d._uU(18),d.ALo(19,"enum"),d.qZA(),d.qZA(),d.TgZ(20,"div",4),d.TgZ(21,"p"),d._uU(22,"\u7570\u52d5\u65e5\u671f\uff1a"),d.qZA(),d.TgZ(23,"span"),d._uU(24),d.ALo(25,"date"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(26,"div",3),d.TgZ(27,"div",4),d.TgZ(28,"p"),d._uU(29,"\u6b0a\u9650\u5167\u5bb9\uff1a"),d.qZA(),d.qZA(),d.qZA(),d._UZ(30,"ng2-smart-table",5),d.qZA(),d.qZA(),d.TgZ(31,"nb-card"),d.TgZ(32,"nb-card-header"),d.TgZ(33,"h2"),d._uU(34,"\u5df2\u6388\u6b0a\u4f7f\u7528\u8005\u5217\u8868"),d.qZA(),d.qZA(),d.TgZ(35,"nb-card-body"),d._UZ(36,"ng2-smart-table",5),d._UZ(37,"paginator",6),d.qZA(),d.qZA(),d.TgZ(38,"div",3),d.TgZ(39,"div",7),d.TgZ(40,"button",8),d.NdJ("click",function(){return t.cancel()}),d._uU(41,"\u8fd4 \u56de"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(3),d.Q6J("ngIf",t.isCrud.update),d.xp6(1),d.Q6J("ngIf",t.isCrud.create),d.xp6(9),d.Oqu(null==t.consoleGroupDetail?null:t.consoleGroupDetail.groupName),d.xp6(5),d.Oqu(d.xi3(19,11,(null==t.consoleGroupDetail?null:t.consoleGroupDetail.enable)+"","filter")),d.xp6(6),d.Oqu(d.xi3(25,14,null==t.consoleGroupDetail?null:t.consoleGroupDetail.modificationTime,t.dateFormat)),d.xp6(6),d.Q6J("settings",t.gridDefine2)("source",t.dataSource2),d.xp6(6),d.Q6J("settings",t.gridDefine)("source",t.dataSource),d.xp6(1),d.Q6J("source",t.dataSource)("paginator",t.paginator))},directives:[x.O5,a.Asz,a.yKW,u.T5,a.ndF,F.J,a.DPz,a.fMN],pipes:[k.z,x.uU],styles:[""]}),e})();const O=[{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-2",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e12",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-3",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e13",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-4",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e14",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-5",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e15",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-6",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e16",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-7",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e17",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-8",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e18",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-9",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e19",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-10",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e110",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-11",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e111",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"},{groupId:"uuid-12",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e112",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00"}];var E=o(60023);function Y(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",4),d.TgZ(1,"button",5),d.NdJ("click",function(){return d.CHM(e),d.oxw().add()}),d._uU(2,"\u65b0 \u589e"),d.qZA(),d.qZA()}}function J(e,t){if(1&e&&(d.ynx(0),d._UZ(1,"ng2-smart-table",6),d._UZ(2,"paginator",7),d.BQk()),2&e){const e=t.ngIf,o=d.oxw();d.xp6(1),d.Q6J("settings",o.gridDefine)("source",e),d.xp6(1),d.Q6J("source",e)("paginator",o.paginator)}}let K=(()=>{class e extends S.H{constructor(e,t,o,i,r,n,s,a){super(e,t,o),this.router=i,this.loadingService=r,this.activatedRoute=n,this.accountManageService=s,this.tableService=a,this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.gridDefine={pager:{display:!0,perPage:10},columns:{groupName:{title:"\u6b0a\u9650\u540d\u7a31",type:"string",sort:!1},enable:{title:"\u72c0\u614b",type:"html",class:"text_center",sort:!1,valuePrepareFunction:e=>'<p class="text_center">'+(e?"\u555f\u7528":"\u505c\u7528")+"</p>"},modificationTime:{title:"\u7570\u52d5\u6642\u9593",type:"html",class:"text_center",valuePrepareFunction:e=>e?'<p class="text_center">'+new x.uU("en-US").transform(e,this.dateFormat)+"</p>":"",sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",renderComponent:E.P,onComponentInitFunction:e=>{e.emitter.subscribe(e=>{this.router.navigate(["pages","account-manage","console-group-detail",e.groupId])})},sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}}}ngOnInit(){var e;if(this.loadingService.open(),this.isMock)return this.dataSource.reset(),this.dataSource.load(O),void this.loadingService.close();const t=null===(e=this.storageService.getSessionVal(this.sessionKey))||void 0===e?void 0:e.page;this.restDataSource=this.tableService.searchData({apiUrl:this.accountManageService.consoleGroupFunc,nowPage:t||this.paginator.nowPage,errMsg:"\u6b0a\u9650\u7ba1\u7406\u5217\u8868\u67e5\u7121\u8cc7\u6599"}),document.querySelector("nb-layout-column").scrollTo(0,0)}add(){this.router.navigate(this.accountManageService.CONSOLE_GROUP_SET_PATH)}ngOnDestroy(){this.storageService.putSessionVal(this.sessionKey,{page:this.paginator.nowPage})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(I.V),d.Y36(G.E),d.Y36(U.r),d.Y36(l.F0),d.Y36(N.b),d.Y36(l.gz),d.Y36(C),d.Y36(_.I))},e.\u0275cmp=d.Xpm({type:e,selectors:[["console-group-list"]],features:[d.qOj],decls:11,vars:2,consts:[[1,"pageTitle"],[1,"pageContent"],["class","rightBox",4,"ngIf"],[4,"ngIf"],[1,"rightBox"],["nbButton","","status","primary","size","medium",3,"click"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h1"),d._uU(2,"\u6b0a\u9650\u7ba1\u7406"),d.qZA(),d.qZA(),d.TgZ(3,"div",1),d.TgZ(4,"nb-card"),d.TgZ(5,"nb-card-header"),d.TgZ(6,"h2"),d._uU(7,"\u6b0a\u9650\u5217\u8868"),d.qZA(),d.qZA(),d.TgZ(8,"nb-card-body"),d.YNc(9,Y,3,0,"div",2),d.YNc(10,J,3,4,"ng-container",3),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(9),d.Q6J("ngIf",t.isCrud.create),d.xp6(1),d.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[a.Asz,a.ndF,a.yKW,x.O5,a.DPz,u.T5,F.J],styles:[""]}),e})();class M{}var B=o(21523),R=o(68877),$=o(46988);function Q(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"nb-card"),d.TgZ(1,"nb-card-header"),d.TgZ(2,"h2"),d._uU(3,"\u5df2\u6388\u6b0a\u4f7f\u7528\u8005\u5217\u8868"),d.qZA(),d.qZA(),d.TgZ(4,"nb-card-body"),d.TgZ(5,"div",12),d._UZ(6,"nb-icon",13),d.TgZ(7,"p"),d._uU(8,"\u79fb\u9664\u6b64\u6b0a\u9650\u5f8c\u5c07\u8a72\u4f7f\u7528\u8005\u6b0a\u9650\u9810\u8a2d\u70ba\u300c\u4e00\u822c\u4f7f\u7528\u8005\u300d\u3002"),d.qZA(),d.qZA(),d.TgZ(9,"ng2-smart-table",14),d.NdJ("deleteConfirm",function(t){return d.CHM(e),d.oxw().onDeleteConfirm(t)}),d.qZA(),d._UZ(10,"paginator",15),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(9),d.Q6J("settings",e.gridDefine)("source",e.dataSource),d.xp6(1),d.Q6J("source",e.dataSource)("paginator",e.paginator)}}let j=(()=>{class e extends S.H{constructor(e,t,o,i,n,s,a,c){super(e,t,o),this.router=i,this.accountManageService=n,this.activatedRoute=s,this.loadingService=a,this.dialogService=c,this.consoleGroupDetail=new M,this.consoleGroupScope=this.accountManageService.createDefaultScopeGridInnerCheckBoxs(),this.gridDefine2={pager:{display:!0,perPage:12},columns:{featureName:{title:"\u529f\u80fd\u55ae\u5143",type:"html",valuePrepareFunction:e=>e?`<p>${g[e]||""}</p>`:"",sort:!1},read:{title:"\u67e5\u770b",type:"custom",class:"text_center",renderComponent:v.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"read"},isCheckedParam:{key:"read"}},e.emitter.subscribe(e=>{e.read=e.isChecked})},sort:!1},create:{title:"\u65b0\u589e",type:"custom",class:"text_center",renderComponent:v.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"create"},isCheckedParam:{key:"create"}},e.emitter.subscribe(e=>{e.create=e.isSelected})},sort:!1},update:{title:"\u7de8\u8f2f",type:"custom",class:"text_center",renderComponent:v.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"update"},isCheckedParam:{key:"update"}},e.emitter.subscribe(e=>{e.update=e.isSelected})},sort:!1}},hideSubHeader:!0,actions:!1},this.gridDefine={pager:{display:!0,perPage:10},hideSubHeader:!0,actions:!1,columns:{account:{title:"\u5e33\u865f",type:"html",class:"col-2 left",valuePrepareFunction:e=>`<p class="left">${null!=e?e:""}</p>`,sort:!1},name:{title:"\u59d3\u540d",type:"string",class:"col-2",sort:!1},email:{title:"\u96fb\u5b50\u90f5\u4ef6",type:"html",class:"col-6 left",valuePrepareFunction:e=>`<p class="left">${null!=e?e:""}</p>`,sort:!1},businessUnit:{title:"\u6240\u5c6c\u55ae\u4f4d",type:"string",class:"col-2",valuePrepareFunction:e=>e?`${m.Z[e]||""}`:"",sort:!1},delete:{title:"\u79fb\u9664",class:"col-1",type:"custom",renderComponent:E.P,onComponentInitFunction:e=>{e.settings={btnStatus:"danger",btnIcon:"trash-2-outline"},e.emitter.subscribe(e=>{this.onDeleteConfirm(e)})},sort:!1}}},this.validateForm=new r.cw({groupName:new r.NI(null,[r.kI.required,B.I.blank]),enable:new r.NI("",r.kI.required)})}ngOnInit(){var e;if(this.changeRouteName=null===(e=this.activatedRoute.snapshot.params)||void 0===e?void 0:e.changeRoute,this.actionName=f.l.getActionName(this.changeRouteName),this.btnName=f.l.getActionName(this.changeRouteName).split("").join(" "),this.groupId=this.activatedRoute.snapshot.params.groupId,this.dataSource=new u.nC,this.dataSource2=new u.nC(this.consoleGroupScope),void 0!==this.changeRouteName){if(this.loadingService.open(),this.isMock){this.consoleGroupDetail=b,this.validateForm.get("groupName").setValue(this.consoleGroupDetail.groupName),this.validateForm.get("enable").setValue(this.consoleGroupDetail.enable.toString());let e=this.consoleGroupDetail.consoleGroupScope.map(e=>{let t=e.scope.split(".");return{featureName:t[0],[t[1]]:!0}}),t=f.l.groupBy(e,"featureName",!1),o=f.l.flatGroupItem(t,"featureName");return this.accountManageService.updateCheckbox(this.consoleGroupScope,o),this.dataSource2.load(this.consoleGroupScope),this.dataSource.load(this.consoleGroupDetail.consoleUser),void this.loadingService.close()}this.accountManageService.getConsoleGroup(this.groupId).pipe((0,T.K)(e=>{throw this.loadingService.close(),this.dialogService.alertAndBackToList(!1,`${e.message}\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u6b0a\u9650\u7ba1\u7406\u5217\u8868`,this.accountManageService.CONSOLE_GROUP_LIST_PATH),new Error(e.message)}),(0,y.h)(e=>e.code===h.$.SUCCESS),(0,Z.b)(e=>{if(e.result.consoleGroupScope){this.consoleGroupDetail=JSON.parse(JSON.stringify(e.result)),this.validateForm.get("groupName").setValue(this.consoleGroupDetail.groupName),this.validateForm.get("enable").setValue(this.consoleGroupDetail.enable.toString());let t=e.result.consoleGroupScope.map(e=>{let t=e.scope.split(".");return{featureName:t[0],[t[1]]:!0}}),o=f.l.groupBy(t,"featureName",!1),i=f.l.flatGroupItem(o,"featureName");this.accountManageService.updateCheckbox(this.consoleGroupScope,i),this.dataSource2.load(this.consoleGroupScope),this.dataSource.load(this.consoleGroupDetail.consoleUser)}this.loadingService.close()})).subscribe()}}onDeleteConfirm(e){this.dataSource.remove(e)}cancel(){this.router.navigate("edit"!==this.changeRouteName?["pages","account-manage","console-group-list"]:["pages","account-manage","console-group-detail",this.consoleGroupDetail.groupId])}send(){if(this.validateForm.valid){this.consoleGroupDetail.consoleGroupScope=[];let e=this.validateForm.getRawValue();this.consoleGroupDetail.groupName=e.groupName,this.consoleGroupDetail.enable="true"===e.enable;for(let t of this.dataSource2.data){let e=Object.keys(t).filter(e=>"isSelected"!==e&&"isShow"!==e&&"isChecked"!==e);for(let o=1;o<e.length;o++)t[e[o]]&&this.consoleGroupDetail.consoleGroupScope.push({groupId:this.consoleGroupDetail.groupId,scope:`${t[e[0]]}.${e[o]}`})}this.consoleGroupDetail.consoleUser=this.dataSource.data,this.loadingService.open(),("edit"!==this.changeRouteName?this.accountManageService.createConsoleGroup(this.consoleGroupDetail):this.accountManageService.updateConsoleGroup(this.groupId,this.consoleGroupDetail)).pipe((0,T.K)(e=>{throw this.loadingService.close(),this.dialogService.alertAndBackToList(!1,`${e.message}\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u6b0a\u9650\u7ba1\u7406\u5217\u8868`,this.accountManageService.CONSOLE_GROUP_LIST_PATH),new Error(e.message)}),(0,y.h)(e=>e.code===h.$.SUCCESS),(0,Z.b)(e=>{this.loadingService.close(),this.dialogService.alertAndBackToList(!0,`${this.actionName}\u6b0a\u9650\u6210\u529f`,["pages","account-manage","console-group-detail",e.result.groupId])})).subscribe()}}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(I.V),d.Y36(G.E),d.Y36(U.r),d.Y36(l.F0),d.Y36(C),d.Y36(l.gz),d.Y36(N.b),d.Y36(q.x))},e.\u0275cmp=d.Xpm({type:e,selectors:[["console-group-set"]],features:[d.qOj],decls:24,vars:10,consts:[[1,"pageTitle"],[1,"pageContent"],[3,"formGroup"],[1,"row"],["title","\u6b0a\u9650\u540d\u7a31","ctlName","groupName",1,"col-12","col-lg-6",3,"form","maxlength"],["title","\u72c0\u614b","ctlName","enable","enumName","filter",1,"col-12","col-lg-6",3,"form"],[1,"subTitle"],[3,"settings","source"],[4,"ngIf"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"disabled","click"],[1,"noteText"],["icon","info-outline"],[3,"settings","source","deleteConfirm"],[3,"source","paginator"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h1"),d._uU(2,"\u6b0a\u9650\u7ba1\u7406"),d.qZA(),d.qZA(),d.TgZ(3,"div",1),d.TgZ(4,"nb-card"),d.TgZ(5,"nb-card-header"),d.TgZ(6,"h2"),d._uU(7),d.qZA(),d.qZA(),d.TgZ(8,"nb-card-body",2),d.TgZ(9,"div",3),d._UZ(10,"basic-input",4),d._UZ(11,"radio",5),d.qZA(),d.TgZ(12,"div",6),d.TgZ(13,"p"),d._uU(14,"\u6b0a\u9650\u5167\u5bb9"),d.qZA(),d.qZA(),d.TgZ(15,"nb-card-body"),d._UZ(16,"ng2-smart-table",7),d.qZA(),d.qZA(),d.qZA(),d.YNc(17,Q,11,4,"nb-card",8),d.TgZ(18,"div",3),d.TgZ(19,"div",9),d.TgZ(20,"button",10),d.NdJ("click",function(){return t.cancel()}),d._uU(21,"\u53d6 \u6d88"),d.qZA(),d.TgZ(22,"button",11),d.NdJ("click",function(){return t.send()}),d._uU(23),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.hij("",t.actionName,"\u6b0a\u9650"),d.xp6(1),d.Q6J("formGroup",t.validateForm),d.xp6(2),d.Q6J("form",t.validateForm)("maxlength",20),d.xp6(1),d.Q6J("form",t.validateForm),d.xp6(5),d.Q6J("settings",t.gridDefine2)("source",t.dataSource2),d.xp6(1),d.Q6J("ngIf",void 0!==t.changeRouteName),d.xp6(5),d.Q6J("disabled",t.validateForm.invalid),d.xp6(1),d.Oqu(t.btnName))},directives:[a.Asz,a.ndF,a.yKW,r.JL,r.sg,R.n,$.U,u.T5,x.O5,a.DPz,a.fMN,F.J],styles:[""]}),e})();function z(e,t){if(1&e&&(d.TgZ(0,"nb-option",10),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",null==e?null:e.groupId),d.xp6(1),d.Oqu(e.groupName)}}let H=(()=>{class e{constructor(e,t,o,i){this.ref=e,this.loadingService=t,this.accountManageService=o,this.dialogService=i}ngOnChanges(e){var t;e.consoleUser.currentValue!=e.consoleUser.previousValue&&(this.groupId=(null===(t=e.consoleUser.currentValue.consoleGroup)||void 0===t?void 0:t.groupId)?e.consoleUser.currentValue.consoleGroup.groupId:"")}save(){var e;this.consoleUser.consoleGroup=(null===(e=this.consoleUser.consoleGroup)||void 0===e?void 0:e.groupId)?this.consoleUser.consoleGroup:new M,this.consoleUser.consoleGroup.groupId=this.groupId,this.consoleGroupList.filter(e=>{e.groupId==this.groupId&&(this.consoleUser.consoleGroup=e)}),this.loadingService.open(),this.accountManageService.updateConsoleUserList(this.consoleUser.userId,this.consoleUser).pipe((0,T.K)(e=>{throw this.loadingService.close(),this.dialogService.alertAndBackToList(!1,`${this.consoleUser.account} \u6b0a\u9650\u8b8a\u66f4\u5931\u6557`),new Error(e.message)}),(0,Z.b)(e=>{console.info(e),this.loadingService.close()})).subscribe(e=>{e.code===h.$.SUCCESS&&(this.dialogService.alertAndBackToList(!0,`${this.consoleUser.account} \u6b0a\u9650\u8b8a\u66f4\u6210\u529f`),this.ref.close(this.consoleUser))})}close(){this.ref.close(null)}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(a.X4l),d.Y36(N.b),d.Y36(C),d.Y36(q.x))},e.\u0275cmp=d.Xpm({type:e,selectors:[["ngx-change"]],inputs:{consoleUser:"consoleUser",consoleGroupList:"consoleGroupList"},features:[d._Bn([C]),d.TTD],decls:22,vars:4,consts:[[1,"dialogCard","medium"],[1,"row"],[1,"fieldGroup","col-12","col-lg-12"],["fullWidth","","placeholder","\u8acb\u9078\u64c7",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[1,"note","errorText"],["icon","alert-triangle"],[1,"btnGroup"],["nbButton","","status","basic",3,"click"],["nbButton","","status","primary",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(d.TgZ(0,"nb-card",0),d.TgZ(1,"nb-card-header"),d.TgZ(2,"h2"),d._uU(3),d.qZA(),d.qZA(),d.TgZ(4,"nb-card-body"),d.TgZ(5,"div",1),d.TgZ(6,"div",2),d.TgZ(7,"label"),d._uU(8,"\u6388\u4e88\u6b0a\u9650"),d.qZA(),d.TgZ(9,"div"),d.TgZ(10,"nb-select",3),d.NdJ("selectedChange",function(e){return t.groupId=e}),d.YNc(11,z,2,2,"nb-option",4),d.qZA(),d.qZA(),d.TgZ(12,"div",5),d._UZ(13,"nb-icon",6),d.TgZ(14,"p"),d._uU(15,"\u6b04\u4f4d\u932f\u8aa4\u8a0a\u606f"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(16,"nb-card-footer"),d.TgZ(17,"div",7),d.TgZ(18,"button",8),d.NdJ("click",function(){return t.close()}),d._uU(19,"\u95dc \u9589"),d.qZA(),d.TgZ(20,"button",9),d.NdJ("click",function(){return t.save()}),d._uU(21,"\u5132 \u5b58"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(3),d.hij("\u8b8a\u66f4 ",t.consoleUser.name," \u6b0a\u9650"),d.xp6(7),d.Q6J("selected",t.groupId),d.xp6(1),d.Q6J("ngForOf",t.consoleGroupList),d.xp6(9),d.Q6J("disabled",!t.groupId||t.groupId==(null==t.consoleUser.consoleGroup?null:t.consoleUser.consoleGroup.groupId)))},directives:[a.Asz,a.ndF,a.yKW,a.rs,x.sg,a.fMN,a.XWE,a.DPz,a.q51],styles:[""]}),e})();const V=[{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin1",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin2",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-2",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e12",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin3",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-10",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e110",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin4",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin5",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin6",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin7",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin8",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin9",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin10",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin11",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin12",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin13",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin14",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin15",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin16",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin17",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin18",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}},{userId:"U66972ba05c34190a5bfd576dad10493",account:"admin19",name:"Admin",email:"admin@webcomm.com.tw",businessUnit:"Credit_Cards",enable:!0,lastLoginTime:"2023-07-03 15:30:00",consoleGroup:{groupId:"uuid-1",groupName:"\u7cfb\u7d71\u7ba1\u7406\u54e1",description:"\u7cfb\u7d71\u7ba1\u7406\u54e1",priority:2,enable:!0,createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",consoleGroupScope:null}}];var X=o(83376),W=o(79761);function ee(e,t){if(1&e&&(d.TgZ(0,"nb-card-body"),d._UZ(1,"ng2-smart-table",13),d._UZ(2,"paginator",14),d.qZA()),2&e){const e=t.ngIf,o=d.oxw();d.xp6(1),d.Q6J("settings",o.gridDefine)("source",e),d.xp6(1),d.Q6J("source",e)("paginator",o.paginator)}}const te=function(e){return{options:e,key:"key",val:"val"}},oe=function(e){return{options:e,key:"groupId",val:"groupName"}},ie=[{path:"",component:p,children:[{path:"",redirectTo:"console-group-list",pathMatch:"full"},{path:"console-group-list",component:K,data:{keepSession:!0}},{path:"console-group-detail/:groupId",component:L,data:{keepSession:!0}},{path:"console-group-set",component:j},{path:"console-group-set/:changeRoute/:groupId",component:j},{path:"console-user-list",component:(()=>{class e extends S.H{constructor(e,t,o,i,n,s,a){super(e,t,o),this.loadingService=i,this.accountManageService=n,this.dialogService=s,this.tableService=a,this.businessUnit=Object.entries(m.Z).map(([e,t])=>({key:e,val:t})),this.isSearch=!1,this.gridDefine={pager:{display:!0,perPage:10},columns:{account:{title:"\u5e33\u865f",type:"string",sort:!1},name:{title:"\u59d3\u540d",type:"html",class:"text_center",valuePrepareFunction:(e,t,o)=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},email:{title:"\u96fb\u5b50\u90f5\u4ef6",type:"string",sort:!1},businessUnit:{title:"\u6240\u5c6c\u55ae\u4f4d",type:"html",class:"text_center",valuePrepareFunction:(e,t,o)=>o?'<p class="text_center">'+(m.Z[e]||"")+"</p>":"",sort:!1},consoleGroup:{title:"\u6b0a\u9650",type:"string",valuePrepareFunction:e=>null==e?void 0:e.groupName,sort:!1},action:{title:"\u8b8a\u66f4",type:"custom",class:"center",width:"3rem",renderComponent:E.P,onComponentInitFunction:e=>{e.settings={btnStatus:"primary",btnIcon:"edit-outline"},e.emitter.subscribe(e=>{this.dialogService.open(H,{consoleUser:e,consoleGroupList:this.consoleGroupList}).onClose.subscribe(e=>{e&&this.search()})})},sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.validateForm=new r.cw({account:new r.NI(null),name:new r.NI(null),email:new r.NI(null,{validators:B.I.email,updateOn:"blur"}),businessUnit:new r.cw({}),groupId:new r.NI("")}),this.isCrud.update||delete this.gridDefine.columns.action}ngOnInit(){this.queryAllConsoleGroup(),this.search();let e=this.validateForm.get("businessUnit");this.businessUnit.forEach(t=>{e.setControl(t.key,new r.NI(!1))})}search(e){if(this.isMock){this.dataSource.reset();let e=this.validateForm.getRawValue();for(const[t,o]of Object.entries(e).filter(([e,t])=>!!t))"businessUnit"===t?Object.entries(o).filter(([e,t])=>!0===t).map(([e,t])=>e).forEach(e=>{this.dataSource.addFilter({field:t,filter:void 0,search:e})}):this.dataSource.addFilter({field:t,filter:void 0,search:o});return void this.dataSource.load(V)}this.isSearch=!1,["search","reset"].includes(e)&&(this.paginator.nowPage=1);let t=this.paginator.nowPage,o=this.validateForm.getRawValue();o.businessUnit&&(o.businessUnit=Object.keys(o.businessUnit).filter(e=>!0===o.businessUnit[e]).map(e=>e).toString()),this.restDataSource=this.tableService.searchData({apiUrl:this.accountManageService.consoleUserFunc,nowPage:t,filters:o,errMsg:"\u4f7f\u7528\u8005\u7ba1\u7406\u67e5\u7121\u8cc7\u6599"})}queryAllConsoleGroup(){if(this.loadingService.open(),this.isMock)return this.dataSource.load(O),this.consoleGroupList=O,void this.loadingService.close();this.accountManageService.getConsoleGroupList(100).pipe((0,T.K)(e=>{throw this.loadingService.close(),new Error(e.message)}),(0,y.h)(e=>e.code===h.$.SUCCESS),(0,Z.b)(e=>{this.consoleGroupList=e.result.content,this.loadingService.close()})).subscribe()}reset(){this.validateForm.reset({account:null,name:null,email:null,businessUnit:new r.cw({}),groupId:""});let e=this.validateForm.get("businessUnit");this.businessUnit.forEach(t=>{e.setControl(t.key,new r.NI(!1))}),this.isSearch=!0,this.search("reset")}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(I.V),d.Y36(G.E),d.Y36(U.r),d.Y36(N.b),d.Y36(C),d.Y36(q.x),d.Y36(_.I))},e.\u0275cmp=d.Xpm({type:e,selectors:[["console-user-list"]],features:[d.qOj],decls:27,vars:17,consts:[[1,"pageTitle"],[1,"pageContent"],[3,"formGroup"],[1,"row"],["title","\u5e33\u865f","ctlName","account",1,"col-12","col-lg-6",3,"form","maxlength"],["title","\u59d3\u540d","ctlName","name",1,"col-12","col-lg-6",3,"form","maxlength"],["title","\u96fb\u5b50\u90f5\u4ef6","ctlName","email",1,"col-12","col-lg-6",3,"form","maxlength"],["title","\u6240\u5c6c\u55ae\u4f4d","formGroupName","businessUnit",1,"col-12","col-lg-6",3,"form","selectList"],["title","\u6388\u4e88\u6b0a\u9650","ctlName","groupId",1,"col-12","col-lg-6",3,"form","selectList"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"disabled","click"],[4,"ngIf"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h1"),d._uU(2,"\u4f7f\u7528\u8005\u7ba1\u7406"),d.qZA(),d.qZA(),d.TgZ(3,"div",1),d.TgZ(4,"nb-card"),d.TgZ(5,"nb-card-header"),d.TgZ(6,"h2"),d._uU(7,"\u67e5\u8a62\u8a2d\u5b9a\u503c"),d.qZA(),d.qZA(),d.TgZ(8,"nb-card-body",2),d.TgZ(9,"div",3),d._UZ(10,"basic-input",4),d._UZ(11,"basic-input",5),d.qZA(),d.TgZ(12,"div",3),d._UZ(13,"basic-input",6),d._UZ(14,"checkbox-group",7),d._UZ(15,"dropdown",8),d.qZA(),d.qZA(),d.qZA(),d.TgZ(16,"div",3),d.TgZ(17,"div",9),d.TgZ(18,"button",10),d.NdJ("click",function(){return t.reset()}),d._uU(19,"\u6e05 \u9664"),d.qZA(),d.TgZ(20,"button",11),d.NdJ("click",function(){return t.search("search")}),d._uU(21,"\u67e5 \u8a62"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(22,"nb-card"),d.TgZ(23,"nb-card-header"),d.TgZ(24,"h2"),d._uU(25,"\u4f7f\u7528\u8005\u5217\u8868"),d.qZA(),d.qZA(),d.YNc(26,ee,3,4,"nb-card-body",12),d.qZA(),d.qZA()),2&e&&(d.xp6(8),d.Q6J("formGroup",t.validateForm),d.xp6(2),d.Q6J("form",t.validateForm)("maxlength",20),d.xp6(1),d.Q6J("form",t.validateForm)("maxlength",20),d.xp6(2),d.Q6J("form",t.validateForm)("maxlength",50),d.xp6(1),d.Q6J("form",t.validateForm)("selectList",d.VKq(13,te,t.businessUnit)),d.xp6(1),d.Q6J("form",t.validateForm)("selectList",d.VKq(15,oe,t.consoleGroupList)),d.xp6(5),d.Q6J("disabled",t.validateForm.invalid),d.xp6(6),d.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[a.Asz,a.ndF,a.yKW,r.JL,r.sg,R.n,X.A,r.x0,W.J,a.DPz,x.O5,u.T5,F.J],styles:[""]}),e})()}]}];let re=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[l.Bz.forChild(ie)],l.Bz]}),e})();const ne=[a.uuI,a.zyh,a.caZ,a.KdK,s.$,a.MfT,a.YNG,a.nKr,a.T2N,a.IIj,a.j7H.forChild(),a.urD,a.oGl,a.EoG];let se=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({providers:[C],imports:[[i.e,r.u5,r.UX,c.O,re,u.ne,n.Dv,...ne]]}),e})()},16304:(e,t,o)=>{"use strict";function i(e,t,o,i,r,n,s){try{var a=e[n](s),c=a.value}catch(u){return void o(u)}a.done?t(c):Promise.resolve(c).then(i,r)}function r(e){return function(){var t=this,o=arguments;return new Promise(function(r,n){var s=e.apply(t,o);function a(e){i(s,r,n,a,c,"next",e)}function c(e){i(s,r,n,a,c,"throw",e)}a(void 0)})}}o.d(t,{Z:()=>r})}}]);