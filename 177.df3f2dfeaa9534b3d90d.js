(self.webpackChunkconsole_frontend=self.webpackChunkconsole_frontend||[]).push([[177],{76621:(e,t,i)=>{"use strict";i.d(t,{D:()=>n});class n{constructor(e){Object.assign(this,e)}}},7896:(e,t,i)=>{"use strict";i.d(t,{I:()=>o});var n=i(37716),c=i(51425);let o=(()=>{class e{constructor(e){this.service=e,this.fileFunc="file",this.fileUploadFunc=`${this.fileFunc}/upload`,this.fileDownloadFunc=`${this.fileFunc}/download/`}uploadFileService(e,t){return this.service.doUpload(this.fileUploadFunc,e,t)}downloadFileService(e,t){this.service.doDownload(this.fileDownloadFunc+t.fileDataId,e,t)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(c.s))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},28668:(e,t,i)=>{"use strict";i.d(t,{s:()=>n});var n=(()=>(function(e){e.Tag="tag",e.ReviewTag="review-tag",e.ScheduleTag="schedule-tag",e.ScheduleActivity="schedule-activity"}(n||(n={})),n))()},10177:(e,t,i)=>{"use strict";i.r(t),i.d(t,{NB_MODULES:()=>Ye,ScheduleManageModule:()=>Be});var n=i(39363),c=i(3679),o=i(2063),a=i(73749),s=i(38832),l=i(76185),d=i(86794),r=i(63423),u=i(16304),g=i(38583);class h{constructor(e){Object.assign(this,e)}}var p=i(36332),v=i(88567),y=i(73080),m=i(27091),f=i(6258),S=i(60023),Z=i(32392),I=i(90739),T=i(25917),b=i(5304),A=i(45435),x=i(93342),q=i(68939),w=i(37716),C=i(54856),k=i(11470),z=i(15585),D=i(51425);let F=(()=>{class e{constructor(e){this.service=e,this.scheduleFunc="schedule-management/",this.batchFunc="schedule-batch-history/"}getScheduleActivitySettingDetail(e){return this.service.doGet(this.scheduleFunc+e)}getScheduleActivitySettingDetailGrid(e,t){return this.service.doGet(this.scheduleFunc+e+"/activity-setting",t)}createScheduleActivitySetting(e){return this.service.doPost(this.scheduleFunc,e)}updateScheduleActivitySetting(e,t){return this.service.doPut(this.scheduleFunc+e,t)}deleteScheduleActivitySetting(e){return this.service.doDelete(this.scheduleFunc+e)}retrigger(e,t){return this.service.doGet(this.batchFunc+"retrigger/"+e,{referenceIdList:t})}batchDownload(e,t,i){this.service.doDownload(this.batchFunc+e+"/download",t,{fileName:i+"_"+e,uploadType:".csv"})}}return e.\u0275fac=function(t){return new(t||e)(w.LFG(D.s))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e})();var N=i(23918),_=i(15114),U=i(65969),P=i(87450);function R(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"button",14),w.NdJ("click",function(){return w.CHM(e),w.oxw(2).edit()}),w._UZ(1,"nb-icon",15),w.qZA()}if(2&e){const e=w.oxw(2);w.Q6J("status","reviewing"===e.detail.reviewStatus?"basic":"primary")("disabled","reviewing"===e.detail.reviewStatus)}}function V(e,t){if(1&e&&(w.TgZ(0,"div",12),w.TgZ(1,"h1"),w._uU(2,"\u6392\u7a0b\u7ba1\u7406"),w.qZA(),w.YNc(3,R,2,2,"button",13),w.qZA()),2&e){const e=w.oxw();w.xp6(3),w.Q6J("ngIf",e.isCrud.update)}}function O(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",16),w.TgZ(1,"button",17),w.NdJ("click",function(){return w.CHM(e),w.oxw().setGridDefineInit()}),w._uU(2,"\u624b\u52d5\u66f4\u65b0"),w.qZA(),w.qZA()}}function J(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",16),w.TgZ(1,"button",11),w.NdJ("click",function(){return w.CHM(e),w.oxw().setGridDefineInit()}),w._uU(2,"\u53d6 \u6d88"),w.qZA(),w.TgZ(3,"button",17),w.NdJ("click",function(){return w.CHM(e),w.oxw().submitRefresh()}),w._uU(4,"\u78ba \u5b9a"),w.qZA(),w.qZA()}}function K(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",18),w.TgZ(1,"nb-checkbox",19),w.NdJ("change",function(){return w.CHM(e),w.oxw().onSelectAllChange(!0)}),w.qZA(),w.qZA()}if(2&e){const e=w.oxw();w.xp6(1),w.Q6J("checked",e.isAllSelected)}}function L(e,t){if(1&e&&(w.ynx(0),w._UZ(1,"ng2-smart-table",20),w._UZ(2,"paginator",21),w.BQk()),2&e){const e=t.ngIf,i=w.oxw();w.xp6(1),w.Q6J("settings",i.gridDefine)("source",e),w.xp6(1),w.Q6J("source",e)("paginator",i.paginator)}}function Q(e,t){if(1&e&&(w.TgZ(0,"div",31),w.TgZ(1,"div"),w.TgZ(2,"p"),w._uU(3),w.ALo(4,"date"),w.qZA(),w.TgZ(5,"p"),w._uU(6),w.ALo(7,"date"),w.qZA(),w.qZA(),w.TgZ(8,"div"),w.TgZ(9,"p"),w._uU(10),w.qZA(),w.TgZ(11,"p"),w._uU(12),w.qZA(),w.qZA(),w.qZA()),2&e){const e=t.$implicit,i=w.oxw(2).$implicit,n=w.oxw(2);w.Q6J("ngClass",n.isHistoryOpen[i.key]?"":"dis_none"),w.xp6(3),w.Oqu(w.xi3(4,5,e.time,n.dateFormat)),w.xp6(3),w.Oqu(w.xi3(7,8,e.time,"hh:mm:ss")),w.xp6(4),w.Oqu(e.title),w.xp6(2),w.Oqu(e.detail)}}function M(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",25),w.TgZ(1,"div",26),w.TgZ(2,"h4",27),w.NdJ("click",function(){w.CHM(e);const t=w.oxw().$implicit,i=w.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),w._uU(3),w.qZA(),w.TgZ(4,"button",28),w.NdJ("click",function(){w.CHM(e);const t=w.oxw().$implicit,i=w.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),w._UZ(5,"nb-icon",29),w.qZA(),w.qZA(),w.YNc(6,Q,13,11,"div",30),w.qZA()}if(2&e){const e=t.ngIf,i=w.oxw().$implicit,n=w.oxw(2);w.Q6J("ngClass",n.isHistoryOpen[i.key]?"closeSubItem":""),w.xp6(3),w.Oqu(e.type),w.xp6(3),w.Q6J("ngForOf",e.flows)}}function $(e,t){if(1&e&&(w.ynx(0),w.YNc(1,M,7,3,"div",24),w.BQk()),2&e){const e=t.$implicit;w.xp6(1),w.Q6J("ngIf",e.value)}}function Y(e,t){if(1&e&&(w.TgZ(0,"nb-card-body"),w.TgZ(1,"div",22),w.YNc(2,$,2,1,"ng-container",23),w.ALo(3,"keyvalue"),w.qZA(),w.qZA()),2&e){const e=w.oxw();w.xp6(2),w.Q6J("ngForOf",w.lcZ(3,1,e.detail.historyGroupView))}}let B=(()=>{class e extends Z.H{constructor(e,t,i,n,c,o,a,s){super(e,t,i),this.router=n,this.activatedRoute=c,this.scheduleManageService=o,this.dialogService=a,this.loadingService=s,this.isHistoryOpen=[],this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.isAllSelected=!1,this.selectedRows=new Array,this.tempPageIsAllSelected=new Array,this.gridDefine={pager:{display:!0,perPage:10},actions:!1,hideSubHeader:!0,columns:{activityName:{title:"\u6d3b\u52d5\u540d\u7a31",type:"string",sort:!1},activityDescription:{title:"\u6d3b\u52d5\u8aaa\u660e",type:"html",valuePrepareFunction:e=>`<p>${null!=e?e:""}</p>`,sort:!1},status:{title:"\u72c0\u614b",type:"html",class:"text_center w100",valuePrepareFunction:(e,t)=>`<p class="text_center">${p.qb[t.reviewStatus]||p.qb[e]||""}</p>`,sort:!1},batchUpdateTime:{title:"\u6279\u6b21\u66f4\u65b0\u6642\u9593",type:"html",class:"text_center w200",valuePrepareFunction:e=>e?'<p class="text_center">'+new g.uU("en-US").transform(e,"yyyy-MM-dd HH:mm:ss")+"</p>":"",sort:!1},filterOptions:{title:"\u66f4\u65b0\u7d50\u679c",type:"html",width:"3rem",valuePrepareFunction:e=>{const t=null==e?void 0:e.toLowerCase();return m.l.isBlank(t)?t:`<p class="text_center ${p.CZ[t]||""}">`+(p.nC[t]||"")+"</p>"},sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",renderComponent:S.P,onComponentInitFunction:e=>{e.emitter.subscribe(e=>{this.router.navigate(["pages","schedule-manage","schedule-activity-export-detail",this.scheduleId,e.activityId],{state:e})})},sort:!1}},noDataMessage:"\u67e5\u7121\u8cc7\u6599"}}ngOnInit(){if(this.scheduleId=this.activatedRoute.snapshot.params.scheduleId,this.loadingService.open(),this.isMock){let e=y.P.find(e=>e.scheduleId===this.scheduleId);return this.detail=JSON.parse(JSON.stringify(e)),this.dataSource.load(e.activitySetting),void this.loadingService.close()}this.dataSource=new l.nC;const e=this.scheduleManageService.getScheduleActivitySettingDetail(this.scheduleId),t=this.storageService.getSessionVal(this.sessionKey),i=this.scheduleManageService.getScheduleActivitySettingDetailGrid(this.scheduleId,(null==t?void 0:t.page)?{page:t.page}:null);(0,I.aj)([e,i]).pipe((0,b.K)(e=>(this.handleErrorResponse(e,"\u67e5\u7121\u6b64\u7b46\u8cc7\u6599\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u540d\u55ae\u6392\u7a0b",["pages","schedule-manage","schedule-activity-list"]),(0,T.of)(null))),(0,A.h)(([e,t])=>null!==e&&e.code===v.$.SUCCESS&&null!==t&&t.code===v.$.SUCCESS),(0,x.b)(([e,t])=>{var i;this.detail=JSON.parse(JSON.stringify(e.result));const n=m.l.getHistoryProcessData("scheduleReviewHistoryAud",this.detail);n&&(this.isHistoryOpen=n.isHistoryOpen,this.detail.historyGroupView=null===(i=n.detail)||void 0===i?void 0:i.historyGroupView);const c=JSON.parse(JSON.stringify(t.result)),o=this.mapGridDataToActivitySettings(c);this.dataSource.load(o)}),(0,q.x)(()=>{this.loadingService.close()})).subscribe()}ngOnDestroy(){var e,t;this.setSessionVal({page:this.paginator.nowPage,isOpenCheckbox:!!(null===(t=null===(e=null==this?void 0:this.gridDefine)||void 0===e?void 0:e.columns)||void 0===t?void 0:t.isChecked),isPageAllSelected:this.tempPageIsAllSelected})}ngDoCheck(){var e,t,i;if(this.ng2SmartTable){const n=this.paginator.nowPage;if(this.previousPage!==n){this.previousPage=n;const c=this.storageService.getSessionVal(this.sessionKey);if((null==c?void 0:c.isOpenCheckbox)&&(null===(e=null==c?void 0:c.isPageAllSelected)||void 0===e?void 0:e.find(e=>(null==e?void 0:e.pageNum)===n)))return void(this.isAllSelected=null===(i=null===(t=null==c?void 0:c.isPageAllSelected)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.pageNum)===n))||void 0===i?void 0:i.val);this.isAllSelected=!1}}}processExecutionFrequency(e,t){return m.l.processExecutionFrequency(e,t)}handleErrorResponse(e,t,i){throw this.dialogService.alertAndBackToList(!1,t,i),new Error(e.message)}mapGridDataToActivitySettings(e){return e.content.map(e=>new h({activityId:e.activityId,version:e.version,activityName:e.activityName,activityDescription:e.activityDescription,department:e.department,owner:e.owner,filterOptions:e.filterOptions,listLimit:e.listLimit,status:e.status,startDate:e.startDate,endDate:e.endDate,createTime:e.createTime,modificationTime:e.modificationTime,scheduleSettings:e.scheduleSettings,batchUpdateTime:e.batchUpdateTime}))}setGridDefineInit(){var e,t,i,n;this.selectedRows=new Array,this.isAllSelected=!1,this.tempPageIsAllSelected=new Array,(null===(t=null===(e=null==this?void 0:this.gridDefine)||void 0===e?void 0:e.columns)||void 0===t?void 0:t.isChecked)?(delete this.gridDefine.columns.isChecked,this.gridDefine.columns=Object.assign(this.gridDefine.columns,{action:{title:"\u67e5\u770b",type:"custom",width:"5%",renderComponent:S.P,onComponentInitFunction:e=>{e.emitter.subscribe(e=>{this.router.navigate(["pages","schedule-manage","schedule-activity-export-detail",this.scheduleId,e.activityId],{state:e})})},sort:!1}})):(delete this.gridDefine.columns.action,this.gridDefine.columns=Object.assign({isChecked:{title:"",type:"custom",width:"5%",sort:!1,filter:!1,filterFunction:!1,visible:!0,renderComponent:f.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"status",answer:["enabled","reviewing"]},rowIdName:"activityId",selectedRows:this.selectedRows},e.emitter.subscribe(e=>{var t;this.dataSource.getElements().then(e=>{var t,i;const n=e.filter(e=>e.isShow).length,c=e.filter(e=>e.isShow&&e.isSelected).length;this.isAllSelected=!1,c===n&&(this.isAllSelected=!0),this.tempPageIsAllSelected=m.l.onSetTempPageIsAllSelected(this.tempPageIsAllSelected,this.paginator.nowPage,this.isAllSelected),this.setSessionVal({page:this.paginator.nowPage,isOpenCheckbox:!!(null===(i=null===(t=null==this?void 0:this.gridDefine)||void 0===t?void 0:t.columns)||void 0===i?void 0:i.isChecked),isPageAllSelected:this.tempPageIsAllSelected})}),e.isSelected&&e.activityId?this.selectedRows.push({rowId:e.activityId}):(null!==(t=this.selectedRows.length)&&void 0!==t?t:0)>0&&this.selectedRows.find(t=>t.rowId===e.activityId)&&(this.selectedRows=this.selectedRows.filter(t=>t.rowId!==e.activityId))})}}},this.gridDefine.columns)),this.setSessionVal({page:this.paginator.nowPage,isOpenCheckbox:!!(null===(n=null===(i=null==this?void 0:this.gridDefine)||void 0===i?void 0:i.columns)||void 0===n?void 0:n.isChecked),isPageAllSelected:this.tempPageIsAllSelected}),this.ng2SmartTable.initGrid(),this.getSessionSetPage()}onSelectAllChange(e){var t=this;return(0,u.Z)(function*(){var i,n;const c=t.storageService.getSessionVal(t.sessionKey),o=((null==c?void 0:c.isPageAllSelected)||[]).find(e=>(null==e?void 0:e.pageNum)===t.paginator.nowPage);t.isAllSelected=!e&&(null==c?void 0:c.isOpenCheckbox)&&o?o.val:!t.isAllSelected,t.tempPageIsAllSelected=m.l.onSetTempPageIsAllSelected(t.tempPageIsAllSelected,t.paginator.nowPage,t.isAllSelected),t.setSessionVal({page:t.paginator.nowPage,isOpenCheckbox:!!(null===(n=null===(i=null==t?void 0:t.gridDefine)||void 0===i?void 0:i.columns)||void 0===n?void 0:n.isChecked),isPageAllSelected:t.tempPageIsAllSelected}),t.selectedRows=yield m.l.onSetGridPageChecked("activityId",t.dataSource,t.selectedRows,t.isAllSelected),t.ng2SmartTable.initGrid(),t.getSessionSetPage()})()}submitRefresh(){if(this.selectedRows.length>0){const e=this.selectedRows.map(e=>e.rowId);this.loadingService.open(),this.scheduleManageService.retrigger("activity",e.toString()).pipe((0,b.K)(e=>{throw this.dialogService.alertAndBackToList(!1,`\u624b\u52d5\u66f4\u65b0\u5931\u6557: ${e.message}`),new Error(e.message)}),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(()=>{this.setGridDefineInit(),this.loadingService.close()})).subscribe()}else this.dialogService.showToast("warning","\u8acb\u81f3\u5c11\u9078\u64c7\u4e00\u7b46")}edit(){this.router.navigate(["pages","schedule-manage","schedule-activity-set","edit",this.detail.scheduleId],{state:this.detail})}cancel(){this.router.navigate(["pages","schedule-manage","schedule-activity-list"])}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(C.V),w.Y36(k.E),w.Y36(z.r),w.Y36(r.F0),w.Y36(r.gz),w.Y36(F),w.Y36(N.x),w.Y36(_.b))},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-activity-detail"]],viewQuery:function(e,t){if(1&e&&w.Gf(l.T5,5),2&e){let e;w.iGM(e=w.CRH())&&(t.ng2SmartTable=e.first)}},features:[w.qOj],decls:53,vars:17,consts:[["class","pageTitle",4,"ngIf"],[1,"pageContent"],[1,"row"],[1,"textGroup","col-12","col-lg-4"],[1,"text_bold"],[1,"textGroup","col-12","col-lg-8"],["class","rightBox",4,"ngIf"],[1,"tableContainer"],["class","selectAll",4,"ngIf"],[4,"ngIf"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],[1,"pageTitle"],["nbButton","","size","tiny","class","iconBtn",3,"status","disabled","click",4,"ngIf"],["nbButton","","size","tiny",1,"iconBtn",3,"status","disabled","click"],["icon","edit-outline"],[1,"rightBox"],["nbButton","","status","primary","size","medium",3,"click"],[1,"selectAll"],["status","info",3,"checked","change"],[3,"settings","source"],[3,"source","paginator"],[1,"historyList"],[4,"ngFor","ngForOf"],["class","historyItem active moreBtn",3,"ngClass",4,"ngIf"],[1,"historyItem","active","moreBtn",3,"ngClass"],[1,"mainItem"],[3,"click"],["nbButton","","ghost","","status","info","size","tiny",1,"iconBtn",3,"click"],["icon","arrow-ios-forward"],["class","subItem",3,"ngClass",4,"ngFor","ngForOf"],[1,"subItem",3,"ngClass"]],template:function(e,t){1&e&&(w.YNc(0,V,4,1,"div",0),w.TgZ(1,"div",1),w.TgZ(2,"nb-card"),w.TgZ(3,"nb-card-body"),w.TgZ(4,"div",2),w.TgZ(5,"div",3),w.TgZ(6,"p",4),w._uU(7,"\u4f5c\u696d\u540d\u7a31\uff1a"),w.qZA(),w.TgZ(8,"span"),w._uU(9),w.qZA(),w.qZA(),w.TgZ(10,"div",3),w.TgZ(11,"p",4),w._uU(12,"\u72c0\u614b\uff1a"),w.qZA(),w.TgZ(13,"span"),w._uU(14),w.ALo(15,"enum"),w.qZA(),w.qZA(),w.TgZ(16,"div",3),w.TgZ(17,"p",4),w._uU(18,"\u57f7\u884c\u983b\u7387\uff1a"),w.qZA(),w.TgZ(19,"span"),w._uU(20),w.qZA(),w.qZA(),w.qZA(),w.TgZ(21,"div",2),w.TgZ(22,"div",5),w.TgZ(23,"p",4),w._uU(24,"\u6a94\u6848\u5b58\u653e\u4f4d\u7f6e\uff1a"),w.qZA(),w.TgZ(25,"span"),w._uU(26),w.qZA(),w.qZA(),w.TgZ(27,"div",3),w.TgZ(28,"p",4),w._uU(29,"\u7570\u52d5\u6642\u9593\uff1a"),w.qZA(),w.TgZ(30,"span"),w._uU(31),w.ALo(32,"date"),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.TgZ(33,"nb-card"),w.TgZ(34,"nb-card-header"),w.TgZ(35,"h2"),w._uU(36,"\u540d\u55ae\u5217\u8868"),w.qZA(),w.qZA(),w.TgZ(37,"nb-card-body"),w.TgZ(38,"div"),w.YNc(39,O,3,0,"div",6),w.YNc(40,J,5,0,"div",6),w.TgZ(41,"div",7),w.YNc(42,K,2,1,"div",8),w.YNc(43,L,3,4,"ng-container",9),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.TgZ(44,"nb-card"),w.TgZ(45,"nb-card-header"),w.TgZ(46,"h2"),w._uU(47,"\u7570\u52d5\u6b77\u7a0b"),w.qZA(),w.qZA(),w.YNc(48,Y,4,3,"nb-card-body",9),w.qZA(),w.TgZ(49,"div",2),w.TgZ(50,"div",10),w.TgZ(51,"button",11),w.NdJ("click",function(){return t.cancel()}),w._uU(52,"\u8fd4 \u56de"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.Q6J("ngIf",t.detail),w.xp6(9),w.Oqu(null==t.detail?null:t.detail.jobName),w.xp6(5),w.Oqu(w.xi3(15,11,null==t.detail||null==t.detail.status?null:t.detail.status.toLowerCase(),"status")),w.xp6(6),w.Oqu(t.processExecutionFrequency(null==t.detail?null:t.detail.executionFrequency,null==t.detail?null:t.detail.frequencyTime)),w.xp6(6),w.Oqu(null==t.detail?null:t.detail.filePath),w.xp6(5),w.Oqu(w.xi3(32,14,null==t.detail?null:t.detail.modificationTime,t.dateFormat)),w.xp6(8),w.Q6J("ngIf",!(null!=t&&null!=t.gridDefine&&null!=t.gridDefine.columns&&t.gridDefine.columns.isChecked)&&t.isCrud.update),w.xp6(1),w.Q6J("ngIf",(null==t||null==t.gridDefine||null==t.gridDefine.columns?null:t.gridDefine.columns.isChecked)&&t.isCrud.update),w.xp6(2),w.Q6J("ngIf",null==t||null==t.gridDefine||null==t.gridDefine.columns?null:t.gridDefine.columns.isChecked),w.xp6(1),w.Q6J("ngIf",t.restDataSource||t.dataSource),w.xp6(5),w.Q6J("ngIf",t.isHistoryOpen&&(null==t.detail?null:t.detail.historyGroupView)))},directives:[g.O5,s.Asz,s.yKW,s.ndF,s.DPz,s.fMN,s.NTf,l.T5,U.J,g.sg,g.mk],pipes:[P.z,g.uU,g.Nd],styles:[""]}),e})();var j=i(28668),E=i(22191);function H(e,t){if(1&e&&(w.TgZ(0,"div",5),w.TgZ(1,"div",8),w.TgZ(2,"p",9),w._uU(3,"\u6d3b\u52d5\u540d\u7a31\uff1a"),w.qZA(),w.TgZ(4,"span"),w._uU(5),w.qZA(),w.qZA(),w.TgZ(6,"div",8),w.TgZ(7,"p",9),w._uU(8,"\u72c0\u614b\uff1a"),w.qZA(),w.TgZ(9,"span"),w._uU(10),w.ALo(11,"enum"),w.qZA(),w.qZA(),w.TgZ(12,"div",8),w.TgZ(13,"p",9),w._uU(14,"\u540d\u55ae\u4e0a\u9650\uff1a"),w.qZA(),w.TgZ(15,"span"),w._uU(16),w.qZA(),w.qZA(),w.TgZ(17,"div",8),w.TgZ(18,"p",9),w._uU(19,"\u540d\u55ae\u5dee\u7570\u904e\u6ffe\uff1a"),w.qZA(),w.TgZ(20,"span"),w._uU(21),w.ALo(22,"enum"),w.qZA(),w.qZA(),w.TgZ(23,"div",8),w.TgZ(24,"p",9),w._uU(25,"\u8d77\u8fc4\u6642\u9593\uff1a"),w.qZA(),w.TgZ(26,"span"),w._uU(27),w.qZA(),w.qZA(),w.TgZ(28,"div",8),w.TgZ(29,"p",9),w._uU(30,"\u63cf\u8ff0\u8aaa\u660e\uff1a"),w.qZA(),w.TgZ(31,"span"),w._uU(32),w.qZA(),w.qZA(),w.TgZ(33,"div",8),w.TgZ(34,"p",9),w._uU(35,"\u7570\u52d5\u6642\u9593\uff1a"),w.qZA(),w.TgZ(36,"span"),w._uU(37),w.ALo(38,"date"),w.qZA(),w.qZA(),w.TgZ(39,"div",8),w.TgZ(40,"p",9),w._uU(41,"\u6392\u7a0b\u8a2d\u5b9a\uff1a"),w.qZA(),w.TgZ(42,"span"),w._uU(43),w.ALo(44,"enum"),w.qZA(),w.qZA(),w.TgZ(45,"div",8),w.TgZ(46,"p",9),w._uU(47,"\u6279\u6b21\u66f4\u65b0\u6642\u9593\uff1a"),w.qZA(),w.TgZ(48,"span"),w._uU(49),w.qZA(),w.qZA(),w.qZA()),2&e){const e=w.oxw();w.xp6(5),w.Oqu(e.activitySetting.activityName),w.xp6(5),w.Oqu(w.xi3(11,10,null==e.activitySetting.status?null:e.activitySetting.status.toLowerCase(),"status")),w.xp6(6),w.Oqu(e.activitySetting.listLimit),w.xp6(5),w.Oqu(w.xi3(22,13,e.activitySetting.filterOptions,"filter")),w.xp6(6),w.AsE("",e.activitySetting.startDate,"~",e.activitySetting.endDate,""),w.xp6(5),w.Oqu(e.activitySetting.activityDescription),w.xp6(5),w.Oqu(w.xi3(38,16,e.activitySetting.modificationTime,e.dateFormat)),w.xp6(6),w.Oqu(w.xi3(44,19,null==e.activitySetting.scheduleSettings?null:e.activitySetting.scheduleSettings.toLowerCase(),"frequency")),w.xp6(6),w.Oqu(e.activitySetting.batchUpdateTime)}}let G=(()=>{class e extends Z.H{constructor(e,t,i,n,c,o,a,s,l){super(e,t,i),this.router=n,this.activatedRoute=c,this.customerManageService=o,this.scheduleManageService=a,this.loadingService=s,this.dialogService=l,this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.gridDefine={pager:{display:!0,perPage:10},tableId:"true",columns:{historyId:{title:"\u9805\u6b21",type:"html",class:"text_center",valuePrepareFunction:e=>`<p class="text_center">${null!=e?e:0}</p>`,sort:!1},batchTime:{title:"\u6279\u6b21\u6642\u9593",type:"html",class:"w300",valuePrepareFunction:e=>e?`<p>${new g.uU("en-US").transform(e,"yyyy-MM-dd HH:mm:ss")}</p>`:"",sort:!1},batchResultCount:{title:"\u540d\u55ae\u6578\u91cf",type:"html",class:"text_center w100",valuePrepareFunction:e=>`<p class="text_center">${null!=e?e:0}</p>`,sort:!1},batchResult:{title:"\u6392\u7a0b\u7d50\u679c",type:"html",valuePrepareFunction:e=>{const t=null==e?void 0:e.toLowerCase();return m.l.isBlank(t)?t:`<p class="${p.CZ[t]||""}">\u6279\u6b21\u6392\u7a0b${p.nC[t]||""}</p>`},sort:!1},action:{title:"\u532f\u51fa",type:"custom",class:"center",width:"3rem",renderComponent:S.P,onComponentInitFunction:e=>{var t,i,n,c,o;e.settings={btnStatus:"success",btnIcon:"cloud-download-outline",disabled:(null===(n=null===(i=null===(t=this.loginService.userProfileSubject)||void 0===t?void 0:t.value)||void 0===i?void 0:i.businessUnit)||void 0===n?void 0:n.toLowerCase())!==(null===(o=null===(c=this.activitySetting)||void 0===c?void 0:c.department)||void 0===o?void 0:o.toLowerCase())},e.getRow.subscribe(t=>{e.isShow="success"===t.batchResult.toLowerCase()}),e.emitter.subscribe(e=>{this.scheduleManageService.batchDownload(e.historyId,j.s.ScheduleActivity,this.activitySetting.activityName)})},sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.params=this.activatedRoute.snapshot.params}ngOnDestroy(){this.storageService.putSessionVal(this.sessionKey,{page:this.paginator.nowPage})}ngOnInit(){if(console.info("userProfile",this.loginService.userProfileSubject),this.scheduleId=this.activatedRoute.snapshot.params.scheduleId,this.referenceId=this.activatedRoute.snapshot.params.referenceId,this.loadingService.open(),this.isMock)return this.activitySetting=y.P[0].activitySetting[0],this.dataSource.load(this.activitySetting.schedule_batch_history),void this.loadingService.close();this.dataSource=new l.nC,this.customerManageService.getActivitySettingRow(this.referenceId).pipe((0,b.K)(e=>{throw this.dialogService.alertAndBackToList(!1,"\u67e5\u7121\u6b64\u7b46\u6d3b\u52d5\u6392\u7a0b",["pages","schedule-manage","schedule-activity-detail"]),new Error(e.message)}),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(e=>{this.activitySetting=JSON.parse(JSON.stringify(e.result)),this.dataSource.load(this.activitySetting.scheduleBatchHistory),this.dataSource.setSort([{field:"batchTime",direction:"desc"}]),this.loadingService.close()})).subscribe()}cancel(){this.router.navigate(["pages","schedule-manage","schedule-activity-detail",this.params.scheduleId])}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(C.V),w.Y36(k.E),w.Y36(z.r),w.Y36(r.F0),w.Y36(r.gz),w.Y36(E.Q),w.Y36(F),w.Y36(_.b),w.Y36(N.x))},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-activity-export-detail"]],features:[w.qOj],decls:18,vars:5,consts:[[1,"pageTitle"],[1,"pageContent"],["class","row",4,"ngIf"],[3,"settings","source"],[3,"source","paginator"],[1,"row"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],[1,"textGroup","col-12","col-lg-4"],[1,"text_bold"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"h1"),w._uU(2,"\u6392\u7a0b\u7d00\u9304"),w.qZA(),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"nb-card"),w.TgZ(5,"nb-card-body"),w.YNc(6,H,50,22,"div",2),w.qZA(),w.qZA(),w.TgZ(7,"nb-card"),w.TgZ(8,"nb-card-header"),w.TgZ(9,"h2"),w._uU(10,"\u6392\u7a0b\u7d00\u9304"),w.qZA(),w.qZA(),w.TgZ(11,"nb-card-body"),w._UZ(12,"ng2-smart-table",3),w._UZ(13,"paginator",4),w.qZA(),w.qZA(),w.TgZ(14,"div",5),w.TgZ(15,"div",6),w.TgZ(16,"button",7),w.NdJ("click",function(){return t.cancel()}),w._uU(17,"\u8fd4 \u56de"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(6),w.Q6J("ngIf",!!t.activitySetting),w.xp6(6),w.Q6J("settings",t.gridDefine)("source",t.dataSource),w.xp6(1),w.Q6J("source",t.dataSource)("paginator",t.paginator))},directives:[s.Asz,s.yKW,g.O5,s.ndF,l.T5,U.J,s.DPz],pipes:[P.z,g.uU],styles:[""]}),e})();var W=i(63731),X=i(35043);function ee(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"button",5),w.NdJ("click",function(){return w.CHM(e),w.oxw().add()}),w._uU(1,"\u65b0 \u589e"),w.qZA()}}function te(e,t){if(1&e&&(w.ynx(0),w._UZ(1,"ng2-smart-table",6),w._UZ(2,"paginator",7),w.BQk()),2&e){const e=t.ngIf,i=w.oxw();w.xp6(1),w.Q6J("settings",i.gridDefine)("source",e),w.xp6(1),w.Q6J("source",e)("paginator",i.paginator)}}let ie=(()=>{class e extends Z.H{constructor(e,t,i,n,c,o,a){super(e,t,i),this.router=n,this.activatedRoute=c,this.scheduleManageService=o,this.tableService=a,this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.gridDefine={pager:{display:!0,perPage:10},columns:{jobName:{title:"\u4f5c\u696d\u540d\u7a31",type:"string",sort:!1},activityCount:{title:"\u540d\u55ae\u6578\u91cf",type:"html",class:"text_center w150",valuePrepareFunction:(e,t)=>'<p class="text_center">'+(null==t?void 0:t.activitySetting.length)+"</p>",sort:!1},executionFrequency:{title:"\u57f7\u884c\u983b\u7387",type:"html",valuePrepareFunction:(e,t)=>m.l.processExecutionFrequency(null!=e?e:"",null==t?void 0:t.frequencyTime),sort:!1},modificationTime:{title:"\u7570\u52d5\u6642\u9593",type:"html",class:"text_center w200",valuePrepareFunction:e=>e?'<p class="text_center">'+new g.uU("en-US").transform(e,this.dateFormat)+"</p>":"",sort:!1},status:{title:"\u72c0\u614b",type:"html",class:"text_center w100",valuePrepareFunction:(e,t)=>`<p class="text_center">${p.qb[t.reviewStatus]||p.qb[e]||""}</p>`,sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",valuePrepareFunction:(e,t)=>t,renderComponent:W.m,sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}}}ngOnInit(){var e;if(this.isMock)return void this.dataSource.load(y.P);const t=null===(e=this.storageService.getSessionVal(this.sessionKey))||void 0===e?void 0:e.page;this.restDataSource=this.tableService.searchData({apiUrl:this.scheduleManageService.scheduleFunc,nowPage:t||this.paginator.nowPage,errMsg:"\u6392\u7a0b\u5217\u8868\u67e5\u7121\u8cc7\u6599"})}ngOnDestroy(){this.storageService.putSessionVal(this.sessionKey,{page:this.paginator.nowPage})}add(){this.router.navigate(["pages","schedule-manage","schedule-activity-set"])}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(C.V),w.Y36(k.E),w.Y36(z.r),w.Y36(r.F0),w.Y36(r.gz),w.Y36(F),w.Y36(X.I))},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-activity-list"]],features:[w.qOj],decls:12,vars:2,consts:[[1,"pageTitle"],[1,"pageContent"],[1,"rightBox"],["nbButton","","status","primary","size","medium",3,"click",4,"ngIf"],[4,"ngIf"],["nbButton","","status","primary","size","medium",3,"click"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"h1"),w._uU(2,"\u540d\u55ae\u6392\u7a0b"),w.qZA(),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"nb-card"),w.TgZ(5,"nb-card-header"),w.TgZ(6,"h2"),w._uU(7,"\u6392\u7a0b\u5217\u8868"),w.qZA(),w.qZA(),w.TgZ(8,"nb-card-body"),w.TgZ(9,"div",2),w.YNc(10,ee,2,0,"button",3),w.qZA(),w.YNc(11,te,3,4,"ng-container",4),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(10),w.Q6J("ngIf",t.isCrud.create),w.xp6(1),w.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[s.Asz,s.ndF,s.yKW,g.O5,s.DPz,l.T5,U.J],styles:[""]}),e})();var ne=i(21523);function ce(e,t){if(1&e&&(w.TgZ(0,"nb-option",13),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e),w.xp6(1),w.Oqu(e.val)}}const oe=function(e){return{error:e}};let ae=(()=>{class e extends Z.H{constructor(e,t,i,n,o){super(i,n,o),this.ref=e,this.changeDetectorRef=t,this.selectedActivityId="",this.selectedActivityValue="",this.filterDataList=[],this.existsInActivityList=e=>{var t,i,n;let c="";return c=(null==e?void 0:e.value)instanceof Object&&"key"in(null==e?void 0:e.value)&&"val"in(null==e?void 0:e.value)?null===(i=null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.val)||void 0===i?void 0:i.toLowerCase():null===(n=null==e?void 0:e.value)||void 0===n?void 0:n.toLowerCase(),(e.dirty||e.touched||e.valueChanges)&&this.dataList&&!m.l.isBlank(c)&&0===this.dataList.filter(e=>{var t;return(null===(t=null==e?void 0:e.val)||void 0===t?void 0:t.toLowerCase())===c}).length?{activityErrMsg:"\u4e0d\u5b58\u5728\u6d3b\u52d5\u6e05\u55ae\u4e2d"}:(e.dirty||e.touched)&&m.l.isBlank(c)?{activityErrMsg:"\u4e0d\u53ef\u70ba\u7a7a"}:null},this.validateForm=new c.cw({activityName:new c.NI(null,this.existsInActivityList)})}onBlurActivityInput(){var e,t,i,n,c;(null===(e=this.validateForm.get("activityName"))||void 0===e?void 0:e.hasError("activityErrMsg"))||(0!==(null===(t=this.dataList)||void 0===t?void 0:t.length)?m.l.isBlank(this.selectedActivityId)?null===(n=this.validateForm.get("activityName"))||void 0===n||n.setErrors({activityErrMsg:"\u8acb\u9ede\u9078\u4e00\u7b46"}):null===(c=this.validateForm.get("activityName"))||void 0===c||c.setErrors(null):null===(i=this.validateForm.get("activityName"))||void 0===i||i.setErrors({activityErrMsg:"\u67e5\u7121\u6d3b\u52d5\u6e05\u55ae"}))}onActivityChange(e){var t,i;this.selectedActivityId="",this.filterDataList=this.activityFilter(e.target.value),(null===(t=this.validateForm.get("activityName"))||void 0===t?void 0:t.hasError("activityErrMsg"))||m.l.isBlank(this.selectedActivityId)&&(null===(i=this.validateForm.get("activityName"))||void 0===i||i.setErrors({activityErrMsg:"\u8acb\u9ede\u9078\u4e00\u7b46"}))}onActivitySelectChange(e){if(m.l.isBlank(e.key)||m.l.isBlank(e.val))return null;this.selectedActivityId=e.key,this.selectedActivityValue=e.val,this.validateForm.get("activityName").setValue(this.selectedActivityValue)}activityFilter(e){const t=null==e?void 0:e.toLowerCase();return m.l.isBlank(t)?this.dataList:this.dataList.filter(e=>{var i,n;return null===(n=null===(i=e.val)||void 0===i?void 0:i.toLowerCase())||void 0===n?void 0:n.includes(t)})}ngOnInit(){this.dataList&&(this.filterDataList=this.dataList)}ngAfterViewChecked(){this.changeDetectorRef.detectChanges()}close(){this.ref.close()}submit(){this.ref.close({key:this.selectedActivityId,val:this.selectedActivityValue})}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(s.X4l),w.Y36(w.sBO),w.Y36(C.V),w.Y36(k.E),w.Y36(z.r))},e.\u0275cmp=w.Xpm({type:e,selectors:[["preview-dialog"]],inputs:{title:"title",dataList:"dataList"},features:[w.qOj],decls:27,vars:10,consts:[[1,"dialogCard","medium"],[3,"formGroup"],[1,"row"],[1,"fieldGroup","essential","col-12","col-lg-12",3,"ngClass"],["nbInput","","fullWidth","","type","text","placeholder","\u8acb\u8f38\u5165\u6216\u9078\u64c7","formControlName","activityName",3,"nbAutocomplete","status","blur","input"],[3,"selectedChange"],["auto",""],[3,"value",4,"ngFor","ngForOf"],[1,"note","errorText"],["icon","alert-triangle"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","info","size","medium",3,"disabled","click"],[3,"value"]],template:function(e,t){if(1&e&&(w.TgZ(0,"nb-card",0),w.TgZ(1,"nb-card-header"),w.TgZ(2,"p"),w._uU(3),w.qZA(),w.qZA(),w.TgZ(4,"nb-card-body",1),w.TgZ(5,"div",2),w.TgZ(6,"p"),w._uU(7,"\u60a8\u53ef\u4ee5\u52a0\u5165\u5c1a\u672a\u8a2d\u5b9a\u6392\u7a0b\u7684\u540d\u55ae\u5217\u8868"),w.qZA(),w.qZA(),w.TgZ(8,"div",2),w.TgZ(9,"div",3),w.TgZ(10,"label"),w._uU(11,"\u540d\u55ae\u5217\u8868"),w.qZA(),w.TgZ(12,"div"),w.TgZ(13,"input",4),w.NdJ("blur",function(){return t.onBlurActivityInput()})("input",function(e){return t.onActivityChange(e)}),w.qZA(),w.TgZ(14,"nb-autocomplete",5,6),w.NdJ("selectedChange",function(e){return t.onActivitySelectChange(e)}),w.YNc(16,ce,2,2,"nb-option",7),w.qZA(),w.qZA(),w.TgZ(17,"div",8),w._UZ(18,"nb-icon",9),w.TgZ(19,"p"),w._uU(20),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.TgZ(21,"nb-card-footer"),w.TgZ(22,"div",10),w.TgZ(23,"button",11),w.NdJ("click",function(){return t.close()}),w._uU(24,"\u95dc \u9589"),w.qZA(),w.TgZ(25,"button",12),w.NdJ("click",function(){return t.submit()}),w._uU(26,"\u9001 \u51fa"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e){const e=w.MAs(15);let i,n;w.xp6(3),w.Oqu(t.title),w.xp6(1),w.Q6J("formGroup",t.validateForm),w.xp6(5),w.Q6J("ngClass",w.VKq(8,oe,t.validateForm.invalid)),w.xp6(4),w.Q6J("nbAutocomplete",e)("status",t.validateForm.invalid?"danger":"basic"),w.xp6(3),w.Q6J("ngForOf",t.filterDataList),w.xp6(4),w.Oqu(null==(i=t.validateForm.get("activityName"))||null==i.errors?null:i.errors.activityErrMsg),w.xp6(5),w.Q6J("disabled",!t.selectedActivityId||(null==(n=t.validateForm.get("activityName"))?null:n.hasError("activityErrMsg"))||""===(null==(n=t.validateForm.get("activityName"))?null:n.value))}},directives:[s.Asz,s.ndF,s.yKW,c.JL,c.sg,g.mk,s.h8i,c.Fj,s.wNd,c.JJ,c.u,s.Xh,g.sg,s.fMN,s.XWE,s.DPz,s.q51],styles:[""]}),e})();var se=i(68877),le=i(79761),de=i(46988);function re(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function ue(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function ge(e,t){if(1&e&&(w.TgZ(0,"div",19),w.TgZ(1,"nb-select",20),w.YNc(2,re,2,2,"nb-option",21),w.qZA(),w.TgZ(3,"span"),w._uU(4,"\uff1a"),w.qZA(),w.TgZ(5,"nb-select",22),w.YNc(6,ue,2,2,"nb-option",21),w.qZA(),w.qZA()),2&e){const e=w.oxw();let t,i;w.xp6(1),w.Q6J("status",null!=(t=e.validateForm.get("hour"))&&t.touched&&null!=(t=e.validateForm.get("hour"))&&t.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.hourList),w.xp6(3),w.Q6J("status",null!=(i=e.validateForm.get("minute"))&&i.touched&&null!=(i=e.validateForm.get("minute"))&&i.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.minuteList)}}function he(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function pe(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function ve(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function ye(e,t){if(1&e&&(w.TgZ(0,"div",19),w.TgZ(1,"nb-select",24),w.YNc(2,he,2,2,"nb-option",21),w.qZA(),w.TgZ(3,"nb-select",20),w.YNc(4,pe,2,2,"nb-option",21),w.qZA(),w.TgZ(5,"span"),w._uU(6,"\uff1a"),w.qZA(),w.TgZ(7,"nb-select",22),w.YNc(8,ve,2,2,"nb-option",21),w.qZA(),w.qZA()),2&e){const e=w.oxw();let t,i,n;w.xp6(1),w.Q6J("status",null!=(t=e.validateForm.get("daily"))&&t.touched&&null!=(t=e.validateForm.get("daily"))&&t.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.weekDailyList),w.xp6(1),w.Q6J("status",null!=(i=e.validateForm.get("hour"))&&i.touched&&null!=(i=e.validateForm.get("hour"))&&i.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.hourList),w.xp6(3),w.Q6J("status",null!=(n=e.validateForm.get("minute"))&&n.touched&&null!=(n=e.validateForm.get("minute"))&&n.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.minuteList)}}function me(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function fe(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function Se(e,t){if(1&e&&(w.TgZ(0,"nb-option",23),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.key),w.xp6(1),w.Oqu(e.val)}}function Ze(e,t){if(1&e&&(w.TgZ(0,"div",19),w.TgZ(1,"nb-select",25),w.YNc(2,me,2,2,"nb-option",21),w.qZA(),w.TgZ(3,"span"),w._uU(4,"\u65e5"),w.qZA(),w.TgZ(5,"nb-select",20),w.YNc(6,fe,2,2,"nb-option",21),w.qZA(),w.TgZ(7,"span"),w._uU(8,"\uff1a"),w.qZA(),w.TgZ(9,"nb-select",22),w.YNc(10,Se,2,2,"nb-option",21),w.qZA(),w.qZA()),2&e){const e=w.oxw();let t,i,n;w.xp6(1),w.Q6J("status",null!=(t=e.validateForm.get("daily"))&&t.touched&&null!=(t=e.validateForm.get("daily"))&&t.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.monthDailyList),w.xp6(3),w.Q6J("status",null!=(i=e.validateForm.get("hour"))&&i.touched&&null!=(i=e.validateForm.get("hour"))&&i.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.hourList),w.xp6(3),w.Q6J("status",null!=(n=e.validateForm.get("minute"))&&n.touched&&null!=(n=e.validateForm.get("minute"))&&n.invalid?"danger":"basic"),w.xp6(1),w.Q6J("ngForOf",e.minuteList)}}const Ie=function(e){return{error:e}},Te=function(e){return{options:e,key:"key",val:"val"}};let be=(()=>{class e extends Z.H{constructor(e,t,i,n,o,a,s,l,d,r){super(e,t,i),this.router=n,this.activatedRoute=o,this.dialogService=a,this.scheduleManageService=s,this.customerManageService=l,this.loadingService=d,this.changeDetectorRef=r,this.Status=p.qb,this.Frequency=p.Di,this.weekDailyList=Array.from({length:7},(e,t)=>({key:(t+1).toString().padStart(2,"0"),val:p.Qo[t]})),this.chineseEndMonth="\u6708\u5e95",this.monthDailyList=Array.from({length:31},(e,t)=>({key:(t+1).toString().padStart(2,"0"),val:(t+1).toString().padStart(2,"0")})).concat({key:"999",val:this.chineseEndMonth}),this.hourList=Array.from({length:24},(e,t)=>({key:t.toString().padStart(2,"0"),val:t.toString().padStart(2,"0")})),this.minuteList=Array.from({length:60},(e,t)=>({key:t.toString().padStart(2,"0"),val:t.toString().padStart(2,"0")})),this.scheduleFrequencyList=[p.Di.daily,p.Di.weekly,p.Di.monthly],this.frequencyList=Object.entries(p.Di).filter(([e,t])=>this.scheduleFrequencyList.includes(t)).map(([e,t])=>({key:e,val:t})),this.activityList=new Array,this.filterActivityList=new Array,this.activityListTemp=new Array,this.scheduleActivitySettingGrid=new Array,this.ActivitySettingArray=new Array,this.gridDefine={pager:{display:!0,perPage:10},columns:{activityName:{title:"\u6d3b\u52d5\u540d\u7a31",type:"string",sort:!1},activityDescription:{title:"\u6d3b\u52d5\u8aaa\u660e",type:"html",valuePrepareFunction:e=>`<p>${null!=e?e:""}</p>`,sort:!1},status:{title:"\u72c0\u614b",type:"html",class:"text_center w100",valuePrepareFunction:(e,t)=>`<p class="text_center">${p.qb[t.reviewStatus]||p.qb[e]||""}</p>`,sort:!1},batchUpdateTime:{title:"\u6279\u6b21\u66f4\u65b0\u6642\u9593",type:"html",class:"text_center",valuePrepareFunction:e=>e?'<p class="text_center">'+new g.uU("en-US").transform(e,"yyyy-MM-dd HH:mm:ss")+"</p>":"",sort:!1},filterOptions:{title:"\u66f4\u65b0\u7d50\u679c",type:"html",class:"text_center",valuePrepareFunction:e=>{const t=null==e?void 0:e.toLowerCase();return m.l.isBlank(t)?t:`<p class="text_center ${p.CZ[t]||""}">${p.nC[t]||""}</p>`},sort:!1},delete:{title:"\u79fb\u9664",type:"custom",class:"center",width:"3rem",renderComponent:S.P,onComponentInitFunction:e=>{e.settings={btnStatus:"danger",btnIcon:"trash-2-outline"},e.emitter.subscribe(e=>{this.onDeleteConfirm(e)})},sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.validateForm=new c.cw({jobName:new c.NI(null,[c.kI.required,ne.I.blank]),status:new c.NI(null,c.kI.required),executionFrequency:new c.NI(null,c.kI.required),hour:new c.NI(null,[c.kI.required,ne.I.blank]),minute:new c.NI(null,[c.kI.required,ne.I.blank]),filePath:new c.NI(null,[c.kI.required,ne.I.blank])})}changeFrequencyType(e,t){switch(this.removeFieldIfExists("daily"),this.removeFieldIfExists("hour"),this.removeFieldIfExists("minute"),e){case"daily":this.addFieldIfNotExists("hour",null==t?void 0:t[0],[c.kI.required,ne.I.blank]),this.addFieldIfNotExists("minute",null==t?void 0:t[1],[c.kI.required,ne.I.blank]);break;case"weekly":case"monthly":this.addFieldIfNotExists("daily",null==t?void 0:t[0],[c.kI.required,ne.I.blank]),this.addFieldIfNotExists("hour",null==t?void 0:t[1],[c.kI.required,ne.I.blank]),this.addFieldIfNotExists("minute",null==t?void 0:t[2],[c.kI.required,ne.I.blank])}}addFieldIfNotExists(e,t,i){this.validateForm.contains(e)||this.validateForm.addControl(e,new c.NI(t,i))}removeFieldIfExists(e){this.validateForm.contains(e)&&this.validateForm.removeControl(e)}onDeleteConfirm(e){const t=this.scheduleActivitySettingGrid.findIndex(t=>t.activityId===e.activityId);if(-1!==t){const i=this.scheduleActivitySettingGrid.find(t=>t.activityId===e.activityId);this.activityListTemp.push({key:i.activityId,val:i.activityName}),this.scheduleActivitySettingGrid.splice(t,1),this.dataSource.load(this.scheduleActivitySettingGrid)}}add(){this.loadingService.open();const e=["pages","schedule-manage","schedule-activity-set",...this.scheduleId?["edit",this.scheduleId]:[]];this.customerManageService.getActivitySettingListOption().pipe((0,b.K)(t=>(this.handleErrorResponse(t,`\u67e5\u8a62\u540d\u55ae\u5217\u8868${this.actionName}\u5931\u6557`,e),(0,T.of)(null))),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(e=>{const t=JSON.parse(JSON.stringify(e.result)),i=[...this.ActivitySettingArray,...t];this.activityList=t.map(e=>({key:e.activityId,val:e.activityName})),this.refreshFilterActivityList(),this.filterActivityList.length<=0?this.dialogService.alertAndBackToList(!1,"\u65b0\u589e\u540d\u55ae\u5217\u8868\u70ba\u7a7a",this.getBackRoute()):this.openPreviewDialog(i)}),(0,q.x)(()=>this.loadingService.close())).subscribe()}handleErrorResponse(e,t,i){throw this.dialogService.alertAndBackToList(!1,t,i),new Error(e.message)}openPreviewDialog(e){this.dialogService.open(ae,{title:"\u8a2d\u5b9a\u540d\u55ae\u5167\u5bb9",dataList:this.filterActivityList}).onClose.subscribe(t=>{if(t){this.activityListTemp=this.activityListTemp.filter(e=>e.key!==t.key);const i=e.find(e=>{var i,n;return(null===(i=e.activityId)||void 0===i?void 0:i.toLowerCase())===(null===(n=t.key)||void 0===n?void 0:n.toLowerCase())});if(!i){const e=["pages","schedule-manage","schedule-activity-set",...this.scheduleId?["edit",this.scheduleId]:[]];return void this.handleErrorResponse(null,`\u67e5\u8a62\u540d\u55ae\u5217\u8868${this.actionName}\u5931\u6557`,e)}this.scheduleActivitySettingGrid.push(new h(i)),this.dataSource.load(this.scheduleActivitySettingGrid)}})}getBackRoute(){return["pages","schedule-manage","schedule-activity-set",...this.scheduleId?["edit",this.scheduleId]:[]]}refreshFilterActivityList(){this.activityListTemp&&this.activityListTemp.length>0&&(this.filterActivityList=[...this.activityListTemp,...this.activityList]),this.filterActivityList=this.activityList.filter(e=>!this.scheduleActivitySettingGrid.some(t=>t.activityId===e.key)&&m.l.isNotBlank(e.key)&&m.l.isNotBlank(e.val))}ngOnInit(){var e,t;if(this.params=this.activatedRoute.snapshot.params,this.changeRouteName=null!==(e=this.params.changeRoute)&&void 0!==e?e:"",this.actionName=m.l.getActionName(this.changeRouteName),this.scheduleId=null===(t=this.params)||void 0===t?void 0:t.scheduleId,this.dataSource=new l.nC,this.scheduleId){if(this.isMock){let e=y.P.find(e=>e.scheduleId===this.scheduleId);return this.setData(e),void this.loadingService.close()}return this.loadingService.open(),void this.scheduleManageService.getScheduleActivitySettingDetail(this.scheduleId).pipe((0,b.K)(e=>{throw this.dialogService.alertAndBackToList(!1,"\u67e5\u7121\u6b64\u7b46\u8cc7\u6599\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u540d\u55ae\u6392\u7a0b",["pages","schedule-manage","schedule-activity-list"]),new Error(e.message)}),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(e=>{const t=JSON.parse(JSON.stringify(e.result));this.setData(t),this.loadingService.close()})).subscribe()}this.validateForm.get("executionFrequency").setValue("daily")}ngAfterViewChecked(){this.changeDetectorRef.detectChanges()}cancel(){var e;"edit"!==(null!==(e=this.params.changeRoute)&&void 0!==e?e:"")?this.router.navigate(["pages","schedule-manage","schedule-activity-list"]):this.router.navigate(["pages","schedule-manage","schedule-activity-detail",this.params.scheduleId])}submit(){const e=this.validateForm.valid,t=this.getRequestData();if(e&&t){if(this.isMock)return this.dialogService.alertAndBackToList(!0,`${this.actionName}\u540d\u55ae\u6392\u7a0b\u9001\u5be9\u6210\u529f`,["pages","schedule-manage","schedule-activity-list"]),void this.loadingService.close();this.saveScheduleActivity(t)}else this.dialogService.alertAndBackToList(!1,`${this.actionName}\u9a57\u8b49\u5931\u6557`,["pages","schedule-manage","schedule-activity-set",...this.scheduleId?[this.changeRouteName,this.scheduleId]:[]])}saveScheduleActivity(e){this.loadingService.open(),(this.scheduleId&&"edit"===this.changeRouteName?this.scheduleManageService.updateScheduleActivitySetting(this.scheduleId,e):this.scheduleManageService.createScheduleActivitySetting(e)).pipe((0,b.K)(e=>{throw this.dialogService.alertAndBackToList(!1,`${this.actionName}\u5931\u6557 ${e.message}`,["pages","schedule-manage","schedule-activity-set",...this.scheduleId?[this.changeRouteName,this.scheduleId]:[]]),new Error(e.message)}),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(e=>{this.dialogService.alertAndBackToList(!0,`${this.actionName}\u540d\u55ae\u6392\u7a0b\u9001\u5be9\u6210\u529f`,["pages","schedule-manage","schedule-activity-list"])}),(0,q.x)(()=>this.loadingService.close())).subscribe()}getRequestData(){var e,t,i;let n=this.validateForm.getRawValue(),c=null===(e=this.validateForm.get("daily"))||void 0===e?void 0:e.value,o=null===(t=this.validateForm.get("hour"))||void 0===t?void 0:t.value,a=null===(i=this.validateForm.get("minute"))||void 0===i?void 0:i.value,s=this.validateForm.get("executionFrequency").value;return n.frequencyTime="daily"===s?o+":"+a:c+":"+o+":"+a,n.activityIds=this.scheduleActivitySettingGrid.map(e=>e.activityId),console.info("reqData",n),n}setData(e){var t;const i=(null==e?void 0:e.frequencyTime).split(/[:\uff1a]/);if(i.length>0&&e.executionFrequency){let n=null===(t=e.executionFrequency)||void 0===t?void 0:t.toLowerCase();this.changeFrequencyType(n,i)}Object.keys(e).forEach(t=>{this.validateForm.controls[t]?this.validateForm.controls[t].setValue(e[t]):"activitySetting"===t&&(this.scheduleActivitySettingGrid=e[t],this.scheduleActivitySettingGrid=Array.from(new Set(this.scheduleActivitySettingGrid.map(e=>e.activityId))).map(e=>this.scheduleActivitySettingGrid.find(t=>t.activityId===e)),this.ActivitySettingArray=[...this.scheduleActivitySettingGrid]),this.dataSource.load(this.scheduleActivitySettingGrid)})}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(C.V),w.Y36(k.E),w.Y36(z.r),w.Y36(r.F0),w.Y36(r.gz),w.Y36(N.x),w.Y36(F),w.Y36(E.Q),w.Y36(_.b),w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-activity-set"]],features:[w.qOj],decls:38,vars:21,consts:[[1,"pageTitle"],[1,"pageContent"],[3,"formGroup"],[1,"row"],["title","\u6392\u7a0b\u540d\u7a31","ctlName","jobName",1,"col-12","col-lg-6",3,"form"],["title","\u72c0\u614b","ctlName","status",1,"col-12","col-lg-6",3,"form"],[1,"fieldGroup","essential","col-12","col-lg-6",3,"ngClass"],["title","\u6392\u7a0b\u983b\u7387","ctlName","executionFrequency",3,"form","selectList","errorTextBoolen","valueChange"],["class","multi",4,"ngIf"],[1,"note","errorText"],["icon","alert-triangle"],["title","\u6a94\u6848\u5b58\u653e\u5730\u65b9","ctlName","filePath",1,"col-12","col-lg-6",3,"form"],[1,"rightBox"],["nbButton","","status","primary","size","medium",3,"click"],[3,"settings","source"],[3,"source","paginator"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"disabled","click"],[1,"multi"],["fullWidth","","placeholder","\u6642","formControlName","hour",3,"status"],[3,"value",4,"ngFor","ngForOf"],["fullWidth","","placeholder","\u5206","formControlName","minute",3,"status"],[3,"value"],["fullWidth","","placeholder","\u661f\u671f","formControlName","daily",3,"status"],["fullWidth","","placeholder","\u65e5","formControlName","daily",3,"status"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"h1"),w._uU(2,"\u6392\u7a0b\u7ba1\u7406"),w.qZA(),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"nb-card"),w.TgZ(5,"nb-card-header"),w.TgZ(6,"h2"),w._uU(7),w.qZA(),w.qZA(),w.TgZ(8,"nb-card-body",2),w.TgZ(9,"div",3),w._UZ(10,"basic-input",4),w._UZ(11,"dropdown",5),w.TgZ(12,"div",6),w.TgZ(13,"radio",7),w.NdJ("valueChange",function(e){return t.changeFrequencyType(e)}),w.qZA(),w.YNc(14,ge,7,4,"div",8),w.YNc(15,ye,9,6,"div",8),w.YNc(16,Ze,11,6,"div",8),w.TgZ(17,"div",9),w._UZ(18,"nb-icon",10),w.TgZ(19,"p"),w._uU(20,"\u6b64\u70ba\u5fc5\u586b\u6b04\u4f4d"),w.qZA(),w.qZA(),w.qZA(),w._UZ(21,"basic-input",11),w.qZA(),w.qZA(),w.qZA(),w.TgZ(22,"nb-card"),w.TgZ(23,"nb-card-header"),w.TgZ(24,"h2"),w._uU(25,"\u540d\u55ae\u5217\u8868"),w.qZA(),w.qZA(),w.TgZ(26,"nb-card-body"),w.TgZ(27,"div",12),w.TgZ(28,"button",13),w.NdJ("click",function(){return t.add()}),w._uU(29,"\u65b0 \u589e"),w.qZA(),w.qZA(),w._UZ(30,"ng2-smart-table",14),w._UZ(31,"paginator",15),w.qZA(),w.qZA(),w.TgZ(32,"div",3),w.TgZ(33,"div",16),w.TgZ(34,"button",17),w.NdJ("click",function(){return t.cancel()}),w._uU(35,"\u53d6 \u6d88"),w.qZA(),w.TgZ(36,"button",18),w.NdJ("click",function(){return t.submit()}),w._uU(37,"\u9001 \u5be9"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e){let e;w.xp6(7),w.hij("",t.actionName,"\u6392\u7a0b"),w.xp6(1),w.Q6J("formGroup",t.validateForm),w.xp6(2),w.Q6J("form",t.validateForm),w.xp6(1),w.Q6J("form",t.validateForm),w.xp6(1),w.Q6J("ngClass",w.VKq(17,Ie,(null==(e=t.validateForm.get("daily"))?null:e.touched)&&(null==(e=t.validateForm.get("daily"))?null:e.invalid)||(null==(e=t.validateForm.get("minute"))?null:e.touched)&&(null==(e=t.validateForm.get("minute"))?null:e.invalid)||(null==(e=t.validateForm.get("hour"))?null:e.touched)&&(null==(e=t.validateForm.get("hour"))?null:e.invalid))),w.xp6(1),w.Q6J("form",t.validateForm)("selectList",w.VKq(19,Te,t.frequencyList))("errorTextBoolen",!1),w.xp6(1),w.Q6J("ngIf","daily"===(null==t.validateForm.get("executionFrequency").value?null:t.validateForm.get("executionFrequency").value.toLowerCase())),w.xp6(1),w.Q6J("ngIf","weekly"===(null==t.validateForm.get("executionFrequency").value?null:t.validateForm.get("executionFrequency").value.toLowerCase())),w.xp6(1),w.Q6J("ngIf","monthly"===(null==t.validateForm.get("executionFrequency").value?null:t.validateForm.get("executionFrequency").value.toLowerCase())),w.xp6(5),w.Q6J("form",t.validateForm),w.xp6(9),w.Q6J("settings",t.gridDefine)("source",t.dataSource),w.xp6(1),w.Q6J("source",t.dataSource)("paginator",t.paginator),w.xp6(5),w.Q6J("disabled",t.validateForm.invalid)}},directives:[s.Asz,s.ndF,s.yKW,c.JL,c.sg,se.n,le.J,g.mk,de.U,g.O5,s.fMN,s.DPz,l.T5,U.J,s.rs,c.JJ,c.u,g.sg,s.q51],styles:[""]}),e})(),Ae=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-manage"]],decls:1,vars:0,template:function(e,t){1&e&&w._UZ(0,"router-outlet")},directives:[r.lC],encapsulation:2}),e})();class xe{constructor(e){Object.assign(this,e)}}const qe=[{tagId:"reference-id-1",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"reference-id-1",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"reference-id-1",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"reference-id-1",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"reference-id-1",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"reference-id-1",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100},{historyId:"xxxx-5",referenceId:"reference-id-1",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"reference-id-2",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"reference-id-2",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"reference-id-2",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"reference-id-2",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"reference-id-2",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"reference-id-2",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc123456",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234567",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"\u985e\u578b",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"reviewing",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"\u689d\u4ef6\u8a2d\u5b9a\u65b9\u5f0f",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Fail",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"Success",batchResultCount:100}]},{tagId:"cccccc1234568",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234569",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234561",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234562",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234563",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234564",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc1234565",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"\u985e\u578b",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"disabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"\u689d\u4ef6\u8a2d\u5b9a\u65b9\u5f0f",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Fail",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"Success",batchResultCount:100}]},{tagId:"cccccc1234566",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"\u985e\u578b",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"active",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"\u689d\u4ef6\u8a2d\u5b9a\u65b9\u5f0f",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-cccc",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-cccc",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-cccc",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"Success",batchResultCount:100}]},{tagId:"cccccc123456555",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc123456666",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc123456777",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc12345699",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"normal",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Success",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"fail",batchResultCount:100}]},{tagId:"cccccc12345688",version:"uuid-cccc",tagName:"\u6a19\u7c64\u540d\u7a31",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"\u985e\u578b",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",status:"disabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"\u689d\u4ef6\u8a2d\u5b9a\u65b9\u5f0f",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",tagConditionSetting:[{tagId:"cccccc123456",conditionId:"condition-key-1",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c1",thresholdValue:"\u9580\u6abb\u503c1"},{tagId:"cccccc123456",conditionId:"condition-key-2",version:"uuid-zzzz",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c2",thresholdValue:"\u9580\u6abb\u503c2"},{tagId:"cccccc123456",conditionId:"condition-key-3",version:"uuid-zzzz",groupId:2,detectionCondition:"$eq",joinValue:"and",conditionKey:"\u689d\u4ef6\u503c3",thresholdValue:"\u9580\u6abb\u503c3"}],categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"\u6392\u6210\u8a2d\u5b9a",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",fileName:"\u4e0a\u50b3\u6a94\u6848\u540d\u7a31",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",fileData:"\u4e0a\u50b3\u6a94\u6848\u8cc7\u6599",scheduleBatchHistory:[{historyId:"xxxx-3",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-19 23:59:59",batchResult:"Fail",batchResultCount:100},{historyId:"xxxx-4",referenceId:"cccccc123456",version:"uuid-cccc",batchTime:"2023-07-18 23:59:59",batchResult:"Success",batchResultCount:100}]}];var we=i(11004);function Ce(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",8),w.TgZ(1,"button",9),w.NdJ("click",function(){return w.CHM(e),w.oxw().setGridDefineInit()}),w._uU(2,"\u624b\u52d5\u66f4\u65b0"),w.qZA(),w.qZA()}}function ke(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",8),w.TgZ(1,"button",10),w.NdJ("click",function(){return w.CHM(e),w.oxw().setGridDefineInit()}),w._uU(2,"\u53d6 \u6d88"),w.qZA(),w.TgZ(3,"button",9),w.NdJ("click",function(){return w.CHM(e),w.oxw().submitRefresh()}),w._uU(4,"\u78ba \u5b9a"),w.qZA(),w.qZA()}}function ze(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",11),w.TgZ(1,"nb-checkbox",12),w.NdJ("change",function(){return w.CHM(e),w.oxw().onSelectAllChange(!0)}),w.qZA(),w.qZA()}if(2&e){const e=w.oxw();w.xp6(1),w.Q6J("checked",e.isAllSelected)}}let De=(()=>{class e extends Z.H{constructor(e,t,i,n,c,o,a,s,l,d){super(e,t,i),this.scheduleManageService=n,this.tagManageService=c,this.activatedRoute=o,this.tableService=a,this.dialogService=s,this.loadingService=l,this.router=d,this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.isAllSelected=!1,this.selectedRows=new Array,this.tempPageIsAllSelected=new Array,this.scheduleTagListSetting=qe,this.scheduleTagSettingView=new Array,this.gridDefine={pager:{display:!0,perPage:10},actions:!1,hideSubHeader:!0,columns:{tagName:{title:"\u6a19\u7c64\u540d\u7a31",type:"string",sort:!1},tagDescription:{title:"\u6a19\u7c64\u8aaa\u660e",type:"string",sort:!1},status:{title:"\u72c0\u614b",type:"html",class:"text_center w150",valuePrepareFunction:e=>e?'<p class="text_center">'+(p.qb[e]||"")+"</p>":"",sort:!1},batchTime:{title:"\u6279\u6b21\u66f4\u65b0\u6642\u9593",type:"html",class:"text_center w200",valuePrepareFunction:e=>e?'<p class="text_center">'+new g.uU("en-US").transform(e,"yyyy-MM-dd HH:mm:ss")+"</p>":"",sort:!1},batchResult:{title:"\u66f4\u65b0\u7d50\u679c",type:"html",width:"3rem",valuePrepareFunction:e=>{const t=null==e?void 0:e.toLowerCase();return m.l.isBlank(t)?t:`<p class="text_center ${p.CZ[t]||""}">`+(p.nC[t]||"")+"</p>"},sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",renderComponent:S.P,onComponentInitFunction:e=>{e.emitter.subscribe(e=>{this.router.navigate(["pages","schedule-manage","schedule-tag-export-detail",e.tagId],{state:e})})},sort:!1}},noDataMessage:"\u67e5\u7121\u8cc7\u6599"}}ngOnInit(){if(this.isMock)return this.scheduleTagListSetting.map(e=>{const t=e.scheduleBatchHistory.reduce((e,t)=>new Date(e.batchTime)<new Date(t.batchTime)?t:e);this.scheduleTagSettingView.push(new xe({tagId:e.tagId,version:e.version,tagName:e.tagName,tagDescription:e.tagDescription,tagType:e.tagType,department:e.department,owner:e.owner,createTime:e.createTime,modificationTime:e.modificationTime,status:e.status,startDate:e.startDate,endDate:e.endDate,conditionSettingMethod:e.conditionSettingMethod,conditionSettingQuery:e.conditionSettingQuery,categoryKey:e.categoryKey,tagTopicKey:e.tagTopicKey,scheduleSettings:e.scheduleSettings,uploadType:e.uploadType,filePath:e.filePath,historyId:null==t?void 0:t.historyId,batchTime:null==t?void 0:t.batchTime,batchResult:null==t?void 0:t.batchResult,batchResultCount:null==t?void 0:t.batchResultCount}))}),void this.dataSource.load(this.scheduleTagSettingView);this.dataSource=new l.nC,this.tableService.searchData({apiUrl:this.tagManageService.tagFunc+"schedule-batch",nowPage:this.paginator.nowPage,errMsg:"\u8cbc\u6a19\u6392\u7a0b\u5217\u8868\u67e5\u7121\u8cc7\u6599"}).getElements().then(e=>{this.dataSource.load(e),this.getSessionSetPage()})}ngAfterViewInit(){this.getSessionSetPage()}ngOnDestroy(){var e,t;this.setSessionVal({page:this.paginator.nowPage,isOpenCheckbox:!!(null===(t=null===(e=null==this?void 0:this.gridDefine)||void 0===e?void 0:e.columns)||void 0===t?void 0:t.isChecked),isPageAllSelected:this.tempPageIsAllSelected})}ngDoCheck(){var e,t,i;if(this.ng2SmartTable){const n=this.paginator.nowPage;if(this.previousPage!==n){this.previousPage=n;const c=this.storageService.getSessionVal(this.sessionKey);if((null==c?void 0:c.isOpenCheckbox)&&(null===(e=null==c?void 0:c.isPageAllSelected)||void 0===e?void 0:e.find(e=>(null==e?void 0:e.pageNum)===n)))return void(this.isAllSelected=null===(i=null===(t=null==c?void 0:c.isPageAllSelected)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.pageNum)===n))||void 0===i?void 0:i.val);this.isAllSelected=!1}}}setGridDefineInit(){var e,t,i,n;this.selectedRows=new Array,this.isAllSelected=!1,this.tempPageIsAllSelected=new Array,(null===(t=null===(e=null==this?void 0:this.gridDefine)||void 0===e?void 0:e.columns)||void 0===t?void 0:t.isChecked)?(delete this.gridDefine.columns.isChecked,this.gridDefine.columns=Object.assign(this.gridDefine.columns,{action:{title:"\u67e5\u770b",type:"custom",width:"5%",renderComponent:S.P,onComponentInitFunction:e=>{e.emitter.subscribe(e=>{this.router.navigate(["pages","schedule-manage","schedule-tag-export-detail",e.tagId],{state:e})})},sort:!1}})):(delete this.gridDefine.columns.action,this.gridDefine.columns=Object.assign({isChecked:{title:"",type:"custom",width:"5%",sort:!1,filter:!1,filterFunction:!1,visible:!0,renderComponent:f.H,onComponentInitFunction:e=>{e.settings={isShowParam:{key:"status",answer:["enabled","reviewing"]},rowIdName:"tagId",selectedRows:this.selectedRows},e.emitter.subscribe(e=>{var t;this.dataSource.getElements().then(e=>{var t,i;const n=e.filter(e=>e.isShow).length,c=e.filter(e=>e.isShow&&e.isSelected).length;this.isAllSelected=!1,c===n&&(this.isAllSelected=!0),this.tempPageIsAllSelected=m.l.onSetTempPageIsAllSelected(this.tempPageIsAllSelected,this.paginator.nowPage,this.isAllSelected),this.setSessionVal({page:this.paginator.nowPage,isOpenCheckbox:!!(null===(i=null===(t=null==this?void 0:this.gridDefine)||void 0===t?void 0:t.columns)||void 0===i?void 0:i.isChecked),isPageAllSelected:this.tempPageIsAllSelected})}),e.isSelected&&e.tagId?this.selectedRows.push({rowId:e.tagId}):(null!==(t=this.selectedRows.length)&&void 0!==t?t:0)>0&&this.selectedRows.find(t=>t.rowId===e.tagId)&&(this.selectedRows=this.selectedRows.filter(t=>t.rowId!==e.tagId))})}}},this.gridDefine.columns)),this.setSessionVal({page:this.paginator.nowPage,isOpenCheckbox:!!(null===(n=null===(i=null==this?void 0:this.gridDefine)||void 0===i?void 0:i.columns)||void 0===n?void 0:n.isChecked),isPageAllSelected:this.tempPageIsAllSelected}),this.ng2SmartTable.initGrid(),this.getSessionSetPage()}onSelectAllChange(e){var t=this;return(0,u.Z)(function*(){var i,n;const c=t.storageService.getSessionVal(t.sessionKey),o=((null==c?void 0:c.isPageAllSelected)||[]).find(e=>(null==e?void 0:e.pageNum)===t.paginator.nowPage);t.isAllSelected=!e&&(null==c?void 0:c.isOpenCheckbox)&&o?o.val:!t.isAllSelected,t.tempPageIsAllSelected=m.l.onSetTempPageIsAllSelected(t.tempPageIsAllSelected,t.paginator.nowPage,t.isAllSelected),t.setSessionVal({page:t.paginator.nowPage,isOpenCheckbox:!!(null===(n=null===(i=null==t?void 0:t.gridDefine)||void 0===i?void 0:i.columns)||void 0===n?void 0:n.isChecked),isPageAllSelected:t.tempPageIsAllSelected}),t.selectedRows=yield m.l.onSetGridPageChecked("tagId",t.dataSource,t.selectedRows,t.isAllSelected),t.ng2SmartTable.initGrid(),t.getSessionSetPage()})()}submitRefresh(){if(this.selectedRows.length>0){const e=this.selectedRows.map(e=>e.rowId);this.loadingService.open(),this.scheduleManageService.retrigger("tag",e.toString()).pipe((0,b.K)(e=>{throw this.dialogService.alertAndBackToList(!1,`\u624b\u52d5\u66f4\u65b0\u5931\u6557: ${e.message}`),new Error(e.message)}),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(()=>{this.setGridDefineInit(),this.loadingService.close()})).subscribe()}else this.dialogService.showToast("warning","\u8acb\u81f3\u5c11\u9078\u64c7\u4e00\u7b46")}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(C.V),w.Y36(k.E),w.Y36(z.r),w.Y36(F),w.Y36(we.P),w.Y36(r.gz),w.Y36(X.I),w.Y36(N.x),w.Y36(_.b),w.Y36(r.F0))},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-tag-list"]],viewQuery:function(e,t){if(1&e&&w.Gf(l.T5,5),2&e){let e;w.iGM(e=w.CRH())&&(t.ng2SmartTable=e.first)}},features:[w.qOj],decls:17,vars:7,consts:[[1,"pageTitle"],[1,"pageContent"],["class","rightBox",4,"ngIf"],[1,"tableContainer"],["class","selectAll",4,"ngIf"],[3,"settings","source"],["ng2SmartTable",""],[3,"source","paginator"],[1,"rightBox"],["nbButton","","status","primary","size","medium",3,"click"],["nbButton","","status","basic","size","medium",3,"click"],[1,"selectAll"],["status","info",3,"checked","change"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"h1"),w._uU(2,"\u6392\u7a0b\u7ba1\u7406"),w.qZA(),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"nb-card"),w.TgZ(5,"nb-card-header"),w.TgZ(6,"h2"),w._uU(7,"\u8cbc\u6a19\u7d00\u9304"),w.qZA(),w.qZA(),w.TgZ(8,"nb-card-body"),w.TgZ(9,"div"),w.YNc(10,Ce,3,0,"div",2),w.YNc(11,ke,5,0,"div",2),w.TgZ(12,"div",3),w.YNc(13,ze,2,1,"div",4),w._UZ(14,"ng2-smart-table",5,6),w._UZ(16,"paginator",7),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(10),w.Q6J("ngIf",!(null!=t&&null!=t.gridDefine&&null!=t.gridDefine.columns&&t.gridDefine.columns.isChecked)&&t.isCrud.update),w.xp6(1),w.Q6J("ngIf",(null==t||null==t.gridDefine||null==t.gridDefine.columns?null:t.gridDefine.columns.isChecked)&&t.isCrud.update),w.xp6(2),w.Q6J("ngIf",null==t||null==t.gridDefine||null==t.gridDefine.columns?null:t.gridDefine.columns.isChecked),w.xp6(1),w.Q6J("settings",t.gridDefine)("source",t.dataSource),w.xp6(2),w.Q6J("source",t.dataSource)("paginator",t.paginator))},directives:[s.Asz,s.ndF,s.yKW,g.O5,l.T5,U.J,s.DPz,s.NTf],styles:[""]}),e})();var Fe=i(76621),Ne=i(7896);function _e(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",3),w.TgZ(1,"p",4),w._uU(2,"\u540d\u55ae\u4e0a\u50b3\uff1a"),w.qZA(),w.TgZ(3,"a",12),w.NdJ("click",function(){return w.CHM(e),w.oxw().onDownloadFile()}),w._uU(4),w.qZA(),w.qZA()}if(2&e){const e=w.oxw();w.xp6(4),w.Oqu(null==e.detail?null:e.detail.fileName)}}function Ue(e,t){1&e&&(w.TgZ(0,"div",16),w.TgZ(1,"p"),w._uU(2,"\u689d\u4ef6\u8a2d\u5b9a"),w.qZA(),w.qZA())}function Pe(e,t){if(1&e&&(w.TgZ(0,"div",17),w.TgZ(1,"p",4),w._uU(2,"\u689d\u4ef6\u8a2d\u5b9a\uff1a"),w.qZA(),w.TgZ(3,"pre"),w._uU(4),w.qZA(),w.qZA()),2&e){const e=w.oxw(2);w.xp6(4),w.Oqu(null==e.detail?null:e.detail.conditionSettingQuery)}}function Re(e,t){if(1&e&&(w.TgZ(0,"div",17),w.TgZ(1,"p",4),w._uU(2,"\u5075\u6e2c\u689d\u4ef6\uff1a"),w.qZA(),w.TgZ(3,"span"),w._uU(4),w.qZA(),w.qZA()),2&e){const e=w.oxw(2);w.xp6(4),w.Oqu((null==e.detail||null==e.detail.tagConditionSetting||null==e.detail.tagConditionSetting[0]?null:e.detail.tagConditionSetting[0].conditionName)||(null==e.detail||null==e.detail.tagConditionSetting||null==e.detail.tagConditionSetting[0]?null:e.detail.tagConditionSetting[0].conditionKey))}}function Ve(e,t){1&e&&w._UZ(0,"nb-tag",23)}function Oe(e,t){1&e&&w._UZ(0,"nb-tag",24)}function Je(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"div",20),w.TgZ(2,"p"),w._uU(3),w.ALo(4,"enum"),w.qZA(),w.TgZ(5,"span"),w._uU(6),w.qZA(),w.YNc(7,Ve,1,0,"nb-tag",21),w.YNc(8,Oe,1,0,"nb-tag",22),w.qZA(),w.BQk()),2&e){const e=t.$implicit;w.xp6(3),w.Oqu(w.xi3(4,4,null==e||null==e.detectionCondition?null:e.detectionCondition.toLowerCase(),"mathSymbol")),w.xp6(3),w.Oqu(null==e?null:e.thresholdValue),w.xp6(1),w.Q6J("ngIf","and"===(null==e||null==e.joinValue?null:e.joinValue.toLowerCase())),w.xp6(1),w.Q6J("ngIf","or"===(null==e||null==e.joinValue?null:e.joinValue.toLowerCase()))}}function Ke(e,t){if(1&e&&(w.TgZ(0,"div",18),w.TgZ(1,"div",2),w.YNc(2,Je,9,7,"ng-container",19),w.qZA(),w.qZA()),2&e){const e=w.oxw(2);w.xp6(2),w.Q6J("ngForOf",null==e.detail?null:e.detail.tagConditionSetting)}}function Le(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,Ue,3,0,"div",13),w.TgZ(2,"div",2),w.YNc(3,Pe,5,1,"div",14),w.YNc(4,Re,5,1,"div",14),w.YNc(5,Ke,3,1,"div",15),w.qZA(),w.qZA()),2&e){const e=w.oxw();w.xp6(1),w.Q6J("ngIf","field"===(null==e.detail?null:e.detail.conditionSettingMethod)),w.xp6(2),w.Q6J("ngIf","normal"===(null==e.detail?null:e.detail.conditionSettingMethod)),w.xp6(1),w.Q6J("ngIf","field"===(null==e.detail?null:e.detail.conditionSettingMethod)),w.xp6(1),w.Q6J("ngIf","field"===(null==e.detail?null:e.detail.conditionSettingMethod))}}const Qe=[{path:"",component:Ae,children:[{path:"",redirectTo:"schedule-activity-list",pathMatch:"full"},{path:"schedule-activity-list",component:ie,data:{keepSession:!0,keepFrom:["schedule-activity-detail/"]}},{path:"schedule-activity-detail/:scheduleId",component:B,data:{keepSession:!0,keepFrom:["schedule-activity-export-detail/"]}},{path:"schedule-activity-set",component:be},{path:"schedule-activity-set/:changeRoute/:scheduleId",component:be},{path:"schedule-activity-export-detail/:scheduleId/:referenceId",component:G,data:{keepSession:!0}},{path:"schedule-tag-list",component:De,data:{keepSession:!0,keepFrom:["schedule-tag-export-detail/"]}},{path:"schedule-tag-export-detail/:tagId",component:(()=>{class e extends Z.H{constructor(e,t,i,n,c,o,a,s,l,d){super(e,t,i),this.router=n,this.activatedRoute=c,this.loadingService=o,this.fileService=a,this.dialogService=s,this.tagManageService=l,this.scheduleManageService=d,this.gridDefine={pager:{display:!0,perPage:10},tableId:"true",columns:{historyId:{title:"\u9805\u6b21",type:"html",class:"text_center",valuePrepareFunction:e=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},batchTime:{title:"\u6279\u6b21\u6642\u9593",type:"html",class:"w300",valuePrepareFunction:e=>e?`<p>${new g.uU("en-US").transform(e,"yyyy-MM-dd HH:mm:ss")}</p>`:"",sort:!1},batchResult:{title:"\u6392\u7a0b\u7d50\u679c",type:"html",class:"text_center",valuePrepareFunction:e=>{const t=null==e?void 0:e.toLowerCase();return m.l.isBlank(t)?t:`<p class="text_center ${p.CZ[t]||""}">\u6279\u6b21\u6392\u7a0b${p.nC[t]||""}</p>`},sort:!1},batchResultCount:{title:"\u8cbc\u6a19\u7b46\u6578",type:"html",class:"text_center",valuePrepareFunction:e=>`<p class="text_center">${null!=e?e:0}</p>`,sort:!1},action:{title:"\u532f\u51fa",type:"custom",class:"center",width:"3rem",renderComponent:S.P,onComponentInitFunction:e=>{var t,i,n,c,o;e.settings={btnStatus:"success",btnIcon:"cloud-download-outline",disabled:(null===(n=null===(i=null===(t=this.loginService.userProfileSubject)||void 0===t?void 0:t.value)||void 0===i?void 0:i.businessUnit)||void 0===n?void 0:n.toLowerCase())!==(null===(o=null===(c=this.detail)||void 0===c?void 0:c.department)||void 0===o?void 0:o.toLowerCase())},e.getRow.subscribe(t=>{e.isShow="success"===t.batchResult.toLowerCase()}),e.emitter.subscribe(e=>{this.scheduleManageService.batchDownload(e.historyId,j.s.ScheduleTag,this.detail.tagName)})},sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.params=this.activatedRoute.snapshot.params}onDownloadFile(){var e,t,i;m.l.isBlank(null===(e=this.detail)||void 0===e?void 0:e.fileData)?this.dialogService.alertAndBackToList(!1,"\u6a94\u6848\u4e0b\u8f09\u5931\u6557(\u7121\u8b58\u5225\u78bc)"):this.fileService.downloadFileService(j.s.ScheduleTag,new Fe.D({fileDataId:this.detail.fileData,fileName:null===(t=this.detail)||void 0===t?void 0:t.fileName,uploadType:null===(i=this.detail)||void 0===i?void 0:i.uploadType}))}ngOnInit(){if(this.loadingService.open(),this.isMock)return this.detail=qe[0],this.dataSource.load(this.detail.scheduleBatchHistory),void this.loadingService.close();let e=this.activatedRoute.snapshot.params.tagId;this.dataSource=new l.nC,this.tagManageService.getTagSettingRow(e).pipe((0,b.K)(e=>{throw this.dialogService.alertAndBackToList(!1,"\u67e5\u7121\u6b64\u7b46\u8cc7\u6599\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u8cbc\u6a19\u6392\u7a0b",["pages","schedule-manage","schedule-tag-list"]),new Error(e.message)}),(0,A.h)(e=>e.code===v.$.SUCCESS),(0,x.b)(e=>{this.detail=JSON.parse(JSON.stringify(e.result)),this.dataSource.load(this.detail.scheduleBatchHistory),this.dataSource.setSort([{field:"batchTime",direction:"desc"}])}),(0,q.x)(()=>this.loadingService.close())).subscribe()}ngOnDestroy(){this.storageService.putSessionVal(this.sessionKey,{page:this.paginator.nowPage})}cancel(){this.router.navigate(["pages","schedule-manage","schedule-tag-list"])}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(C.V),w.Y36(k.E),w.Y36(z.r),w.Y36(r.F0),w.Y36(r.gz),w.Y36(_.b),w.Y36(Ne.I),w.Y36(N.x),w.Y36(we.P),w.Y36(F))},e.\u0275cmp=w.Xpm({type:e,selectors:[["schedule-tag-export-detail"]],features:[w.qOj],decls:83,vars:32,consts:[[1,"pageTitle"],[1,"pageContent"],[1,"row"],[1,"textGroup","col-12","col-lg-4"],[1,"text_bold"],[1,"textGroup","col-12","col-lg-12"],["class","textGroup col-12 col-lg-4",4,"ngIf"],[4,"ngIf"],[3,"settings","source"],[3,"source","paginator"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],[1,"link-style",3,"click"],["class","subTitle",4,"ngIf"],["class","textGroup code col-12",4,"ngIf"],["class","colorArea col-12",4,"ngIf"],[1,"subTitle"],[1,"textGroup","code","col-12"],[1,"colorArea","col-12"],[4,"ngFor","ngForOf"],[1,"textGroup","gather"],["status","warning","appearance","filled","text","and",4,"ngIf"],["status","info","appearance","filled","text","or",4,"ngIf"],["status","warning","appearance","filled","text","and"],["status","info","appearance","filled","text","or"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"h1"),w._uU(2,"\u6392\u7a0b\u7d00\u9304"),w.qZA(),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"nb-card"),w.TgZ(5,"nb-card-body"),w.TgZ(6,"div",2),w.TgZ(7,"div",3),w.TgZ(8,"p",4),w._uU(9,"\u6a19\u7c64\u540d\u7a31\uff1a"),w.qZA(),w.TgZ(10,"span"),w._uU(11),w.qZA(),w.qZA(),w.TgZ(12,"div",3),w.TgZ(13,"p",4),w._uU(14,"\u72c0\u614b\uff1a"),w.qZA(),w.TgZ(15,"span"),w._uU(16),w.ALo(17,"enum"),w.qZA(),w.qZA(),w.TgZ(18,"div",3),w.TgZ(19,"p",4),w._uU(20,"\u985e\u578b\uff1a"),w.qZA(),w.TgZ(21,"span"),w._uU(22),w.ALo(23,"enum"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(24,"div",2),w.TgZ(25,"div",3),w.TgZ(26,"p",4),w._uU(27,"\u6240\u5c6c\u55ae\u4f4d\uff1a"),w.qZA(),w.TgZ(28,"span"),w._uU(29),w.qZA(),w.qZA(),w.TgZ(30,"div",3),w.TgZ(31,"p",4),w._uU(32,"\u8ca0\u8cac\u4eba\uff1a"),w.qZA(),w.TgZ(33,"span"),w._uU(34),w.qZA(),w.qZA(),w.TgZ(35,"div",3),w.TgZ(36,"p",4),w._uU(37,"\u8d77\u8fc4\u6642\u9593\uff1a"),w.qZA(),w.TgZ(38,"span"),w._uU(39),w.ALo(40,"date"),w.qZA(),w.TgZ(41,"span"),w._uU(42,"~"),w.qZA(),w.TgZ(43,"span"),w._uU(44),w.ALo(45,"date"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(46,"div",2),w.TgZ(47,"div",3),w.TgZ(48,"p",4),w._uU(49,"\u6a19\u7c64\u69cb\u9762\uff1a"),w.qZA(),w.TgZ(50,"span"),w._uU(51),w.qZA(),w.qZA(),w.TgZ(52,"div",3),w.TgZ(53,"p",4),w._uU(54,"\u6a19\u7c64\u5b50\u69cb\u9762\uff1a"),w.qZA(),w.TgZ(55,"span"),w._uU(56),w.qZA(),w.qZA(),w.TgZ(57,"div",3),w.TgZ(58,"p",4),w._uU(59,"\u7570\u52d5\u6642\u9593\uff1a"),w.qZA(),w.TgZ(60,"span"),w._uU(61),w.ALo(62,"date"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(63,"div",2),w.TgZ(64,"div",5),w.TgZ(65,"p",4),w._uU(66,"\u63cf\u8ff0\u8aaa\u660e\uff1a"),w.qZA(),w.TgZ(67,"span"),w._uU(68),w.qZA(),w.qZA(),w.YNc(69,_e,5,1,"div",6),w.qZA(),w.YNc(70,Le,6,4,"div",7),w.qZA(),w.qZA(),w.TgZ(71,"nb-card"),w.TgZ(72,"nb-card-header"),w.TgZ(73,"h2"),w._uU(74,"\u6392\u7a0b\u7d00\u9304"),w.qZA(),w.qZA(),w.TgZ(75,"nb-card-body"),w.TgZ(76,"div"),w._UZ(77,"ng2-smart-table",8),w._UZ(78,"paginator",9),w.qZA(),w.qZA(),w.qZA(),w.TgZ(79,"div",2),w.TgZ(80,"div",10),w.TgZ(81,"button",11),w.NdJ("click",function(){return t.cancel()}),w._uU(82,"\u8fd4 \u56de"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(11),w.Oqu(null==t.detail?null:t.detail.tagName),w.xp6(5),w.Oqu(w.xi3(17,17,null==t.detail||null==t.detail.status?null:t.detail.status.toLowerCase(),"status")),w.xp6(6),w.Oqu(w.xi3(23,20,null==t.detail||null==t.detail.tagType?null:t.detail.tagType.toLowerCase(),"tagType")),w.xp6(7),w.Oqu(null==t.detail?null:t.detail.department),w.xp6(5),w.Oqu(null==t.detail?null:t.detail.owner),w.xp6(5),w.Oqu(w.xi3(40,23,null==t.detail?null:t.detail.startDate,t.dateFormat)),w.xp6(5),w.Oqu(w.xi3(45,26,null==t.detail?null:t.detail.endDate,t.dateFormat)),w.xp6(7),w.Oqu((null==t.detail?null:t.detail.categoryName)||(null==t.detail?null:t.detail.categoryKey)),w.xp6(5),w.Oqu((null==t.detail?null:t.detail.tagTopicName)||(null==t.detail?null:t.detail.tagTopicKey)),w.xp6(5),w.Oqu(w.xi3(62,29,null==t.detail?null:t.detail.modificationTime,t.dateFormat)),w.xp6(7),w.Oqu(null==t.detail?null:t.detail.tagDescription),w.xp6(1),w.Q6J("ngIf","document"===(null==t.detail?null:t.detail.tagType)),w.xp6(1),w.Q6J("ngIf","document"!==(null==t.detail?null:t.detail.tagType)&&("field"===(null==t.detail?null:t.detail.conditionSettingMethod)||"normal"===(null==t.detail?null:t.detail.conditionSettingMethod))),w.xp6(7),w.Q6J("settings",t.gridDefine)("source",t.dataSource),w.xp6(1),w.Q6J("source",t.dataSource)("paginator",t.paginator))},directives:[s.Asz,s.yKW,g.O5,s.ndF,l.T5,U.J,s.DPz,g.sg,s.c2L],pipes:[P.z,g.uU],styles:[".link-style[_ngcontent-%COMP%]{color:#26dd84!important;cursor:pointer}"]}),e})(),data:{keepSession:!0}}]}];let Me=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[r.Bz.forChild(Qe)],r.Bz]}),e})();var $e=i(83621);const Ye=[s.uuI,s.zyh,s.caZ,s.KdK,a.$,s.MfT,s.YNG,s.nKr,s.T2N,s.IIj,s.OA,s.oGl,s.CG_,s.urD,s.EoG,o.k.forChild({format:"yyyy-MM-dd"})];let Be=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[E.Q,F,we.P],imports:[[n.e,c.u5,c.UX,d.O,Me,l.ne,$e.Dv,...Ye]]}),e})()}}]);