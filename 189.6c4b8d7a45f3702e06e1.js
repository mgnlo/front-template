(self.webpackChunkconsole_frontend=self.webpackChunkconsole_frontend||[]).push([[189],{42189:(e,t,i)=>{"use strict";i.r(t),i.d(t,{NB_MODULES:()=>ut,ReviewManageModule:()=>gt});var a=i(3679),n=i(23918),s=i(39363),o=i(83621),r=i(73749),c=i(38832),l=i(11004),d=i(76185),u=i(86794),g=i(63423),p=i(88567),v=i(26575);const h=[{historyId:"h123456",version:"uuid-zzzz",referenceId:"abcdefg123456",groupId:1,time:"2023-07-01 09:00:00",title:"\u5efa\u7acb\u689d\u4ef6\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6d3b\u52d5",reviewStatus:"approved",reviewer:null,reviewComment:null,activityName:"\u5feb\u9583\u6d3b\u52d5",activityDescription:"-",filterOptions:"true",listLimit:250,status:"enabled",startDate:"2023-07-01",endDate:"2023-07-01",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-08-02 12:00:00",activityListCondition:[{activityId:"abcdefg123457",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"abcdefg123457",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"},{activityId:"abcdefg123457",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e09\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u4f4e",tagId:"tag-790"}]},{historyId:"h123457",version:"uuid-zzzz",referenceId:"ef9d5fe8-a247-4d79-b9df-946d9ee43678",groupId:1,time:"2023-07-01 09:00:00",title:"\u5be9\u6838",detail:"\u4e0d\u540c\u610f",type:"\u5efa\u7acb\u6d3b\u52d5",reviewStatus:"rejected",reviewer:null,reviewComment:null,activityName:"\u6bcf\u65e5EDM\u6d3b\u52d5\u767c\u9001",activityDescription:"-",filterOptions:"true",listLimit:1e3,status:"disabled",startDate:"2023-10-10",endDate:"2023-10-10",modificationTime:"2023-09-06 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-457"},{activityId:"uuid-b",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-789"}]},{historyId:"h123459",version:"uuid-zzzz",referenceId:"dbfcea5f-8949-4c4e-9964-eebbe316b4f7",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"reviewing",activityName:"\u7236\u89aa\u7bc0\u6d3b\u52d5",activityDescription:"-",filterOptions:"false",listLimit:180,startDate:"2023-07-01",endDate:"2023-07-19",status:"reviewing",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"monthly",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"},{activityId:"uuid-b",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-789"},{activityId:"uuid-b",conditionId:"4",version:"uuid-zzzz",tagGroup:3,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-792"}]},{historyId:"h123459",version:"uuid-zzzz",referenceId:"9d24e344-c57b-42cc-bf20-6d62bf857e7f",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"reviewing",activityName:"\u5546\u54c1EDM\u96d9\u9031\u767c\u9001",activityDescription:"\u96d9\u9031\u767c\u9001\u516c\u53f8\u6bcf\u671f\u5546\u54c1\u8cc7\u8a0a",filterOptions:"true",listLimit:180,startDate:"2023-07-01",endDate:"2023-07-19",status:"reviewing",modificationTime:"2023-02-05 15:30:00",scheduleSettings:"monthly",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"}]},{historyId:"h123460",version:"uuid-zzzz",referenceId:"b28e431c-8730-43a2-b500-ea41f8f1934c",groupId:2,time:"2023-07-01 09:00:00",title:"\u5be9\u6838",detail:"\u540c\u610f",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"rejected",activityName:"\u6625\u7bc0\u6176\u795d\u6d3b\u52d5",activityDescription:"-",filterOptions:"false",listLimit:100,status:"disabled",startDate:"2024-01-01",endDate:"2024-01-19",modificationTime:"2023-03-21 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u6027\u5225-\u7537",tagId:"tag-456"},{activityId:"uuid-b",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-789"}]},{historyId:"h123460",version:"3bf4ef45-5e06-4c39-a097-7bce6e6f8a3f",referenceId:"abcdefg123456",groupId:2,time:"2023-07-01 09:00:00",title:"\u5be9\u6838",detail:"\u540c\u610f",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"rejected",activityName:"\u4e2d\u79cb\u7bc0\u611f\u6069\u6d3b\u52d5",activityDescription:"-",filterOptions:"true",listLimit:320,status:"reviewing",startDate:"2023-09-20",endDate:"2023-09-29",modificationTime:"2023-07-07 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"7",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"8",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"},{activityId:"uuid-b",conditionId:"9",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-789"}]},{historyId:"h123456",version:"uuid-zzzz",referenceId:"a0a0dfc2-7975-4e80-8067-ea267f548337",groupId:1,time:"2023-07-01 09:00:00",title:"\u5efa\u7acb\u689d\u4ef6\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6d3b\u52d5",reviewStatus:"approved",reviewer:null,reviewComment:null,activityName:"\u5feb\u9583\u6d3b\u52d5",activityDescription:"-",filterOptions:"true",listLimit:250,status:"disabled",startDate:"2023-07-01",endDate:"2023-07-01",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-08-02 12:00:00",activityListCondition:[{activityId:"abcdefg123457",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"abcdefg123457",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"},{activityId:"abcdefg123457",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e09\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u4f4e",tagId:"tag-790"}]},{historyId:"h123459",version:"uuid-zzzz",referenceId:"dbfcea5f-8949-4c4e-9964-eebbe316b4f7",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"reviewing",activityName:"\u7236\u89aa\u7bc0\u6d3b\u52d5",activityDescription:"-",filterOptions:"false",listLimit:180,startDate:"2023-07-01",endDate:"2023-07-19",status:"reviewing",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"monthly",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"},{activityId:"uuid-b",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-789"},{activityId:"uuid-b",conditionId:"4",version:"uuid-zzzz",tagGroup:3,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-792"}]},{historyId:"h123459",version:"uuid-zzzz",referenceId:"90b010ba-bd4b-480a-a0c7-3a35096f2ed8",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"reviewing",activityName:"\u5546\u54c1EDM\u96d9\u9031\u767c\u9001",activityDescription:"\u96d9\u9031\u767c\u9001\u516c\u53f8\u6bcf\u671f\u5546\u54c1\u8cc7\u8a0a",filterOptions:"true",listLimit:180,startDate:"2023-07-01",endDate:"2023-07-19",status:"reviewing",modificationTime:"2023-02-05 15:30:00",scheduleSettings:"monthly",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"}]},{historyId:"h123459",version:"uuid-zzzz",referenceId:"dbfcea5f-8949-4c4e-9964-eebbe316b4f7",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"reviewing",activityName:"\u7236\u89aa\u7bc0\u6d3b\u52d5",activityDescription:"-",filterOptions:"false",listLimit:180,startDate:"2023-07-01",endDate:"2023-07-19",status:"reviewing",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"monthly",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"},{activityId:"uuid-b",conditionId:"3",version:"uuid-zzzz",tagGroup:2,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-789"},{activityId:"uuid-b",conditionId:"4",version:"uuid-zzzz",tagGroup:3,tagName:"\u8fd1\u4e00\u500b\u6708_\u63db\u532f_\u4ea4\u6613\u91d1\u984d-\u9ad8",tagId:"tag-792"}]},{historyId:"h123459",version:"uuid-zzzz",referenceId:"90b010ba-bd4b-480a-a0c7-3a35096f2ed8",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6d3b\u52d5",reviewStatus:"reviewing",activityName:"\u5546\u54c1EDM\u96d9\u9031\u767c\u9001",activityDescription:"\u96d9\u9031\u767c\u9001\u516c\u53f8\u6bcf\u671f\u5546\u54c1\u8cc7\u8a0a",filterOptions:"true",listLimit:180,startDate:"2023-07-01",endDate:"2023-07-19",status:"reviewing",modificationTime:"2023-02-05 15:30:00",scheduleSettings:"monthly",batchUpdateTime:"2023-07-03 12:00:00",activityListCondition:[{activityId:"uuid-b",conditionId:"1",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e00\u500b\u6708_\u57fa\u91d1_\u5b9a\u671f\u5b9a\u984d\u624b\u7e8c\u8cbb-\u9ad8",tagId:"tag-123"},{activityId:"uuid-b",conditionId:"2",version:"uuid-zzzz",tagGroup:1,tagName:"\u8fd1\u4e09\u500b\u6708_\u57fa\u91d1_\u624b\u7e8c\u8cbb-\u4f4e",tagId:"tag-456"}]}];var m=i(27091),f=i(32392),w=i(45435),y=i(5304),Z=i(93342),T=i(37716),b=i(54856),S=i(11470),x=i(15585),A=i(15114),C=i(51425);let I=(()=>{class e{constructor(e){this.service=e,this.tagReviewFunc="tag-review-history/",this.activityReviewFunc="activity-review-history/",this.scheduleReviewFunc="schedule-review-history/"}getActivityReviewRow(e){return this.service.doGet(this.activityReviewFunc+e)}getLastApprovedActivity(e){return this.service.doGet(this.activityReviewFunc+e+"/last-approved")}updateActivityReview(e,t){return this.service.doPut(this.activityReviewFunc+e,t)}getTagReviewRow(e){return this.service.doGet(this.tagReviewFunc+e)}getLastApprovedTag(e){return this.service.doGet(this.tagReviewFunc+e+"/last-approved")}updateTagReview(e,t){return this.service.doPut(this.tagReviewFunc+e,t)}getScheduleReviewRow(e){return this.service.doGet(this.scheduleReviewFunc+e)}getLastApprovedSchedule(e){return this.service.doGet(this.scheduleReviewFunc+e+"/last-approved")}updateScheduleReview(e,t){return this.service.doPut(this.scheduleReviewFunc+e,t)}}return e.\u0275fac=function(t){return new(t||e)(T.LFG(C.s))},e.\u0275prov=T.Yz7({token:e,factory:e.\u0275fac}),e})();var q=i(38583),_=i(87450);function z(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",10),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).viewToggle()}),T._uU(1,"\u67e5\u770b\u7570\u52d5\u524d\u5167\u5bb9"),T.qZA()}}function N(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",10),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).viewToggle()}),T._uU(1,"\u8fd4\u56de\u672c\u6b21\u7570\u52d5\u5167\u5bb9"),T.qZA()}}function D(e,t){if(1&e&&(T.ynx(0),T.YNc(1,z,2,0,"button",9),T.YNc(2,N,2,0,"button",9),T.BQk()),2&e){const e=T.oxw();T.xp6(1),T.Q6J("ngIf",!e.isBefore),T.xp6(1),T.Q6J("ngIf",e.isBefore)}}function O(e,t){if(1&e&&(T.TgZ(0,"p"),T._uU(1),T.qZA()),2&e){const e=T.oxw(2);T.xp6(1),T.hij("\u539f\u56e0\uff1a",e.reviewComment,"")}}const U=function(e){return{alert:e}};function J(e,t){if(1&e&&(T.TgZ(0,"div",11),T._UZ(1,"nb-icon",12),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"enum"),T.qZA(),T._UZ(5,"br"),T.YNc(6,O,2,1,"p",1),T.qZA()),2&e){const e=T.oxw();T.Q6J("ngClass",T.VKq(6,U,"rejected"===e.reviewStatus)),T.xp6(3),T.hij("\u5be9\u6838\u7d50\u679c\uff1a",T.xi3(4,3,e.reviewStatus,"reviewStatus"),""),T.xp6(3),T.Q6J("ngIf","rejected"===e.reviewStatus)}}function k(e,t){if(1&e&&(T.TgZ(0,"div",19),T.TgZ(1,"p",20),T._uU(2,"\u5075\u6e2c\u689d\u4ef6\uff1a"),T.qZA(),T.TgZ(3,"span"),T._uU(4),T.qZA(),T.qZA()),2&e){const e=t.$implicit;T.xp6(4),T.Oqu(e.tagName)}}function L(e,t){if(1&e&&(T.ynx(0),T.TgZ(1,"div",17),T.ALo(2,"enum"),T.TgZ(3,"div",4),T.YNc(4,k,5,1,"div",18),T.qZA(),T.qZA(),T.BQk()),2&e){const e=T.oxw(),t=e.index,i=e.$implicit,a=T.oxw();T.xp6(1),T.Q6J("ngClass",T.xi3(2,2,a.getConditionClass(t),"bgClass")),T.xp6(3),T.Q6J("ngForOf",i.value)}}function F(e,t){if(1&e){const e=T.EpF();T.ynx(0),T.TgZ(1,"div",13),T.TgZ(2,"p",14),T.ALo(3,"enum"),T._uU(4),T.qZA(),T.TgZ(5,"button",15),T.NdJ("click",function(){const t=T.CHM(e).$implicit,i=T.oxw();return i.isConditionOpen[t.key]=!i.isConditionOpen[t.key]}),T._UZ(6,"nb-icon",16),T.qZA(),T.qZA(),T.YNc(7,L,5,5,"ng-container",1),T.BQk()}if(2&e){const e=t.$implicit,i=t.index,a=T.oxw();T.xp6(2),T.Q6J("ngClass",T.xi3(3,5,a.getConditionClass(i),"reviewCompareClass")),T.xp6(2),T.hij("\u6d3b\u52d5\u540d\u55ae\u689d\u4ef6",e.key,""),T.xp6(1),T.Q6J("status",a.isConditionOpen[e.key]?"info":"basic")("ngClass",a.isConditionOpen[e.key]?"btnClick":""),T.xp6(2),T.Q6J("ngIf",a.isConditionOpen[e.key])}}function Q(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",4),T.TgZ(1,"div",21),T.TgZ(2,"button",22),T.NdJ("click",function(){return T.CHM(e),T.oxw().cancel()}),T._uU(3,"\u8fd4 \u56de"),T.qZA(),T.qZA(),T.qZA()}}function M(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",25),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).send("rejected")}),T._uU(1,"\u4e0d\u540c\u610f"),T.qZA()}}function Y(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",26),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).send("approved")}),T._uU(1,"\u540c \u610f"),T.qZA()}}function B(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",4),T.TgZ(1,"div",21),T.TgZ(2,"button",22),T.NdJ("click",function(){return T.CHM(e),T.oxw().cancel()}),T._uU(3,"\u8fd4 \u56de"),T.qZA(),T.YNc(4,M,2,0,"button",23),T.YNc(5,Y,2,0,"button",24),T.qZA(),T.qZA()}if(2&e){const e=T.oxw();T.xp6(4),T.Q6J("ngIf",e.isCrud.update),T.xp6(1),T.Q6J("ngIf",e.isCrud.update)}}function G(e,t){if(1&e&&(T.TgZ(0,"div",34),T.TgZ(1,"div"),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"date"),T.qZA(),T.TgZ(5,"p"),T._uU(6),T.ALo(7,"date"),T.qZA(),T.qZA(),T.TgZ(8,"div"),T.TgZ(9,"p"),T._uU(10),T.qZA(),T.TgZ(11,"p"),T._uU(12),T.qZA(),T.qZA(),T.qZA()),2&e){const e=t.$implicit,i=T.oxw(2).$implicit,a=T.oxw(2);T.Q6J("ngClass",a.isHistoryOpen[i.key]?"":"dis_none"),T.xp6(3),T.Oqu(T.xi3(4,5,e.time,a.dateFormat)),T.xp6(3),T.Oqu(T.xi3(7,8,e.time,"hh:mm:ss")),T.xp6(4),T.Oqu(e.title),T.xp6(2),T.Oqu(e.detail)}}function R(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",29),T.TgZ(1,"div",30),T.TgZ(2,"h4",31),T.NdJ("click",function(){T.CHM(e);const t=T.oxw().$implicit,i=T.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),T._uU(3),T.qZA(),T.TgZ(4,"button",32),T.NdJ("click",function(){T.CHM(e);const t=T.oxw().$implicit,i=T.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),T._UZ(5,"nb-icon",16),T.qZA(),T.qZA(),T.YNc(6,G,13,11,"div",33),T.qZA()}if(2&e){const e=t.ngIf,i=T.oxw().$implicit,a=T.oxw(2);T.Q6J("ngClass",a.isHistoryOpen[i.key]?"closeSubItem":""),T.xp6(3),T.Oqu(e.type),T.xp6(3),T.Q6J("ngForOf",e.flows)}}function P(e,t){if(1&e&&(T.ynx(0),T.YNc(1,R,7,3,"div",28),T.BQk()),2&e){const e=t.$implicit;T.xp6(1),T.Q6J("ngIf",e.value)}}function H(e,t){if(1&e&&(T.TgZ(0,"nb-card"),T.TgZ(1,"nb-card-header"),T.TgZ(2,"h2"),T._uU(3,"\u7570\u52d5\u6b77\u7a0b"),T.qZA(),T.qZA(),T.TgZ(4,"nb-card-body"),T.TgZ(5,"div",27),T.YNc(6,P,2,1,"ng-container",7),T.ALo(7,"keyvalue"),T.qZA(),T.qZA(),T.qZA()),2&e){const e=T.oxw();T.xp6(6),T.Q6J("ngForOf",T.lcZ(7,1,e.historyGroupView))}}let V=(()=>{class e extends f.H{constructor(e,t,i,a,n,s,o,r){super(e,t,i),this.router=a,this.dialogService=n,this.activatedRoute=s,this.loadingService=o,this.reviewManageService=r,this.isConditionOpen={},this.isHistoryOpen={},this.isSameList={},this.isSameCon={},this.isBefore=!1,this.isCompare=!1}ngOnInit(){if(this.historyId=this.activatedRoute.snapshot.params.historyId,this.loadingService.open(),this.isMock){let e=h.find(e=>e.historyId===this.historyId);this.newDetail=JSON.parse(JSON.stringify(e)),this.newReview=JSON.parse(JSON.stringify(e)),this.reviewStatus=e.reviewStatus,this.reviewComment=e.reviewComment,this.newDetail.tagGroupView=m.l.groupBy(e.activityListCondition,"tagGroup"),this.detail=this.newDetail,Object.keys(this.detail.tagGroupView).forEach(e=>this.isConditionOpen[e]=!0);const t=m.l.getHistoryProcessData("activityReviewHistoryAud",this.newDetail);t&&(this.isHistoryOpen=t.isHistoryOpen,this.detail=t.detail,this.historyGroupView=this.detail.historyGroupView);let i=v.w.find(t=>t.activityId===e.referenceId);return this.isCompare=!!i,this.isCompare&&(this.oldDetail=JSON.parse(JSON.stringify(i)),this.oldReview=JSON.parse(JSON.stringify(i)),(null==i?void 0:i.activityListCondition)&&(this.oldDetail.tagGroupView=m.l.groupBy(i.activityListCondition,"tagGroup")),this.isSameList=m.l.compareObj(this.newDetail,this.oldDetail),this.compareCondition(this.detail.tagGroupView,"old")),void this.loadingService.close()}this.reviewManageService.getActivityReviewRow(this.historyId).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{throw this.dialogService.alertAndBackToList(!1,`${e.message}\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u6a19\u7c64\u5be9\u6838\u5217\u8868`),this.loadingService.close(),new Error(e.message)}),(0,Z.b)(e=>{this.newDetail=JSON.parse(JSON.stringify(e.result)),this.newReview=JSON.parse(JSON.stringify(e.result)),this.reviewStatus=e.result.reviewStatus,this.reviewComment=e.result.reviewComment,this.newDetail.tagGroupView=m.l.groupBy(e.result.activityListCondition,"tagGroup"),this.detail=this.newDetail,Object.keys(this.detail.tagGroupView).forEach(e=>this.isConditionOpen[e]=!0);const t=m.l.getHistoryProcessData("activityReviewHistoryAud",this.newDetail);t&&(this.isHistoryOpen=t.isHistoryOpen,this.detail=t.detail,this.historyGroupView=this.detail.historyGroupView),this.loadingService.close()})).subscribe(()=>{this.reviewManageService.getLastApprovedActivity(this.historyId).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{let t=!!Object.values(p.m).includes(e.code)&&null;throw this.dialogService.alertAndBackToList(t,`${e.message}\uff0c\u7121\u524d\u6b21\u6838\u51c6\u7d00\u9304`),this.loadingService.close(),new Error(e.message)}),(0,Z.b)(e=>{var t;this.isCompare=!!e.result,this.isCompare&&(this.oldDetail=JSON.parse(JSON.stringify(e.result)),this.oldReview=JSON.parse(JSON.stringify(e.result)),(null===(t=e.result)||void 0===t?void 0:t.activityListCondition)&&(this.oldDetail.tagGroupView=m.l.groupBy(e.result.activityListCondition,"tagGroup")),this.isSameList=m.l.compareObj(this.newDetail,this.oldDetail),this.compareCondition(this.detail.tagGroupView,"old")),this.loadingService.close()})).subscribe()})}viewToggle(){this.isBefore=!this.isBefore,this.detail=!0===this.isBefore?this.oldDetail:this.newDetail,this.detail.tagGroupView=m.l.groupBy((!0===this.isBefore?this.oldReview:this.newReview).activityListCondition,"tagGroup"),this.compareCondition(this.detail.tagGroupView,!0===this.isBefore?"new":"old"),Object.keys(this.detail.tagGroupView).forEach(e=>this.isConditionOpen[e]=!0)}changeClass(e,t){let i=this.isSameList[e];if(t){let e=this.isSameList[t];return i&&e?"true":i&&e||!this.isBefore?"false":"null"}return i?"true":!i&&this.isBefore?"null":"false"}getConditionClass(e){let t=this.isSameCon[e];return t?"true":!t&&this.isBefore?"null":"false"}compareCondition(e,t){this.isSameCon={};let i="new"===t?this.newDetail.tagGroupView:this.oldDetail.tagGroupView,a=Object.keys(e),n=Object.keys(i),s=a.map(t=>e[t].map(e=>e.tagId)),o=n.map(e=>i[e].map(e=>e.tagId));s.forEach((e,t)=>{this.isSameCon[t]=JSON.stringify(e)===JSON.stringify(o[t])})}send(e){let t={title:"\u5ba2\u7fa4\u540d\u55ae\u7570\u52d5\u99c1\u56de\u8aaa\u660e",isApproved:"approved"===e};this.isMock?this.dialogService.openReview(t).componentRef.instance.emit.subscribe(e=>{this.dialogService.openReview(t).close(),this.router.navigate(["pages","review-manage","review-activity-list"])}):this.dialogService.openReview(t).componentRef.instance.emit.subscribe(t=>{this.reviewManageService.updateActivityReview(this.historyId,{reviewStatus:e,reviewComment:t.reviewComment}).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{throw this.dialogService.alertAndBackToList(!1,e),new Error(e.message)}),(0,Z.b)(e=>this.router.navigate(["pages","review-manage","review-activity-list"]))).subscribe()})}cancel(){this.router.navigate(["pages","review-manage","review-activity-list"])}}return e.\u0275fac=function(t){return new(t||e)(T.Y36(b.V),T.Y36(S.E),T.Y36(x.r),T.Y36(g.F0),T.Y36(n.x),T.Y36(g.gz),T.Y36(A.b),T.Y36(I))},e.\u0275cmp=T.Xpm({type:e,selectors:[["review-activity-detail"]],features:[T.qOj],decls:72,vars:66,consts:[[1,"pageTitle"],[4,"ngIf"],[1,"pageContent"],["class","noteText",3,"ngClass",4,"ngIf"],[1,"row"],[1,"textGroup","col-12","col-lg-4"],[1,"text_bold",3,"ngClass"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["nbButton","","status","primary","size","small",3,"click",4,"ngIf"],["nbButton","","status","primary","size","small",3,"click"],[1,"noteText",3,"ngClass"],["icon","info-outline"],[1,"subTitle"],[3,"ngClass"],["nbButton","","size","small",1,"iconBtn","btnSwitch",3,"status","ngClass","click"],["icon","arrow-ios-forward"],[1,"colorArea",3,"ngClass"],["class","textGroup col-12 col-lg-12",4,"ngFor","ngForOf"],[1,"textGroup","col-12","col-lg-12"],[1,"text_bold"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","danger","size","medium",3,"click",4,"ngIf"],["nbButton","","status","primary","size","medium",3,"click",4,"ngIf"],["nbButton","","status","danger","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"click"],[1,"historyList"],["class","historyItem active moreBtn",3,"ngClass",4,"ngIf"],[1,"historyItem","active","moreBtn",3,"ngClass"],[1,"mainItem"],[3,"click"],["nbButton","","ghost","","status","info","size","tiny",1,"iconBtn",3,"click"],["class","subItem",3,"ngClass",4,"ngFor","ngForOf"],[1,"subItem",3,"ngClass"]],template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"\u5ba2\u7fa4\u540d\u55ae\u5be9\u6838"),T.qZA(),T.YNc(3,D,3,2,"ng-container",1),T.qZA(),T.TgZ(4,"div",2),T.YNc(5,J,7,8,"div",3),T.TgZ(6,"nb-card"),T.TgZ(7,"nb-card-body"),T.TgZ(8,"div",4),T.TgZ(9,"div",5),T.TgZ(10,"p",6),T.ALo(11,"enum"),T._uU(12,"\u6d3b\u52d5\u540d\u7a31\uff1a"),T.qZA(),T.TgZ(13,"span"),T._uU(14),T.qZA(),T.qZA(),T.TgZ(15,"div",5),T.TgZ(16,"p",6),T.ALo(17,"enum"),T._uU(18,"\u72c0\u614b\uff1a"),T.qZA(),T.TgZ(19,"span"),T._uU(20),T.ALo(21,"enum"),T.qZA(),T.qZA(),T.TgZ(22,"div",5),T.TgZ(23,"p",6),T.ALo(24,"enum"),T._uU(25,"\u540d\u55ae\u4e0a\u9650\uff1a"),T.qZA(),T.TgZ(26,"span"),T._uU(27),T.qZA(),T.qZA(),T.TgZ(28,"div",5),T.TgZ(29,"p",6),T.ALo(30,"enum"),T._uU(31,"\u540d\u55ae\u5dee\u7570\u904e\u6ffe\uff1a"),T.qZA(),T.TgZ(32,"span"),T._uU(33),T.ALo(34,"enum"),T.qZA(),T.qZA(),T.TgZ(35,"div",5),T.TgZ(36,"p",6),T.ALo(37,"enum"),T._uU(38,"\u8d77\u8fc4\u6642\u9593\uff1a"),T.qZA(),T.TgZ(39,"span"),T._uU(40),T.qZA(),T.qZA(),T.TgZ(41,"div",5),T.TgZ(42,"p",6),T.ALo(43,"enum"),T._uU(44,"\u63cf\u8ff0\u8aaa\u660e\uff1a"),T.qZA(),T.TgZ(45,"span"),T._uU(46),T.qZA(),T.qZA(),T.TgZ(47,"div",5),T.TgZ(48,"p",6),T.ALo(49,"enum"),T._uU(50,"\u7570\u52d5\u6642\u9593\uff1a"),T.qZA(),T.TgZ(51,"span"),T._uU(52),T.ALo(53,"date"),T.qZA(),T.qZA(),T.TgZ(54,"div",5),T.TgZ(55,"p",6),T.ALo(56,"enum"),T._uU(57,"\u6392\u7a0b\u8a2d\u5b9a\uff1a"),T.qZA(),T.TgZ(58,"span"),T._uU(59),T.ALo(60,"enum"),T.qZA(),T.qZA(),T.TgZ(61,"div",5),T.TgZ(62,"p",6),T.ALo(63,"enum"),T._uU(64,"\u6392\u7a0b\u66f4\u65b0\u6642\u9593\uff1a"),T.qZA(),T.TgZ(65,"span"),T._uU(66),T.qZA(),T.qZA(),T.qZA(),T.YNc(67,F,8,8,"ng-container",7),T.ALo(68,"keyvalue"),T.qZA(),T.qZA(),T.YNc(69,Q,4,0,"div",8),T.YNc(70,B,6,2,"div",8),T.YNc(71,H,8,3,"nb-card",1),T.qZA()),2&e&&(T.xp6(3),T.Q6J("ngIf","reviewing"===t.reviewStatus&&t.isCompare),T.xp6(2),T.Q6J("ngIf","reviewing"!==t.reviewStatus),T.xp6(5),T.Q6J("ngClass",T.xi3(11,25,t.changeClass("activityName"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.activityName),T.xp6(2),T.Q6J("ngClass",T.xi3(17,28,t.changeClass("status"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(21,31,null==t.detail?null:t.detail.status,"status")),T.xp6(3),T.Q6J("ngClass",T.xi3(24,34,t.changeClass("listLimit"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.listLimit),T.xp6(2),T.Q6J("ngClass",T.xi3(30,37,t.changeClass("filterOptions"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(34,40,null==t.detail?null:t.detail.filterOptions,"filter")),T.xp6(3),T.Q6J("ngClass",T.xi3(37,43,t.changeClass("startDate","endDate"),"reviewCompareClass")),T.xp6(4),T.AsE("",null==t.detail?null:t.detail.startDate,"~",null==t.detail?null:t.detail.endDate,""),T.xp6(2),T.Q6J("ngClass",T.xi3(43,46,t.changeClass("activityDescription"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.activityDescription),T.xp6(2),T.Q6J("ngClass",T.xi3(49,49,t.changeClass("modificationTime"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(53,52,null==t.detail?null:t.detail.modificationTime,t.dateFormat)),T.xp6(3),T.Q6J("ngClass",T.xi3(56,55,t.changeClass("scheduleSettings"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(60,58,null==t.detail?null:t.detail.scheduleSettings,"schedule")),T.xp6(3),T.Q6J("ngClass",T.xi3(63,61,t.changeClass("batchUpdateTime"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.batchUpdateTime),T.xp6(1),T.Q6J("ngForOf",T.lcZ(68,64,null==t.detail?null:t.detail.tagGroupView)),T.xp6(2),T.Q6J("ngIf","reviewing"!==t.reviewStatus),T.xp6(1),T.Q6J("ngIf","reviewing"===t.reviewStatus),T.xp6(1),T.Q6J("ngIf",t.historyGroupView))},directives:[q.O5,c.Asz,c.yKW,q.mk,q.sg,c.DPz,c.fMN,c.ndF],pipes:[_.z,q.uU,q.Nd],styles:[".noteText[_ngcontent-%COMP%]{flex-wrap:wrap}.noteText[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:90%}.noteText[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-of-type){padding-left:2rem}"]}),e})();var E=i(36332),j=i(26150),$=i(21523),K=i(32478),X=i(63731),W=i(35043),ee=i(68877),te=i(79761),ie=i(33256),ae=i(65969);function ne(e,t){if(1&e&&(T.ynx(0),T._UZ(1,"ng2-smart-table",13),T._UZ(2,"paginator",14),T.BQk()),2&e){const e=t.ngIf,i=T.oxw();T.xp6(1),T.Q6J("settings",i.gridDefine)("source",e),T.xp6(1),T.Q6J("source",e)("paginator",i.paginator)}}let se=(()=>{class e extends f.H{constructor(e,t,i,n,s,o){super(e,t,i),this.activatedRoute=n,this.reviewManageService=s,this.tableService=o,this.isSearch=!1,this.gridDefine={pager:{display:!0,perPage:10},columns:{activityName:{title:"\u6d3b\u52d5\u540d\u7a31",type:"string",sort:!1},activityDescription:{title:"\u6d3b\u52d5\u8aaa\u660e",type:"html",valuePrepareFunction:e=>`<p>${null!=e?e:""}</p>`,sort:!1},filterOptions:{title:"\u5dee\u7570\u904e\u6ffe",type:"custom",width:"3rem",renderComponent:K.w,sort:!1},listLimit:{title:"\u540d\u55ae\u4e0a\u9650",type:"html",class:"text_center",valuePrepareFunction:(e,t)=>`<p class="text_center">${null!=e?e:""}</p>`},modificationTime:{title:"\u540d\u55ae\u6709\u6548\u8d77\u8fc4\u65e5",type:"html",class:"text_center",valuePrepareFunction:(e,t)=>`<p class="text_center">${null==t?void 0:t.startDate} ~ ${null==t?void 0:t.endDate}</p>`,sort:!1},type:{title:"\u7570\u52d5\u985e\u578b",type:"html",class:"text_center",valuePrepareFunction:(e,t,i)=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},reviewStatus:{title:"\u72c0\u614b",type:"html",class:"text_center",valuePrepareFunction:e=>e?`<p class="text_center ${E.CZ[e]||""}">`+(j.C[e]||"")+"</p>":"",sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",valuePrepareFunction:(e,t)=>t,renderComponent:X.m,sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.validateForm=new a.cw({activityName:new a.NI(""),reviewStatus:new a.NI(""),startDate:new a.NI(null,$.I.dateFmt),endDate:new a.NI(null,$.I.dateFmt)},[$.I.dateRange]),this.sessionKey=this.activatedRoute.snapshot.routeConfig.path}ngOnInit(){this.search()}ngOnDestroy(){this.setSessionData()}setSessionData(){var e,t;const i=this.isSearch?this.validateForm.getRawValue():null!==(t=null===(e=this.storageService.getSessionVal(this.sessionKey))||void 0===e?void 0:e.filter)&&void 0!==t?t:this.validateForm.getRawValue();this.setSessionVal({page:this.paginator.nowPage,filter:i})}reset(){this.validateForm.reset({activityName:"",reviewStatus:"",startDate:null,endDate:null}),this.isSearch=!0,this.paginator.nowPage=1,this.setSessionData(),this.search("reset")}search(e){if(this.isMock){this.dataSource.reset();let e=this.validateForm.getRawValue();for(const[t,i]of Object.entries(e).filter(([e,t])=>!!t))this.dataSource.addFilter({field:t,filter:void 0,search:i});return void this.dataSource.load(h)}const t=this.storageService.getSessionVal(this.sessionKey);this.isSearch=!1,"search"===e&&(this.isSearch=!0),["search","reset"].includes(e)&&(this.paginator.nowPage=1);let i=this.paginator.nowPage;"search"!==e&&(null==t?void 0:t.filter)&&(i=t.page,m.l.initializeFormWithSessionData(this.validateForm,t)),"reset"!==e&&this.setSessionData();let a={apiUrl:this.reviewManageService.activityReviewFunc,nowPage:i,filters:this.validateForm.getRawValue(),errMsg:"\u5ba2\u7fa4\u540d\u55ae\u5be9\u6838\u67e5\u7121\u8cc7\u6599"};this.restDataSource=this.tableService.searchData(a)}}return e.\u0275fac=function(t){return new(t||e)(T.Y36(b.V),T.Y36(S.E),T.Y36(x.r),T.Y36(g.gz),T.Y36(I),T.Y36(W.I))},e.\u0275cmp=T.Xpm({type:e,selectors:[["review-activity-list"]],features:[T.qOj],decls:30,vars:6,consts:[[1,"pageTitle"],[1,"pageContent"],[3,"formGroup"],[1,"row"],["title","\u6d3b\u52d5\u540d\u7a31","ctlName","activityName",1,"col-12","col-lg-6",3,"form"],["title","\u72c0\u614b","ctlName","reviewStatus",1,"col-12","col-lg-6",3,"form"],[3,"form"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"disabled","click"],[1,"noteText"],["icon","info-outline"],[4,"ngIf"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"\u5ba2\u7fa4\u540d\u55ae\u5be9\u6838"),T.qZA(),T.qZA(),T.TgZ(3,"div",1),T.TgZ(4,"nb-card"),T.TgZ(5,"nb-card-header"),T.TgZ(6,"h2"),T._uU(7,"\u67e5\u8a62\u8a2d\u5b9a\u503c"),T.qZA(),T.qZA(),T.TgZ(8,"nb-card-body",2),T.TgZ(9,"div",3),T._UZ(10,"basic-input",4),T._UZ(11,"dropdown",5),T.qZA(),T._UZ(12,"date-range",6),T.qZA(),T.qZA(),T.TgZ(13,"div",3),T.TgZ(14,"div",7),T.TgZ(15,"button",8),T.NdJ("click",function(){return t.reset()}),T._uU(16,"\u6e05 \u9664"),T.qZA(),T.TgZ(17,"button",9),T.NdJ("click",function(){return t.search("search")}),T._uU(18,"\u67e5 \u8a62"),T.qZA(),T.qZA(),T.qZA(),T._UZ(19,"hr"),T.TgZ(20,"nb-card"),T.TgZ(21,"nb-card-header"),T.TgZ(22,"h2"),T._uU(23,"\u5be9\u6838\u5217\u8868"),T.qZA(),T.qZA(),T.TgZ(24,"nb-card-body"),T.TgZ(25,"div",10),T._UZ(26,"nb-icon",11),T.TgZ(27,"p"),T._uU(28,"\u672c\u65e5\u5df2\u5be9\u67e5\u4e4b\u9805\u76ee\u5c07\u7559\u5b58\u65bc\u5217\u8868\u5167\uff0c\u4e26\u6a19\u8a3b\u70ba\u300c\u540c\u610f\u300d\u6848\u4ef6\uff1b\u6bcf\u65e5 00:00 \u6279\u6b21\u66f4\u65b0\u5217\u8868\u5167\u5bb9\uff0c\u6b32\u67e5\u770b\u300c\u540c\u610f\u300d\u6848\u4ef6\u8acb\u79fb\u81f3\u300c\u8a72\u5ba2\u7fa4\u540d\u55ae\u300d\u67e5\u8a62\u76f8\u95dc\u6b77\u7a0b\u3002"),T.qZA(),T.qZA(),T.YNc(29,ne,3,4,"ng-container",12),T.qZA(),T.qZA(),T.qZA()),2&e&&(T.xp6(8),T.Q6J("formGroup",t.validateForm),T.xp6(2),T.Q6J("form",t.validateForm),T.xp6(1),T.Q6J("form",t.validateForm),T.xp6(1),T.Q6J("form",t.validateForm),T.xp6(5),T.Q6J("disabled",t.validateForm.invalid),T.xp6(12),T.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[c.Asz,c.ndF,c.yKW,a.JL,a.sg,ee.n,te.J,ie.S,c.DPz,c.fMN,q.O5,d.T5,ae.J],styles:[""]}),e})(),oe=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=T.Xpm({type:e,selectors:[["app-review-manage"]],decls:1,vars:0,template:function(e,t){1&e&&T._UZ(0,"router-outlet")},directives:[g.lC],encapsulation:2}),e})();var re=i(31508);const ce=[{historyId:"hh123461",referenceId:"cccccc123456",groupId:3,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u6392\u7a0b\u8a2d\u5b9a",type:"\u4fee\u6539\u6a19\u7c64",reviewStatus:"rejected",reviewer:"\u6797XX",reviewComment:"\u9000\u56de",tagName:"\u8fd1\u4e00\u500b\u6708\u91d1\u7533\u91d1\u984d",tagDescription:"\u6a19\u7c64\u8aaa\u660e\u6a19\u8aaa\u660e\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u6578\u4f4d\u91d1\u878d\u8655",owner:"\u6797XX",modificationTime:"2023-07-02 15:30:00",status:"enabled",startDate:"2023-07-01",endDate:"2023-07-10",conditionSettingMethod:"\u689d\u4ef6\u8a2d\u5b9a\u65b9\u5f0f",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"monthly",uploadType:"monthly",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91"},{historyId:"hh123459",referenceId:"cccccc123456",groupId:2,time:"2023-07-01 09:00:00",title:"\u4fee\u6539",detail:"\u4e0a\u7dda\u4eba\u6578",type:"\u4fee\u6539\u6a19\u7c64",reviewStatus:"approved",reviewer:"\u6797XX",reviewComment:"",tagName:"\u5df2\u5a5a",tagDescription:"\u6a19\u7c64\u8aaa\u660e",tagType:"document",department:"\u6578\u4f4d\u91d1\u878d\u8655",owner:"\u6b66XX",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-06-01",endDate:"2023-08-30",conditionSettingMethod:"\u689d\u4ef6\u8a2d\u5b9a\u65b9\u5f0f",conditionSettingQuery:"\u689d\u4ef6\u8a2d\u5b9a\u8a9e\u6cd5",categoryKey:"\u6a19\u7c64\u69cb\u9762",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"daily",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91"},{historyId:"hh123460",referenceId:"cccccc123456",groupId:1,time:"2023-07-01 09:00:00",title:"\u5be9\u6838",detail:"\u540c\u610f",type:"\u5efa\u7acb\u6a19\u7c64",reviewStatus:"reviewing",reviewer:"\u738bXX",reviewComment:"",tagName:"\u975e\u4fe1\u7528\u5361\u5ba2\u6236",tagDescription:"\u6a19\u7c64\u8aaa\u660e\u6a19\u8aaa\u660e\u6a19\u7c64\u8aaa\u660e",tagType:"normal",department:"\u4fe1\u7528\u5361\u66a8\u652f\u4ed8\u8655",owner:"\u99acXX",modificationTime:"2023-07-03 15:30:00",status:"enabled",startDate:"2023-06-01",endDate:"2023-08-30",conditionSettingMethod:"field",conditionSettingQuery:"null",categoryKey:"A",tagTopicKey:"\u6a19\u7c64\u5b50\u69cb\u9762",scheduleSettings:"daily",uploadType:"\u540d\u55ae\u4e0a\u50b3\u985e\u578b",filePath:"\u4e0a\u50b3\u6a94\u6848\u8def\u5f91",tagConditionSetting:[{tagId:"5d2ce90b-dbe7-4b70-8b41-f50b0e2ba635",conditionId:"21a76994-b15d-47a3-90e4-9b3ef1f9bafd",version:"77ada2a3-f9ca-463b-97f8-aa31c681729c",groupId:1,detectionCondition:"$eq",joinValue:"and",conditionKey:"3000",conditionName:"conditionName",thresholdValue:"100000"},{tagId:"5d2ce90b-dbe7-4b70-8b41-f50b0e2ba635",conditionId:"c54c986b-4499-440c-a0fc-c52c78a600a1",version:"093e360c-900c-4def-83c2-acd1c5aa96c8",groupId:1,detectionCondition:"$lt",joinValue:"and",conditionKey:"apply-amount",conditionName:"conditionName",thresholdValue:"40"},{tagId:"5d2ce90b-dbe7-4b70-8b41-f50b0e2ba635",conditionId:"6f8dfce5-bcdd-4589-a99f-a3a63d05cf1c",version:"093e360c-900c-4def-83c2-acd1c5aa96c8",groupId:1,detectionCondition:"$gt",joinValue:null,conditionKey:"apply-amount",conditionName:"conditionName",thresholdValue:"100"}]},{historyId:"36abdae9-f7a5-45ff-bccd-da66ff212174",referenceId:"5d2ce90b-dbe7-4b70-8b41-f50b0e2ba635",groupId:2,time:"2023-08-23 17:51:14",title:"\u5efa\u7acb\u689d\u4ef6\u9001\u5be9",detail:"\u81ea\u8a02\u5167\u5bb9",type:"\u81ea\u8a02\u985e\u578b",reviewStatus:"reviewing",reviewer:null,reviewComment:null,reviewTime:"2023-08-23 17:51:14",tagName:"\u6e2c\u8a66\u6a19\u7c64001\u9001\u5be9\u66f4\u65b00433",tagDescription:null,tagType:"normal",department:"\u71df\u904b\u90e8",owner:"\u8001\u738b",createTime:"2023-08-23 10:37:44",modificationTime:"2023-08-23 16:34:34",status:"enabled",startDate:"2023-09-01",endDate:"2023-09-30",conditionSettingMethod:"normal",conditionSettingQuery:"SELECT * FROM TAG_SETTING ts;",categoryKey:"B",tagTopicKey:"A",scheduleSettings:null,uploadType:null,filePath:null,version:"24ef50cd-f5cd-42d4-b6e8-4902097e4ac7",tagConditionSetting:[]}];var le=i(76621),de=i(28668),ue=i(7896);function ge(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",13),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).viewToggle()}),T._uU(1,"\u67e5\u770b\u7570\u52d5\u524d\u5167\u5bb9"),T.qZA()}}function pe(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",13),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).viewToggle()}),T._uU(1,"\u8fd4\u56de\u672c\u6b21\u7570\u52d5\u5167\u5bb9"),T.qZA()}}function ve(e,t){if(1&e&&(T.ynx(0),T.YNc(1,ge,2,0,"button",12),T.YNc(2,pe,2,0,"button",12),T.BQk()),2&e){const e=T.oxw();T.xp6(1),T.Q6J("ngIf",!e.isBefore),T.xp6(1),T.Q6J("ngIf",e.isBefore)}}function he(e,t){if(1&e&&(T.TgZ(0,"p"),T._uU(1),T.qZA()),2&e){const e=T.oxw(2);T.xp6(1),T.hij("\u539f\u56e0\uff1a",e.reviewComment,"")}}const me=function(e){return{alert:e}};function fe(e,t){if(1&e&&(T.TgZ(0,"div",14),T._UZ(1,"nb-icon",15),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"enum"),T.qZA(),T._UZ(5,"br"),T.YNc(6,he,2,1,"p",1),T.qZA()),2&e){const e=T.oxw();T.Q6J("ngClass",T.VKq(6,me,"rejected"===e.reviewStatus)),T.xp6(3),T.hij("\u5be9\u6838\u7d50\u679c\uff1a",T.xi3(4,3,e.reviewStatus,"reviewStatus"),""),T.xp6(3),T.Q6J("ngIf","rejected"===e.reviewStatus)}}function we(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",5),T.TgZ(1,"p",16),T._uU(2,"\u540d\u55ae\u4e0a\u50b3\uff1a"),T.qZA(),T.TgZ(3,"a",17),T.NdJ("click",function(){T.CHM(e);const t=T.oxw();return t.isfileDownload?t.onDownloadFile():null}),T._uU(4),T.qZA(),T.qZA()}if(2&e){const e=T.oxw();T.xp6(3),T.Q6J("ngClass",e.isfileDownload?"link-style":"disabled-link-style"),T.xp6(1),T.Oqu(null==e.detail?null:e.detail.fileName)}}function ye(e,t){1&e&&(T.TgZ(0,"div",21),T.TgZ(1,"p"),T._uU(2,"\u689d\u4ef6\u8a2d\u5b9a"),T.qZA(),T.qZA())}function Ze(e,t){if(1&e&&(T.TgZ(0,"div",22),T.TgZ(1,"p",6),T.ALo(2,"enum"),T._uU(3,"\u689d\u4ef6\u8a2d\u5b9a\uff1a"),T.qZA(),T.TgZ(4,"pre"),T._uU(5),T.qZA(),T.qZA()),2&e){const e=T.oxw(2);T.xp6(1),T.Q6J("ngClass",T.xi3(2,2,e.changeClass("conditionSettingMethod"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==e.detail?null:e.detail.conditionSettingQuery)}}function Te(e,t){if(1&e&&(T.TgZ(0,"div",22),T.TgZ(1,"p",6),T.ALo(2,"enum"),T._uU(3,"\u5075\u6e2c\u689d\u4ef6\uff1a"),T.qZA(),T.TgZ(4,"span"),T._uU(5),T.qZA(),T.qZA()),2&e){const e=T.oxw(2);T.xp6(1),T.Q6J("ngClass",T.xi3(2,2,e.changeClass("conditionSettingMethod"),"reviewCompareClass")),T.xp6(4),T.Oqu((null==e.detail||null==e.detail.tagConditionSetting||null==e.detail.tagConditionSetting[0]?null:e.detail.tagConditionSetting[0].conditionName)||(null==e.detail||null==e.detail.tagConditionSetting||null==e.detail.tagConditionSetting[0]?null:e.detail.tagConditionSetting[0].conditionKey))}}function be(e,t){1&e&&T._UZ(0,"nb-tag",28)}function Se(e,t){1&e&&T._UZ(0,"nb-tag",29)}function xe(e,t){if(1&e&&(T.ynx(0),T.TgZ(1,"div",25),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"enum"),T.qZA(),T.TgZ(5,"span"),T._uU(6),T.qZA(),T.YNc(7,be,1,0,"nb-tag",26),T.YNc(8,Se,1,0,"nb-tag",27),T.qZA(),T.BQk()),2&e){const e=t.$implicit;T.xp6(3),T.Oqu(T.xi3(4,4,null==e||null==e.detectionCondition?null:e.detectionCondition.toLowerCase(),"mathSymbol")),T.xp6(3),T.Oqu(null==e?null:e.thresholdValue),T.xp6(1),T.Q6J("ngIf","and"===(null==e||null==e.joinValue?null:e.joinValue.toLowerCase())),T.xp6(1),T.Q6J("ngIf","or"===(null==e||null==e.joinValue?null:e.joinValue.toLowerCase()))}}function Ae(e,t){if(1&e&&(T.TgZ(0,"div",23),T.ALo(1,"enum"),T.TgZ(2,"div",4),T.YNc(3,xe,9,7,"ng-container",24),T.qZA(),T.qZA()),2&e){const e=T.oxw(2);T.Q6J("ngClass",T.xi3(1,2,e.changeClass("tagConditionSetting"),"bgClass")),T.xp6(3),T.Q6J("ngForOf",null==e.detail?null:e.detail.tagConditionSetting)}}function Ce(e,t){if(1&e&&(T.TgZ(0,"div"),T.YNc(1,ye,3,0,"div",18),T.TgZ(2,"div",4),T.YNc(3,Ze,6,5,"div",19),T.YNc(4,Te,6,5,"div",19),T.YNc(5,Ae,4,5,"div",20),T.qZA(),T.qZA()),2&e){const e=T.oxw();T.xp6(1),T.Q6J("ngIf","field"===(null==e.detail?null:e.detail.conditionSettingMethod)),T.xp6(2),T.Q6J("ngIf","normal"===(null==e.detail?null:e.detail.conditionSettingMethod)),T.xp6(1),T.Q6J("ngIf","field"===(null==e.detail?null:e.detail.conditionSettingMethod)),T.xp6(1),T.Q6J("ngIf","field"===(null==e.detail?null:e.detail.conditionSettingMethod))}}function Ie(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",4),T.TgZ(1,"div",30),T.TgZ(2,"button",31),T.NdJ("click",function(){return T.CHM(e),T.oxw().cancel()}),T._uU(3,"\u8fd4 \u56de"),T.qZA(),T.qZA(),T.qZA()}}function qe(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",34),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).send("rejected")}),T._uU(1,"\u4e0d\u540c\u610f"),T.qZA()}}function _e(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",35),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).send("approved")}),T._uU(1,"\u540c \u610f"),T.qZA()}}function ze(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",4),T.TgZ(1,"div",30),T.TgZ(2,"button",31),T.NdJ("click",function(){return T.CHM(e),T.oxw().cancel()}),T._uU(3,"\u8fd4 \u56de"),T.qZA(),T.YNc(4,qe,2,0,"button",32),T.YNc(5,_e,2,0,"button",33),T.qZA(),T.qZA()}if(2&e){const e=T.oxw();T.xp6(4),T.Q6J("ngIf",e.isCrud.update),T.xp6(1),T.Q6J("ngIf",e.isCrud.update)}}function Ne(e,t){if(1&e&&(T.TgZ(0,"div",44),T.TgZ(1,"div"),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"date"),T.qZA(),T.TgZ(5,"p"),T._uU(6),T.ALo(7,"date"),T.qZA(),T.qZA(),T.TgZ(8,"div"),T.TgZ(9,"p"),T._uU(10),T.qZA(),T.TgZ(11,"p"),T._uU(12),T.qZA(),T.qZA(),T.qZA()),2&e){const e=t.$implicit,i=T.oxw(2).$implicit,a=T.oxw(2);T.Q6J("ngClass",a.isHistoryOpen[i.key]?"":"dis_none"),T.xp6(3),T.Oqu(T.xi3(4,5,e.time,a.dateFormat)),T.xp6(3),T.Oqu(T.xi3(7,8,e.time,"hh:mm:ss")),T.xp6(4),T.Oqu(e.title),T.xp6(2),T.Oqu(e.detail)}}function De(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",38),T.TgZ(1,"div",39),T.TgZ(2,"h4",40),T.NdJ("click",function(){T.CHM(e);const t=T.oxw().$implicit,i=T.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),T._uU(3),T.qZA(),T.TgZ(4,"button",41),T.NdJ("click",function(){T.CHM(e);const t=T.oxw().$implicit,i=T.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),T._UZ(5,"nb-icon",42),T.qZA(),T.qZA(),T.YNc(6,Ne,13,11,"div",43),T.qZA()}if(2&e){const e=t.ngIf,i=T.oxw().$implicit,a=T.oxw(2);T.Q6J("ngClass",a.isHistoryOpen[i.key]?"closeSubItem":""),T.xp6(3),T.Oqu(e.type),T.xp6(3),T.Q6J("ngForOf",e.flows)}}function Oe(e,t){if(1&e&&(T.ynx(0),T.YNc(1,De,7,3,"div",37),T.BQk()),2&e){const e=t.$implicit;T.xp6(1),T.Q6J("ngIf",e.value)}}function Ue(e,t){if(1&e&&(T.TgZ(0,"div",36),T.YNc(1,Oe,2,1,"ng-container",24),T.ALo(2,"keyvalue"),T.qZA()),2&e){const e=T.oxw();T.xp6(1),T.Q6J("ngForOf",T.lcZ(2,1,e.historyGroupView))}}function Je(e,t){if(1&e&&(T.TgZ(0,"nb-tab",45),T._UZ(1,"ng2-smart-table",46),T._UZ(2,"paginator",47),T.qZA()),2&e){const e=t.ngIf,i=T.oxw();T.xp6(1),T.Q6J("settings",i.gridDefine)("source",e),T.xp6(1),T.Q6J("source",e)("paginator",i.paginator)}}let ke=(()=>{class e extends f.H{constructor(e,t,i,a,n,s,o,r,c,l,d){super(e,t,i),this.router=a,this.activatedRoute=n,this.dialogService=s,this.tableService=o,this.reviewManageService=r,this.loadingService=c,this.fileService=l,this.tagManageService=d,this.isConditionOpen={},this.isHistoryOpen={},this.isSameList={},this.isBefore=!1,this.isCompare=!1,this.isfileDownload=!1,this.gridDefine={pager:{display:!0,perPage:10},columns:{activityName:{title:"\u6d3b\u52d5\u540d\u7a31",type:"string",sort:!1},activityDescription:{title:"\u6d3b\u52d5\u8aaa\u660e",type:"html",sort:!1,valuePrepareFunction:e=>`<p>${null!=e?e:""}</p>`},department:{title:"\u6240\u5c6c\u55ae\u4f4d",type:"html",class:"text_center",valuePrepareFunction:(e,t,i)=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},owner:{title:"\u8ca0\u8cac\u4eba",type:"html",class:"text_center",valuePrepareFunction:(e,t,i)=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},status:{title:"\u72c0\u614b",type:"html",class:"text_center",valuePrepareFunction:e=>e?'<p class="text_center">'+(E.qb[e]||"")+"</p>":"",sort:!1},during:{title:"\u8d77\u8fc4\u6642\u9593",type:"html",class:"text_center",valuePrepareFunction:(e,t)=>t.startDate&&t.endDate?`<p class="text_center">${null==t?void 0:t.startDate} ~ ${null==t?void 0:t.endDate}</p>`:"",sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}}}ngOnInit(){if(this.historyId=this.activatedRoute.snapshot.params.historyId,this.loadingService.open(),this.isMock){let e=ce.find(e=>e.historyId===this.historyId);this.newDetail=JSON.parse(JSON.stringify(e)),this.detail=this.newDetail,this.reviewStatus=e.reviewStatus,this.reviewComment=e.reviewComment;let t=re.O.find(t=>t.tagId===e.referenceId);if(t){this.isCompare=!!t,this.oldDetail=JSON.parse(JSON.stringify(t));const e=m.l.getHistoryProcessData("tagReviewHistoryAud",this.oldDetail);e&&(this.isHistoryOpen=e.isHistoryOpen,this.historyGroupView=e.detail.historyGroupView),this.isSameList=m.l.compareObj(this.newDetail,this.oldDetail)}return this.dataSource.load(v.w),void this.loadingService.close()}this.reviewManageService.getTagReviewRow(this.historyId).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{throw this.dialogService.alertAndBackToList(!1,`${e.message}\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u6a19\u7c64\u5be9\u6838\u5217\u8868`,["pages","review-manage","review-tag-list"]),new Error(e.message)}),(0,Z.b)(e=>{var t,i,a,n,s;this.newDetail=JSON.parse(JSON.stringify(e.result)),this.detail=this.newDetail,this.reviewStatus=e.result.reviewStatus,this.reviewComment=e.result.reviewComment;const o=m.l.getHistoryProcessData("tagReviewHistoryAud",this.newDetail);o&&(this.isHistoryOpen=o.isHistoryOpen,this.historyGroupView=o.detail.historyGroupView),this.isfileDownload=(null===(a=null===(i=null===(t=this.loginService.userProfileSubject)||void 0===t?void 0:t.value)||void 0===i?void 0:i.businessUnit)||void 0===a?void 0:a.toLowerCase())===(null===(s=null===(n=this.detail)||void 0===n?void 0:n.department)||void 0===s?void 0:s.toLocaleLowerCase()),this.loadingService.close()})).subscribe(e=>{e.result.referenceId&&(this.restDataSource=this.tableService.searchData({apiUrl:`${this.tagManageService.tagFunc}${e.result.referenceId}/activity-setting`,nowPage:this.paginator.nowPage,errMsg:"\u6a19\u7c64\u4f7f\u7528\u7bc4\u570d\u67e5\u7121\u8cc7\u6599"})),this.reviewManageService.getLastApprovedTag(this.historyId).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{let t=!!Object.values(p.m).includes(e.code)&&null;throw this.dialogService.alertAndBackToList(t,`${e.message}\uff0c\u7121\u524d\u6b21\u6838\u51c6\u7d00\u9304`),this.loadingService.close(),new Error(e.message)}),(0,Z.b)(e=>{this.isCompare=!!e.result,this.oldDetail=JSON.parse(JSON.stringify(e.result)),this.isSameList=m.l.compareObj(this.newDetail,this.oldDetail),this.loadingService.close()})).subscribe()})}onDownloadFile(){var e,t,i;m.l.isBlank(null===(e=this.detail)||void 0===e?void 0:e.fileData)?this.dialogService.alertAndBackToList(!1,"\u6a94\u6848\u4e0b\u8f09\u5931\u6557(\u7121\u8b58\u5225\u78bc)"):this.fileService.downloadFileService(de.s.ReviewTag,new le.D({fileDataId:this.detail.fileData,fileName:null===(t=this.detail)||void 0===t?void 0:t.fileName,uploadType:null===(i=this.detail)||void 0===i?void 0:i.uploadType}))}viewToggle(){this.isBefore=!this.isBefore,this.detail=!0===this.isBefore?this.oldDetail:this.newDetail}changeClass(e,t){let i=this.isSameList[e];if(t){let e=this.isSameList[t];return i&&e?"true":i&&e||!this.isBefore?"false":"null"}return i?"true":!i&&this.isBefore?"null":"false"}send(e){let t={title:"\u6a19\u7c64\u7570\u52d5\u99c1\u56de\u8aaa\u660e",isApproved:"approved"===e};this.isMock?this.dialogService.openReview(t).componentRef.instance.emit.subscribe(e=>{this.dialogService.openReview(t).close(),this.router.navigate(["pages","review-manage","review-tag-list"])}):this.dialogService.openReview(t).componentRef.instance.emit.subscribe(t=>{this.reviewManageService.updateTagReview(this.historyId,{reviewStatus:e,reviewComment:t.reviewComment}).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{throw this.dialogService.alertAndBackToList(!1,e),new Error(e.message)}),(0,Z.b)(e=>this.router.navigate(["pages","review-manage","review-tag-list"]))).subscribe()})}cancel(){this.router.navigate(["pages","review-manage","review-tag-list"])}}return e.\u0275fac=function(t){return new(t||e)(T.Y36(b.V),T.Y36(S.E),T.Y36(x.r),T.Y36(g.F0),T.Y36(g.gz),T.Y36(n.x),T.Y36(W.I),T.Y36(I),T.Y36(A.b),T.Y36(ue.I),T.Y36(l.P))},e.\u0275cmp=T.Xpm({type:e,selectors:[["review-tag-detail"]],features:[T.qOj],decls:85,vars:68,consts:[[1,"pageTitle"],[4,"ngIf"],[1,"pageContent"],["class","noteText",3,"ngClass",4,"ngIf"],[1,"row"],[1,"textGroup","col-12","col-lg-4"],[1,"text_bold",3,"ngClass"],["class","textGroup col-12 col-lg-4",4,"ngIf"],["class","row",4,"ngIf"],["tabTitle","\u7570\u52d5\u6b77\u7a0b"],["class","historyList",4,"ngIf"],["tabTitle","\u6a19\u7c64\u4f7f\u7528\u7bc4\u570d",4,"ngIf"],["nbButton","","status","primary","size","small",3,"click",4,"ngIf"],["nbButton","","status","primary","size","small",3,"click"],[1,"noteText",3,"ngClass"],["icon","info-outline"],[1,"text_bold"],[3,"ngClass","click"],["class","subTitle",4,"ngIf"],["class","textGroup code col-12",4,"ngIf"],["class","colorArea col-12",3,"ngClass",4,"ngIf"],[1,"subTitle"],[1,"textGroup","code","col-12"],[1,"colorArea","col-12",3,"ngClass"],[4,"ngFor","ngForOf"],[1,"textGroup","gather"],["status","warning","appearance","filled","text","and",4,"ngIf"],["status","info","appearance","filled","text","or",4,"ngIf"],["status","warning","appearance","filled","text","and"],["status","info","appearance","filled","text","or"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","danger","size","medium",3,"click",4,"ngIf"],["nbButton","","status","primary","size","medium",3,"click",4,"ngIf"],["nbButton","","status","danger","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"click"],[1,"historyList"],["class","historyItem active moreBtn",3,"ngClass",4,"ngIf"],[1,"historyItem","active","moreBtn",3,"ngClass"],[1,"mainItem"],[3,"click"],["nbButton","","ghost","","status","info","size","tiny",1,"iconBtn",3,"click"],["icon","arrow-ios-forward"],["class","subItem",3,"ngClass",4,"ngFor","ngForOf"],[1,"subItem",3,"ngClass"],["tabTitle","\u6a19\u7c64\u4f7f\u7528\u7bc4\u570d"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"\u6a19\u7c64\u5be9\u6838"),T.qZA(),T.YNc(3,ve,3,2,"ng-container",1),T.qZA(),T.TgZ(4,"div",2),T.YNc(5,fe,7,8,"div",3),T.TgZ(6,"nb-card"),T.TgZ(7,"nb-card-body"),T.TgZ(8,"div",4),T.TgZ(9,"div",5),T.TgZ(10,"p",6),T.ALo(11,"enum"),T._uU(12,"\u6a19\u7c64\u540d\u7a31\uff1a"),T.qZA(),T.TgZ(13,"span"),T._uU(14),T.qZA(),T.qZA(),T.TgZ(15,"div",5),T.TgZ(16,"p",6),T.ALo(17,"enum"),T._uU(18,"\u72c0\u614b\uff1a"),T.qZA(),T.TgZ(19,"span"),T._uU(20),T.ALo(21,"enum"),T.qZA(),T.qZA(),T.TgZ(22,"div",5),T.TgZ(23,"p",6),T.ALo(24,"enum"),T._uU(25,"\u985e\u578b\uff1a"),T.qZA(),T.TgZ(26,"span"),T._uU(27),T.ALo(28,"enum"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(29,"div",4),T.TgZ(30,"div",5),T.TgZ(31,"p",6),T.ALo(32,"enum"),T._uU(33,"\u6240\u5c6c\u55ae\u4f4d\uff1a"),T.qZA(),T.TgZ(34,"span"),T._uU(35),T.qZA(),T.qZA(),T.TgZ(36,"div",5),T.TgZ(37,"p",6),T.ALo(38,"enum"),T._uU(39,"\u8ca0\u8cac\u4eba\uff1a"),T.qZA(),T.TgZ(40,"span"),T._uU(41),T.qZA(),T.qZA(),T.TgZ(42,"div",5),T.TgZ(43,"p",6),T.ALo(44,"enum"),T._uU(45," \u8d77\u8fc4\u6642\u9593\uff1a"),T.qZA(),T.TgZ(46,"span"),T._uU(47),T.qZA(),T.qZA(),T.qZA(),T.TgZ(48,"div",4),T.TgZ(49,"div",5),T.TgZ(50,"p",6),T.ALo(51,"enum"),T._uU(52,"\u6a19\u7c64\u5c6c\u6027\uff1a"),T.qZA(),T.TgZ(53,"span"),T._uU(54),T.qZA(),T.qZA(),T.TgZ(55,"div",5),T.TgZ(56,"p",6),T.ALo(57,"enum"),T._uU(58,"\u6a19\u7c64\u5b50\u69cb\u9762\uff1a"),T.qZA(),T.TgZ(59,"span"),T._uU(60),T.qZA(),T.qZA(),T.TgZ(61,"div",5),T.TgZ(62,"p",6),T.ALo(63,"enum"),T._uU(64,"\u7570\u52d5\u6642\u9593\uff1a "),T.qZA(),T.TgZ(65,"span"),T._uU(66),T.ALo(67,"date"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(68,"div",4),T.TgZ(69,"div",5),T.TgZ(70,"p",6),T.ALo(71,"enum"),T._uU(72,"\u8aaa\u660e\uff1a"),T.qZA(),T.TgZ(73,"span"),T._uU(74),T.qZA(),T.qZA(),T.YNc(75,we,5,2,"div",7),T.qZA(),T.YNc(76,Ce,6,4,"div",1),T.qZA(),T.qZA(),T.YNc(77,Ie,4,0,"div",8),T.YNc(78,ze,6,2,"div",8),T.TgZ(79,"nb-card"),T.TgZ(80,"nb-card-body"),T.TgZ(81,"nb-tabset"),T.TgZ(82,"nb-tab",9),T.YNc(83,Ue,3,3,"div",10),T.qZA(),T.YNc(84,Je,3,4,"nb-tab",11),T.qZA(),T.qZA(),T.qZA(),T.qZA()),2&e&&(T.xp6(3),T.Q6J("ngIf","reviewing"===t.reviewStatus&&t.isCompare),T.xp6(2),T.Q6J("ngIf","reviewing"!==t.reviewStatus),T.xp6(5),T.Q6J("ngClass",T.xi3(11,29,t.changeClass("tagName"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.tagName),T.xp6(2),T.Q6J("ngClass",T.xi3(17,32,t.changeClass("status"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(21,35,null==t.detail?null:t.detail.status,"status")),T.xp6(3),T.Q6J("ngClass",T.xi3(24,38,t.changeClass("tagType"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(28,41,null==t.detail?null:t.detail.tagType,"tagType")),T.xp6(4),T.Q6J("ngClass",T.xi3(32,44,t.changeClass("department"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.department),T.xp6(2),T.Q6J("ngClass",T.xi3(38,47,t.changeClass("owner"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.owner),T.xp6(2),T.Q6J("ngClass",T.xi3(44,50,t.changeClass("startDate","endDate"),"reviewCompareClass")),T.xp6(4),T.AsE("",null==t.detail?null:t.detail.startDate,"~",null==t.detail?null:t.detail.endDate,""),T.xp6(3),T.Q6J("ngClass",T.xi3(51,53,t.changeClass("categoryKey"),"reviewCompareClass")),T.xp6(4),T.Oqu((null==t.detail?null:t.detail.categoryName)||(null==t.detail?null:t.detail.categoryKey)),T.xp6(2),T.Q6J("ngClass",T.xi3(57,56,t.changeClass("tagTopicKey"),"reviewCompareClass")),T.xp6(4),T.Oqu((null==t.detail?null:t.detail.tagTopicName)||(null==t.detail?null:t.detail.tagTopicKey)),T.xp6(2),T.Q6J("ngClass",T.xi3(63,59,t.changeClass("modificationTime"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(67,62,null==t.detail?null:t.detail.modificationTime,t.dateFormat)),T.xp6(4),T.Q6J("ngClass",T.xi3(71,65,t.changeClass("tagDescription"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.tagDescription),T.xp6(1),T.Q6J("ngIf","document"===(null==t.detail?null:t.detail.tagType)),T.xp6(1),T.Q6J("ngIf","document"!==(null==t.detail?null:t.detail.tagType)&&("field"===(null==t.detail?null:t.detail.conditionSettingMethod)||"normal"===(null==t.detail?null:t.detail.conditionSettingMethod))),T.xp6(1),T.Q6J("ngIf","reviewing"!==t.reviewStatus),T.xp6(1),T.Q6J("ngIf","reviewing"===t.reviewStatus),T.xp6(5),T.Q6J("ngIf",!!t.historyGroupView),T.xp6(1),T.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[q.O5,c.Asz,c.yKW,q.mk,c.kyn,c.TR4,c.DPz,c.fMN,q.sg,c.c2L,d.T5,ae.J],pipes:[_.z,q.uU,q.Nd],styles:[".noteText[_ngcontent-%COMP%]{flex-wrap:wrap}.noteText[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:90%}.noteText[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-of-type){padding-left:2rem}.link-style[_ngcontent-%COMP%]{color:#26dd84!important;text-decoration:none;cursor:pointer}.disabled-link-style[_ngcontent-%COMP%]{color:gray!important;text-decoration:none;cursor:not-allowed}"]}),e})();var Le=i(56037);function Fe(e,t){if(1&e&&(T.ynx(0),T._UZ(1,"ng2-smart-table",13),T._UZ(2,"paginator",14),T.BQk()),2&e){const e=t.ngIf,i=T.oxw();T.xp6(1),T.Q6J("settings",i.gridDefine)("source",e),T.xp6(1),T.Q6J("source",e)("paginator",i.paginator)}}const Qe=function(e){return{options:e,key:"key",val:"val"}};let Me=(()=>{class e extends f.H{constructor(e,t,i,n,s,o){super(e,t,i),this.activatedRoute=n,this.reviewManageService=s,this.tableService=o,this.statusList=Object.entries(j.C).map(([e,t])=>({key:e,val:t})),this.selected="",this.mockData=ce,this.sessionKey=this.activatedRoute.snapshot.routeConfig.path,this.isSearch=!1,this.gridDefine={pager:{display:!0,perPage:10},columns:{tagName:{title:"\u6a19\u7c64\u540d\u7a31",type:"string",sort:!1},tagType:{title:"\u985e\u578b",type:"html",class:"text_center min_w100",valuePrepareFunction:e=>e?'<p class="text_center">'+(Le.Qy[e]||"")+"</p>":"",sort:!1},department:{title:"\u6240\u5c6c\u55ae\u4f4d",type:"html",class:"text_center min_w150",valuePrepareFunction:e=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},owner:{title:"\u8ca0\u8cac\u4eba",type:"html",class:"text_center min_w150",valuePrepareFunction:e=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},tagDescription:{title:"\u8aaa\u660e",type:"html",valuePrepareFunction:e=>`<p>${null!=e?e:""}</p>`,sort:!1},modificationTime:{title:"\u6a19\u7c64\u6709\u6548\u8d77\u8fc4\u65e5",type:"html",class:"text_center min_w250",valuePrepareFunction:(e,t)=>t.startDate&&t.endDate?`<p class="text_center">${null==t?void 0:t.startDate} ~ ${null==t?void 0:t.endDate}</p>`:"",sort:!1},reviewStatus:{title:"\u72c0\u614b",type:"html",class:"text_center min_w100",valuePrepareFunction:e=>e?`<p class="text_center ${E.CZ[e]||""}">`+(j.C[e]||"")+"</p>":"",sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",valuePrepareFunction:(e,t)=>t,renderComponent:X.m,sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.validateForm=new a.cw({tagName:new a.NI(""),reviewStatus:new a.NI(""),startDate:new a.NI(null,$.I.dateFmt),endDate:new a.NI(null,$.I.dateFmt)},[$.I.dateRange])}ngOnInit(){this.search()}ngOnDestroy(){this.setSessionData()}setSessionData(){var e,t;const i=this.isSearch?this.validateForm.getRawValue():null!==(t=null===(e=this.storageService.getSessionVal(this.sessionKey))||void 0===e?void 0:e.filter)&&void 0!==t?t:this.validateForm.getRawValue();this.setSessionVal({page:this.paginator.nowPage,filter:i})}reset(){this.validateForm.reset({tagName:"",reviewStatus:"",startDate:null,endDate:null}),this.isSearch=!0,this.paginator.nowPage=1,this.setSessionData(),this.search("reset")}search(e){if(this.isMock){this.dataSource.reset();let e=this.validateForm.getRawValue();for(const[t,i]of Object.entries(e).filter(([e,t])=>!!t))this.dataSource.addFilter({field:t,filter:void 0,search:i});return void this.dataSource.load(ce)}const t=this.storageService.getSessionVal(this.sessionKey);this.isSearch=!1,"search"===e&&(this.isSearch=!0),["search","reset"].includes(e)&&(this.paginator.nowPage=1);let i=this.paginator.nowPage;"search"!==e&&(null==t?void 0:t.filter)&&(i=t.page,m.l.initializeFormWithSessionData(this.validateForm,t)),"reset"!==e&&this.setSessionData();let a={apiUrl:this.reviewManageService.tagReviewFunc,nowPage:i,filters:this.validateForm.getRawValue(),errMsg:"\u540d\u55ae\u5be9\u6838\u67e5\u7121\u8cc7\u6599"};this.restDataSource=this.tableService.searchData(a)}}return e.\u0275fac=function(t){return new(t||e)(T.Y36(b.V),T.Y36(S.E),T.Y36(x.r),T.Y36(g.gz),T.Y36(I),T.Y36(W.I))},e.\u0275cmp=T.Xpm({type:e,selectors:[["review-tag-list"]],features:[T.qOj],decls:30,vars:9,consts:[[1,"pageTitle"],[1,"pageContent"],[3,"formGroup"],[1,"row"],["title","\u6a19\u7c64\u540d\u7a31","ctlName","tagName",1,"col-12","col-lg-6",3,"form"],["title","\u72c0\u614b","ctlName","reviewStatus",1,"col-12","col-lg-6",3,"form","selectList"],[3,"form"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"disabled","click"],[1,"noteText"],["icon","info-outline"],[4,"ngIf"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"\u6a19\u7c64\u5be9\u6838"),T.qZA(),T.qZA(),T.TgZ(3,"div",1),T.TgZ(4,"nb-card"),T.TgZ(5,"nb-card-header"),T.TgZ(6,"h2"),T._uU(7,"\u67e5\u8a62\u8a2d\u5b9a\u503c"),T.qZA(),T.qZA(),T.TgZ(8,"nb-card-body",2),T.TgZ(9,"div",3),T._UZ(10,"basic-input",4),T._UZ(11,"dropdown",5),T.qZA(),T._UZ(12,"date-range",6),T.qZA(),T.qZA(),T.TgZ(13,"div",3),T.TgZ(14,"div",7),T.TgZ(15,"button",8),T.NdJ("click",function(){return t.reset()}),T._uU(16,"\u6e05 \u9664"),T.qZA(),T.TgZ(17,"button",9),T.NdJ("click",function(){return t.search("search")}),T._uU(18,"\u67e5 \u8a62"),T.qZA(),T.qZA(),T.qZA(),T._UZ(19,"hr"),T.TgZ(20,"nb-card"),T.TgZ(21,"nb-card-header"),T.TgZ(22,"h2"),T._uU(23,"\u5be9\u6838\u5217\u8868"),T.qZA(),T.qZA(),T.TgZ(24,"nb-card-body"),T.TgZ(25,"div",10),T._UZ(26,"nb-icon",11),T.TgZ(27,"p"),T._uU(28,"\u672c\u65e5\u5df2\u5be9\u67e5\u4e4b\u9805\u76ee\u5c07\u7559\u5b58\u65bc\u5217\u8868\u5167\uff0c\u4e26\u6a19\u8a3b\u70ba\u300c\u540c\u610f\u300d\u6848\u4ef6\uff1b\u6bcf\u65e5 00:00 \u6279\u6b21\u66f4\u65b0\u5217\u8868\u5167\u5bb9\uff0c\u6b32\u67e5\u770b\u300c\u540c\u610f\u300d\u6848\u4ef6\u8acb\u79fb\u81f3\u300c\u8a72\u6a19\u7c64\u300d\u67e5\u8a62\u76f8\u95dc\u6b77\u7a0b\u3002"),T.qZA(),T.qZA(),T.YNc(29,Fe,3,4,"ng-container",12),T.qZA(),T.qZA(),T.qZA()),2&e&&(T.xp6(8),T.Q6J("formGroup",t.validateForm),T.xp6(2),T.Q6J("form",t.validateForm),T.xp6(1),T.Q6J("form",t.validateForm)("selectList",T.VKq(7,Qe,t.statusList)),T.xp6(1),T.Q6J("form",t.validateForm),T.xp6(5),T.Q6J("disabled",t.validateForm.invalid),T.xp6(12),T.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[c.Asz,c.ndF,c.yKW,a.JL,a.sg,ee.n,te.J,ie.S,c.DPz,c.fMN,q.O5,d.T5,ae.J],styles:[""]}),e})();const Ye=[{historyId:"h123456",version:"uuid-zzzz",referenceId:"uuid-1",groupId:1,time:"2023-07-18 10:30:00",title:"\u5efa\u7acb\u6392\u7a0b\u7ba1\u7406\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6d3b\u52d5",reviewStatus:"reviewing",reviewer:"John Doe",reviewComment:"\u6392\u7a0b\u7ba1\u7406\u901a\u904e",reviewTime:"2023-07-03 15:30:00",jobName:"Job Name",executionFrequency:"Daily",frequencyTime:"00:00",filePath:"C://",creationTime:"2023-07-20 10:00:00",modificationTime:"2023-07-20 12:30:00",status:"disabled",newActivitySetting:[{activityId:"2498e0bf-2289-4fd9-a037-04a6888a9399",version:"uuid-zzzz",activityName:"\u65b0\u5546\u54c1\u5feb\u9583\u9ad4\u9a57\u6d3b\u52d5",activityDescription:"\u65b0\u5546\u54c1\u5feb\u9583\u9ad4\u9a57\u6d3b\u52d5",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"approved",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null},{activityId:"abcdefg123456",version:"uuid-zzzz",activityName:"\u5973\u738b\u7bc0\u6d3b\u52d5",activityDescription:"\u5973\u738b\u7bc0\u6d3b\u52d5 EDM \u540d\u55ae",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"approved",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null}],lastActivitySetting:[{activityId:"abcdefg123456",version:"uuid-zzzz",activityName:"\u5973\u738b\u7bc0\u6d3b\u52d5",activityDescription:"\u5973\u738b\u7bc0\u6d3b\u52d5 EDM \u540d\u55ae",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"reviewing",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null},{activityId:"f32510d7-225b-4c07-82a6-1292a7ec55c7",version:"uuid-zzzz",activityName:"\u4e03\u5915\u60c5\u4eba\u7bc0\u6d3b\u52d5",activityDescription:"-",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"reviewing",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null}],scheduleReviewHistoryAud:[{historyId:"h123457",version:"uuid-zzzz",referenceId:"uuid-1",groupId:1,time:"2023-08-09T17:41:36",title:"\u5efa\u7acb\u6392\u7a0b\u7ba1\u7406\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6d3b\u52d5",reviewStatus:"approved",reviewer:"John Doe",reviewComment:"\u6392\u7a0b\u7ba1\u7406\u901a\u904e",reviewTime:"2023-08-21 13:51:52",jobName:"Job Name",executionFrequency:"daily",frequencyTime:"00:00",filePath:"/file/path/",creationTime:"2023-08-09T17:41:36",modificationTime:"2023-08-09T17:41:36",status:"enabled"},{historyId:"7a128341-e43b-41fb-a223-cc0fac367aa3",version:"8d209a11-51fd-4ec9-9f81-83f4b1fa8e86",referenceId:"uuid-1",groupId:3,time:"2023-08-21T16:39:08",title:"\u5efa\u7acb\u540d\u55ae\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6392\u7a0b",reviewStatus:"reviewing",reviewer:null,reviewComment:null,reviewTime:null,jobName:"Job Name",executionFrequency:"daily",frequencyTime:"00:00",filePath:"/file/path/",creationTime:null,modificationTime:null,status:"enabled"},{historyId:"54266804-ce7e-4db7-b920-47d74e15277a",version:"530a99ce-0317-489e-bf4c-8c239d45def9",referenceId:"uuid-1",groupId:4,time:"2023-08-21T16:46:37",title:"\u5efa\u7acb\u540d\u55ae\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6392\u7a0b",reviewStatus:"reviewing",reviewer:null,reviewComment:null,reviewTime:null,jobName:"Job Name",executionFrequency:"daily",frequencyTime:"00:00",filePath:"/file/path/",creationTime:null,modificationTime:null,status:"enabled"},{historyId:"32a1f8c7-1abf-4d17-bfc1-b4c77ed38e5e",version:"53a0c224-40ce-42ad-8973-44caaa66c469",referenceId:"uuid-1",groupId:5,time:"2023-08-21T16:47:05",title:"\u5efa\u7acb\u540d\u55ae\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u5efa\u7acb\u6392\u7a0b",reviewStatus:"reviewing",reviewer:null,reviewComment:null,reviewTime:null,jobName:"Job Name",executionFrequency:"daily",frequencyTime:"00:00",filePath:"/file/path/",creationTime:null,modificationTime:null,status:"rejected"}]},{historyId:"h123457",version:"uuid-zzzz",referenceId:"uuid-1",groupId:2,time:"2023-07-01 10:30:00",title:"\u7de8\u8f2f\u6392\u7a0b\u7ba1\u7406\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u7de8\u8f2f\u6d3b\u52d5",reviewStatus:"approved",reviewer:"\u8001\u738b",reviewComment:"\u6392\u7a0b\u7de8\u8f2f\u7ba1\u7406\u901a\u904e",reviewTime:"2023-07-03 15:30:00",jobName:"Job",executionFrequency:"monthly",frequencyTime:"13:30:00",filePath:"/file/path/",creationTime:"2023-07-20 10:00:00",modificationTime:"2023-07-20 12:30:00",status:"enabled",newActivitySetting:[{activityId:"abcdefg123456",version:"uuid-zzzz",activityName:"\u5973\u738b\u7bc0\u6d3b\u52d5",activityDescription:"\u5973\u738b\u7bc0\u6d3b\u52d5 EDM \u540d\u55ae",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"approved",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null}],lastActivitySetting:[{activityId:"f32510d7-225b-4c07-82a6-1292a7ec55c7",version:"uuid-zzzz",activityName:"\u4e03\u5915\u60c5\u4eba\u7bc0\u6d3b\u52d5",activityDescription:"-",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"approved",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:"2023-07-13 12:00:00",batchResult:"success"}]},{historyId:"h123458",version:"uuid-zzzz",referenceId:"uuid-1",groupId:1,time:"2023-07-01 10:30:00",title:"\u7de8\u8f2f\u6392\u7a0b\u7ba1\u7406\u9001\u5be9",detail:"\u9001\u7a0b\u4e3b\u7ba1",type:"\u7de8\u8f2f\u6d3b\u52d5",reviewStatus:"rejected",reviewer:"Christina",reviewComment:"\u6392\u7a0b\u7de8\u8f2f\u7ba1\u7406\u901a\u904e",reviewTime:"2023-07-03 15:30:00",jobName:"\u6bcf\u9031EDM\u6392\u7a0b",executionFrequency:"weekly",frequencyTime:"10:00",filePath:"/file/path/",creationTime:"2023-07-20 10:00:00",modificationTime:"2023-07-20 12:30:00",status:"enabled",newActivitySetting:[{activityId:"abcdefg123456",version:"uuid-zzzz",activityName:"\u5973\u738b\u7bc0\u6d3b\u52d5",activityDescription:"\u5973\u738b\u7bc0\u6d3b\u52d5 EDM \u540d\u55ae",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"approved",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:"2023-07-03 12:00:00",batchResult:"success"},{activityId:"2498e0bf-2289-4fd9-a037-04a6888a9399",version:"uuid-zzzz",activityName:"\u65b0\u5546\u54c1\u5feb\u9583\u9ad4\u9a57\u6d3b\u52d5",activityDescription:"\u65b0\u5546\u54c1\u5feb\u9583\u9ad4\u9a57\u6d3b\u52d5",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"reviewing",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:"2023-07-13 12:00:00",batchResult:"success"},{activityId:"90b010ba-bd4b-480a-a0c7-3a35096f2ed8",version:"uuid-zzzz",activityName:"LINE TECHPULSE 2023",activityDescription:"LINE TECHPULSE 2023",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"reviewing",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null}],lastActivitySetting:[{activityId:"abcdefg123456",version:"uuid-zzzz",activityName:"\u5973\u738b\u7bc0\u6d3b\u52d5",activityDescription:"\u5973\u738b\u7bc0\u6d3b\u52d5 EDM \u540d\u55ae",department:"\u6240\u5c6c\u55ae\u4f4d",owner:"\u8ca0\u8cac\u4eba",filterOptions:"true",listLimit:100,status:"active",reviewStatus:"approved",startDate:"2023-07-01",endDate:"2023-07-10",createTime:"2023-07-03 15:30:00",modificationTime:"2023-07-03 15:30:00",scheduleSettings:"daily",batchUpdateTime:"2023-07-03 12:00:00",batchTime:null,batchResult:null}]}];function Be(e,t){if(1&e&&(T.ynx(0),T._UZ(1,"ng2-smart-table",5),T._UZ(2,"paginator",6),T.BQk()),2&e){const e=t.ngIf,i=T.oxw();T.xp6(1),T.Q6J("settings",i.gridDefine)("source",e),T.xp6(1),T.Q6J("source",e)("paginator",i.paginator)}}let Ge=(()=>{class e extends f.H{constructor(e,t,i,a,n,s){super(e,t,i),this.activatedRoute=a,this.reviewManageService=n,this.tableService=s,this.mockData=Ye,this.isSearch=!1,this.gridDefine={pager:{display:!0,perPage:10},columns:{jobName:{title:"\u4f5c\u696d\u540d\u7a31",type:"string",sort:!1},frequency:{title:"\u57f7\u884c\u983b\u7387",type:"html",valuePrepareFunction:(e,t)=>m.l.processExecutionFrequency(null==t?void 0:t.executionFrequency,null==t?void 0:t.frequencyTime),sort:!1},type:{title:"\u7570\u52d5\u985e\u578b",type:"string",sort:!1},reviewer:{title:"\u8b8a\u66f4\u4eba\u54e1",type:"html",class:"text_center",valuePrepareFunction:(e,t,i)=>'<p class="text_center">'+(null!=e?e:"")+"</p>",sort:!1},reviewStatus:{title:"\u72c0\u614b",type:"html",class:"text_center",valuePrepareFunction:e=>e?`<p class="text_center ${E.CZ[e]||""}">`+(j.C[e]||"")+"</p>":"",sort:!1},action:{title:"\u67e5\u770b",type:"custom",class:"center",width:"3rem",valuePrepareFunction:(e,t)=>t,renderComponent:X.m,sort:!1}},hideSubHeader:!0,actions:{add:!1,edit:!1,delete:!1}},this.sessionKey=this.activatedRoute.snapshot.routeConfig.path}ngOnInit(){this.search()}ngOnDestroy(){this.setSessionData()}setSessionData(){this.storageService.putSessionVal(this.sessionKey,{page:this.paginator.nowPage})}reset(){this.isSearch=!0,this.paginator.nowPage=1,this.setSessionData(),this.search("reset")}search(e){if(this.isMock)return void this.dataSource.load(Ye);const t=this.storageService.getSessionVal(this.sessionKey);this.isSearch=!1,["search","reset"].includes(e)&&(this.paginator.nowPage=1);let i=this.paginator.nowPage;"search"!==e&&(null==t?void 0:t.page)&&(i=t.page),"reset"!==e&&this.setSessionData(),this.restDataSource=this.tableService.searchData({apiUrl:this.reviewManageService.scheduleReviewFunc,nowPage:i,errMsg:"\u540d\u55ae\u6392\u7a0b\u5be9\u6838\u67e5\u7121\u8cc7\u6599"})}}return e.\u0275fac=function(t){return new(t||e)(T.Y36(b.V),T.Y36(S.E),T.Y36(x.r),T.Y36(g.gz),T.Y36(I),T.Y36(W.I))},e.\u0275cmp=T.Xpm({type:e,selectors:[["app-review-schedule-list"]],features:[T.qOj],decls:14,vars:1,consts:[[1,"pageTitle"],[1,"pageContent"],[1,"noteText"],["icon","info-outline"],[4,"ngIf"],[3,"settings","source"],[3,"source","paginator"]],template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"\u540d\u55ae\u6392\u7a0b\u5be9\u6838"),T.qZA(),T.qZA(),T.TgZ(3,"div",1),T.TgZ(4,"nb-card"),T.TgZ(5,"nb-card-header"),T.TgZ(6,"h2"),T._uU(7,"\u5be9\u6838\u5217\u8868"),T.qZA(),T.qZA(),T.TgZ(8,"nb-card-body"),T.TgZ(9,"div",2),T._UZ(10,"nb-icon",3),T.TgZ(11,"p"),T._uU(12,"\u672c\u65e5\u5df2\u5be9\u67e5\u4e4b\u9805\u76ee\u5c07\u7559\u5b58\u65bc\u5217\u8868\u5167\uff0c\u4e26\u6a19\u8a3b\u70ba\u300c\u540c\u610f\u300d\u6848\u4ef6\uff1b\u6bcf\u65e5 00:00 \u6279\u6b21\u66f4\u65b0\u5217\u8868\u5167\u5bb9\uff0c\u6b32\u67e5\u770b\u300c\u540c\u610f\u300d\u6848\u4ef6\u8acb\u79fb\u81f3\u300c\u8a72\u6392\u7a0b\u300d\u67e5\u8a62\u76f8\u95dc\u6b77\u7a0b\u3002"),T.qZA(),T.qZA(),T.YNc(13,Be,3,4,"ng-container",4),T.qZA(),T.qZA(),T.qZA()),2&e&&(T.xp6(13),T.Q6J("ngIf",t.restDataSource||t.dataSource))},directives:[c.Asz,c.ndF,c.yKW,c.fMN,q.O5,d.T5,ae.J],styles:[""]}),e})();var Re=i(73080),Pe=i(87175);function He(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",13),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).viewToggle()}),T._uU(1,"\u67e5\u770b\u7570\u52d5\u524d\u5167\u5bb9"),T.qZA()}}function Ve(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",13),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).viewToggle()}),T._uU(1,"\u8fd4\u56de\u672c\u6b21\u7570\u52d5\u5167\u5bb9"),T.qZA()}}function Ee(e,t){if(1&e&&(T.ynx(0),T.YNc(1,He,2,0,"button",12),T.YNc(2,Ve,2,0,"button",12),T.BQk()),2&e){const e=T.oxw();T.xp6(1),T.Q6J("ngIf",!e.isBefore),T.xp6(1),T.Q6J("ngIf",e.isBefore)}}function je(e,t){if(1&e&&(T.TgZ(0,"p"),T._uU(1),T.qZA()),2&e){const e=T.oxw(2);T.xp6(1),T.hij("\u539f\u56e0\uff1a",e.reviewComment,"")}}const $e=function(e){return{alert:e}};function Ke(e,t){if(1&e&&(T.TgZ(0,"div",14),T._UZ(1,"nb-icon",15),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"enum"),T.qZA(),T._UZ(5,"br"),T.YNc(6,je,2,1,"p",1),T.qZA()),2&e){const e=T.oxw();T.Q6J("ngClass",T.VKq(6,$e,"rejected"===e.reviewStatus)),T.xp6(3),T.hij("\u5be9\u6838\u7d50\u679c\uff1a",T.xi3(4,3,e.reviewStatus,"reviewStatus"),""),T.xp6(3),T.Q6J("ngIf","rejected"===e.reviewStatus)}}function Xe(e,t){if(1&e&&(T.TgZ(0,"div",16),T._UZ(1,"nb-tag",17),T.TgZ(2,"p",18),T._uU(3),T.ALo(4,"replace"),T.qZA(),T.qZA()),2&e){const e=T.oxw();T.xp6(3),T.Oqu(T.Dn7(4,1,e.activitySettingView.add.toString(),",","\u3001"))}}function We(e,t){if(1&e&&(T.TgZ(0,"div",16),T._UZ(1,"nb-tag",19),T.TgZ(2,"p",18),T._uU(3),T.ALo(4,"replace"),T.qZA(),T.qZA()),2&e){const e=T.oxw();T.xp6(3),T.Oqu(T.Dn7(4,1,e.activitySettingView.remove.toString(),",","\u3001"))}}function et(e,t){if(1&e&&(T.TgZ(0,"div",16),T._UZ(1,"nb-tag",20),T.TgZ(2,"p",18),T._uU(3),T.ALo(4,"replace"),T.qZA(),T.qZA()),2&e){const e=T.oxw();T.xp6(3),T.Oqu(T.Dn7(4,1,e.activitySettingView.same.toString(),",","\u3001"))}}function tt(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",4),T.TgZ(1,"div",21),T.TgZ(2,"button",22),T.NdJ("click",function(){return T.CHM(e),T.oxw().cancel()}),T._uU(3,"\u8fd4 \u56de"),T.qZA(),T.qZA(),T.qZA()}}function it(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",25),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).send("rejected")}),T._uU(1,"\u4e0d\u540c\u610f"),T.qZA()}}function at(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"button",26),T.NdJ("click",function(){return T.CHM(e),T.oxw(2).send("approved")}),T._uU(1,"\u540c \u610f"),T.qZA()}}function nt(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",4),T.TgZ(1,"div",21),T.TgZ(2,"button",22),T.NdJ("click",function(){return T.CHM(e),T.oxw().cancel()}),T._uU(3,"\u8fd4 \u56de"),T.qZA(),T.YNc(4,it,2,0,"button",23),T.YNc(5,at,2,0,"button",24),T.qZA(),T.qZA()}if(2&e){const e=T.oxw();T.xp6(4),T.Q6J("ngIf",e.isCrud.update),T.xp6(1),T.Q6J("ngIf",e.isCrud.update)}}function st(e,t){if(1&e&&(T.TgZ(0,"div",36),T.TgZ(1,"div"),T.TgZ(2,"p"),T._uU(3),T.ALo(4,"date"),T.qZA(),T.TgZ(5,"p"),T._uU(6),T.ALo(7,"date"),T.qZA(),T.qZA(),T.TgZ(8,"div"),T.TgZ(9,"p"),T._uU(10),T.qZA(),T.TgZ(11,"p"),T._uU(12),T.qZA(),T.qZA(),T.qZA()),2&e){const e=t.$implicit,i=T.oxw(2).$implicit,a=T.oxw(2);T.Q6J("ngClass",a.isHistoryOpen[i.key]?"":"dis_none"),T.xp6(3),T.Oqu(T.xi3(4,5,e.time,a.dateFormat)),T.xp6(3),T.Oqu(T.xi3(7,8,e.time,"hh:mm:ss")),T.xp6(4),T.Oqu(e.title),T.xp6(2),T.Oqu(e.detail)}}function ot(e,t){if(1&e){const e=T.EpF();T.TgZ(0,"div",30),T.TgZ(1,"div",31),T.TgZ(2,"h4",32),T.NdJ("click",function(){T.CHM(e);const t=T.oxw().$implicit,i=T.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),T._uU(3),T.qZA(),T.TgZ(4,"button",33),T.NdJ("click",function(){T.CHM(e);const t=T.oxw().$implicit,i=T.oxw(2);return i.isHistoryOpen[t.key]=!i.isHistoryOpen[t.key]}),T._UZ(5,"nb-icon",34),T.qZA(),T.qZA(),T.YNc(6,st,13,11,"div",35),T.qZA()}if(2&e){const e=t.ngIf,i=T.oxw().$implicit,a=T.oxw(2);T.Q6J("ngClass",a.isHistoryOpen[i.key]?"closeSubItem":""),T.xp6(3),T.Oqu(e.type),T.xp6(3),T.Q6J("ngForOf",e.flows)}}function rt(e,t){if(1&e&&(T.ynx(0),T.YNc(1,ot,7,3,"div",29),T.BQk()),2&e){const e=t.$implicit;T.xp6(1),T.Q6J("ngIf",e.value)}}function ct(e,t){if(1&e&&(T.TgZ(0,"nb-card"),T.TgZ(1,"nb-card-header"),T.TgZ(2,"h2"),T._uU(3,"\u7570\u52d5\u6b77\u7a0b"),T.qZA(),T.qZA(),T.TgZ(4,"nb-card-body"),T.TgZ(5,"div",27),T.YNc(6,rt,2,1,"ng-container",28),T.ALo(7,"keyvalue"),T.qZA(),T.qZA(),T.qZA()),2&e){const e=T.oxw();T.xp6(6),T.Q6J("ngForOf",T.lcZ(7,1,e.historyGroupView))}}const lt=[{path:"",component:oe,children:[{path:"",redirectTo:"review-tag-list",pathMatch:"full"},{path:"review-tag-list",component:Me,data:{keepSession:!0,keepFrom:["review-tag-detail/"]}},{path:"review-tag-detail/:historyId",component:ke,data:{keepSession:!0}},{path:"review-activity-list",component:se,data:{keepSession:!0,keepFrom:["review-activity-detail/"]}},{path:"review-activity-detail/:historyId",component:V,data:{keepSession:!0}},{path:"review-schedule-list",component:Ge,data:{keepSession:!0,keepFrom:["review-schedule-detail/"]}},{path:"review-schedule-detail/:historyId",component:(()=>{class e extends f.H{constructor(e,t,i,a,n,s,o,r){super(e,t,i),this.router=a,this.activatedRoute=n,this.loadingService=s,this.reviewManageService=o,this.dialogService=r,this.isHistoryOpen={},this.isSameList={},this.isBefore=!1,this.isCompare=!1,this.activitySettingView={add:[],remove:[],same:[]}}ngOnInit(){if(this.historyId=this.activatedRoute.snapshot.params.historyId,this.loadingService.open(),this.isMock){let e=Ye.find(e=>e.historyId===this.historyId);this.newDetail=JSON.parse(JSON.stringify(e)),this.detail=this.newDetail,this.reviewStatus=e.reviewStatus,this.reviewComment=e.reviewComment;const t=m.l.getHistoryProcessData("scheduleReviewHistoryAud",e);t&&(this.isHistoryOpen=t.isHistoryOpen,this.historyGroupView=t.detail.historyGroupView);let i=[];(null==e?void 0:e.activitySetting)&&(i=e.activitySetting.map(e=>({key:e.activityId,value:e.activityName})));let a=Re.P.find(t=>t.scheduleId===e.referenceId);if(this.isCompare=!!a,this.isCompare){this.oldDetail=JSON.parse(JSON.stringify(a)),this.isSameList=m.l.compareObj(this.newDetail,this.oldDetail);let e=[];(null==a?void 0:a.activitySetting)&&(e=a.activitySetting.map(e=>({key:e.activityId,value:e.activityName}))),i.concat(e.filter(e=>!i.find(t=>t.key==e.key))).forEach(t=>{let a=t.key,n=e.map(e=>e.key),s=i.map(e=>e.key);n.includes(a)&&s.includes(a)?this.activitySettingView.same.push(t.value):n.includes(a)&&!s.includes(a)?this.activitySettingView.remove.push(t.value):!n.includes(a)&&s.includes(a)&&this.activitySettingView.add.push(t.value)})}else this.activitySettingView.add.push(i.map(e=>e.value));this.loadingService.close()}else this.reviewManageService.getScheduleReviewRow(this.historyId).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{throw this.dialogService.alertAndBackToList(!1,`${e.message}\uff0c\u5c07\u70ba\u60a8\u5c0e\u56de\u540d\u55ae\u6392\u7a0b\u5be9\u6838\u5217\u8868`,["pages","review-manage","review-schedule-list"]),this.loadingService.close(),new Error(e.message)}),(0,Z.b)(e=>{this.newDetail=JSON.parse(JSON.stringify(e.result)),this.detail=this.newDetail,this.reviewStatus=e.result.reviewStatus,this.reviewComment=e.result.reviewComment;const t=m.l.getHistoryProcessData("scheduleReviewHistoryAud",e.result);t&&(this.isHistoryOpen=t.isHistoryOpen,this.historyGroupView=t.detail.historyGroupView),this.loadingService.close()})).subscribe(e=>{var t;let i=[];(null===(t=e.result)||void 0===t?void 0:t.activitySetting)&&(i=e.result.activitySetting.map(e=>({key:e.activityId,value:e.activityName}))),this.reviewManageService.getLastApprovedSchedule(this.historyId).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{let t=!!Object.values(p.m).includes(e.code)&&null;throw this.dialogService.alertAndBackToList(t,`${e.message}\uff0c\u7121\u524d\u6b21\u6838\u51c6\u7d00\u9304`),this.loadingService.close(),new Error(e.message)}),(0,Z.b)(e=>{var t;if(this.isCompare=!!e.result,this.isCompare){this.oldDetail=JSON.parse(JSON.stringify(e.result)),this.isSameList=m.l.compareObj(this.newDetail,this.oldDetail);let a=[];(null===(t=e.result)||void 0===t?void 0:t.activitySetting)&&(a=e.result.activitySetting.map(e=>({key:e.activityId,value:e.activityName}))),i.concat(a.filter(e=>!i.find(t=>t.key==e.key))).forEach(e=>{let t=e.key,n=a.map(e=>e.key),s=i.map(e=>e.key);n.includes(t)&&s.includes(t)?this.activitySettingView.same.push(e.value):n.includes(t)&&!s.includes(t)?this.activitySettingView.remove.push(e.value):!n.includes(t)&&s.includes(t)&&this.activitySettingView.add.push(e.value)})}else this.activitySettingView.add.push(i.map(e=>e.value));this.loadingService.close()})).subscribe()})}processExecutionFrequency(e,t){return m.l.processExecutionFrequency(e,t)}changeClass(e,t){let i=this.isSameList[e];if(t){let e=this.isSameList[t];return i&&e?"true":i&&e||!this.isBefore?"false":"null"}return i?"true":!i&&this.isBefore?"null":"false"}viewToggle(){this.isBefore=!this.isBefore,this.detail=!0===this.isBefore?this.oldDetail:this.newDetail}send(e){let t={title:"\u540d\u55ae\u6392\u7a0b\u7570\u52d5\u99c1\u56de\u8aaa\u660e",isApproved:"approved"===e};this.isMock?this.dialogService.openReview(t).componentRef.instance.emit.subscribe(e=>{this.dialogService.openReview(t).close(),this.router.navigate(["pages","review-manage","review-schedule-list"])}):this.dialogService.openReview(t).componentRef.instance.emit.subscribe(t=>{this.reviewManageService.updateScheduleReview(this.historyId,{reviewStatus:e,reviewComment:t.reviewComment}).pipe((0,w.h)(e=>e.code===p.$.SUCCESS),(0,y.K)(e=>{throw this.dialogService.alertAndBackToList(!1,e),new Error(e.message)}),(0,Z.b)(e=>this.router.navigate(["pages","review-manage","review-schedule-list"]))).subscribe()})}cancel(){this.router.navigate(["pages","review-manage","review-schedule-list"])}}return e.\u0275fac=function(t){return new(t||e)(T.Y36(b.V),T.Y36(S.E),T.Y36(x.r),T.Y36(g.F0),T.Y36(g.gz),T.Y36(A.b),T.Y36(I),T.Y36(n.x))},e.\u0275cmp=T.Xpm({type:e,selectors:[["review-schedule-detail"]],features:[T.qOj],decls:52,vars:39,consts:[[1,"pageTitle"],[4,"ngIf"],[1,"pageContent"],["class","noteText",3,"ngClass",4,"ngIf"],[1,"row"],[1,"textGroup","col-12","col-lg-4"],[1,"text_bold",3,"ngClass"],[1,"row","justify-content-between"],[1,"subTitle"],[1,"tagBlock"],["class","tagItem",4,"ngIf"],["class","row",4,"ngIf"],["nbButton","","status","primary","size","small",3,"click",4,"ngIf"],["nbButton","","status","primary","size","small",3,"click"],[1,"noteText",3,"ngClass"],["icon","info-outline"],[1,"tagItem"],["status","danger","appearance","filled","text","\u672c\u6b21\u65b0\u589e"],[1,"tagContent"],["status","info","appearance","filled","text","\u672c\u6b21\u522a\u9664"],["status","basic","appearance","filled","text","\u7121\u7570\u52d5"],[1,"btnGroup"],["nbButton","","status","basic","size","medium",3,"click"],["nbButton","","status","danger","size","medium",3,"click",4,"ngIf"],["nbButton","","status","primary","size","medium",3,"click",4,"ngIf"],["nbButton","","status","danger","size","medium",3,"click"],["nbButton","","status","primary","size","medium",3,"click"],[1,"historyList"],[4,"ngFor","ngForOf"],["class","historyItem active moreBtn",3,"ngClass",4,"ngIf"],[1,"historyItem","active","moreBtn",3,"ngClass"],[1,"mainItem"],[3,"click"],["nbButton","","ghost","","status","info","size","tiny",1,"iconBtn",3,"click"],["icon","arrow-ios-forward"],["class","subItem",3,"ngClass",4,"ngFor","ngForOf"],[1,"subItem",3,"ngClass"]],template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"\u540d\u55ae\u6392\u7a0b\u5be9\u6838"),T.qZA(),T.YNc(3,Ee,3,2,"ng-container",1),T.qZA(),T.TgZ(4,"div",2),T.YNc(5,Ke,7,8,"div",3),T.TgZ(6,"nb-card"),T.TgZ(7,"nb-card-body"),T.TgZ(8,"div",4),T.TgZ(9,"div",5),T.TgZ(10,"p",6),T.ALo(11,"enum"),T._uU(12,"\u4f5c\u696d\u540d\u7a31\uff1a"),T.qZA(),T.TgZ(13,"span"),T._uU(14),T.qZA(),T.qZA(),T.TgZ(15,"div",5),T.TgZ(16,"p",6),T.ALo(17,"enum"),T._uU(18,"\u72c0\u614b\uff1a"),T.qZA(),T.TgZ(19,"span"),T._uU(20),T.ALo(21,"enum"),T.qZA(),T.qZA(),T.TgZ(22,"div",5),T.TgZ(23,"p",6),T.ALo(24,"enum"),T._uU(25,"\u57f7\u884c\u983b\u7387\uff1a"),T.qZA(),T.TgZ(26,"span"),T._uU(27),T.qZA(),T.qZA(),T.qZA(),T.TgZ(28,"div",7),T.TgZ(29,"div",5),T.TgZ(30,"p",6),T.ALo(31,"enum"),T._uU(32,"\u6a94\u6848\u5b58\u653e\u4f4d\u7f6e\uff1a"),T.qZA(),T.TgZ(33,"span"),T._uU(34),T.qZA(),T.qZA(),T.TgZ(35,"div",5),T.TgZ(36,"p",6),T.ALo(37,"enum"),T._uU(38,"\u7570\u52d5\u6642\u9593\uff1a"),T.qZA(),T.TgZ(39,"span"),T._uU(40),T.ALo(41,"date"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(42,"div",8),T.TgZ(43,"p"),T._uU(44,"\u540d\u55ae\u5217\u8868"),T.qZA(),T.qZA(),T.TgZ(45,"div",9),T.YNc(46,Xe,5,5,"div",10),T.YNc(47,We,5,5,"div",10),T.YNc(48,et,5,5,"div",10),T.qZA(),T.qZA(),T.qZA(),T.YNc(49,tt,4,0,"div",11),T.YNc(50,nt,6,2,"div",11),T.YNc(51,ct,8,3,"nb-card",1),T.qZA()),2&e&&(T.xp6(3),T.Q6J("ngIf","reviewing"===t.reviewStatus&&t.isCompare),T.xp6(2),T.Q6J("ngIf","reviewing"!==t.reviewStatus),T.xp6(5),T.Q6J("ngClass",T.xi3(11,18,t.changeClass("jobName"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.jobName),T.xp6(2),T.Q6J("ngClass",T.xi3(17,21,t.changeClass("status"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(21,24,null==t.detail?null:t.detail.status,"status")),T.xp6(3),T.Q6J("ngClass",T.xi3(24,27,t.changeClass("executionFrequency","frequencyTime"),"reviewCompareClass")),T.xp6(4),T.Oqu(t.processExecutionFrequency(null==t.detail?null:t.detail.executionFrequency,null==t.detail?null:t.detail.frequencyTime)),T.xp6(3),T.Q6J("ngClass",T.xi3(31,30,t.changeClass("filePath"),"reviewCompareClass")),T.xp6(4),T.Oqu(null==t.detail?null:t.detail.filePath),T.xp6(2),T.Q6J("ngClass",T.xi3(37,33,t.changeClass("modificationTime"),"reviewCompareClass")),T.xp6(4),T.Oqu(T.xi3(41,36,null==t.detail?null:t.detail.modificationTime,t.dateFormat)),T.xp6(6),T.Q6J("ngIf",t.activitySettingView.add.length>0),T.xp6(1),T.Q6J("ngIf",t.activitySettingView.remove.length>0),T.xp6(1),T.Q6J("ngIf",t.activitySettingView.same.length>0),T.xp6(1),T.Q6J("ngIf","reviewing"!==t.reviewStatus),T.xp6(1),T.Q6J("ngIf","reviewing"===t.reviewStatus),T.xp6(1),T.Q6J("ngIf",t.historyGroupView))},directives:[q.O5,c.Asz,c.yKW,q.mk,c.DPz,c.fMN,c.c2L,c.ndF,q.sg],pipes:[_.z,q.uU,Pe.A,q.Nd],styles:[".noteText[_ngcontent-%COMP%]{flex-wrap:wrap}.noteText[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:90%}.noteText[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-of-type){padding-left:2rem}"]}),e})(),data:{keepSession:!0}}]}];let dt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=T.oAB({type:e}),e.\u0275inj=T.cJS({imports:[[g.Bz.forChild(lt)],g.Bz]}),e})();const ut=[c.uuI,c.zyh,c.caZ,c.KdK,r.$,c.MfT,c.YNG,c.nKr,c.T2N,c.IIj,c.urD,c.EoG];let gt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=T.oAB({type:e}),e.\u0275inj=T.cJS({providers:[n.x,I,l.P],imports:[[s.e,a.u5,a.UX,u.O,dt,d.ne,o.Dv,...ut]]}),e})()}}]);